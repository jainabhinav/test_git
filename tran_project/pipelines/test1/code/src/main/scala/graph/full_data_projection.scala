package graph

import io.prophecy.libs._
import udfs.PipelineInitCode._
import udfs.UDFs._
import udfs.ColumnFunctions._
import config.Context
import org.apache.spark._
import org.apache.spark.sql._
import org.apache.spark.sql.functions._
import org.apache.spark.sql.types._
import org.apache.spark.sql.expressions._
import java.time._

object full_data_projection {

  def apply(context: Context, in: DataFrame): DataFrame =
    in.select(
      col("date_time"),
      col("auction_id_64"),
      col("user_id_64"),
      col("tag_id"),
      col("venue_id"),
      col("inventory_source_id"),
      col("session_frequency"),
      col("site_domain"),
      col("width"),
      col("height"),
      col("geo_country"),
      col("geo_region"),
      col("gender"),
      col("age"),
      col("seller_member_id"),
      col("buyer_member_id"),
      col("creative_id"),
      col("seller_currency"),
      col("buyer_currency"),
      col("buyer_bid"),
      col("buyer_spend"),
      col("ecp"),
      col("reserve_price"),
      col("advertiser_id"),
      col("campaign_group_id"),
      col("campaign_id"),
      col("creative_freq"),
      col("creative_rec"),
      col("is_learn"),
      col("is_remarketing"),
      col("advertiser_frequency"),
      col("advertiser_recency"),
      col("user_group_id"),
      col("camp_dp_id"),
      col("media_buy_id"),
      col("media_buy_cost"),
      col("brand_id"),
      col("cleared_direct"),
      col("clear_fees"),
      col("media_buy_rev_share_pct"),
      col("revenue_value"),
      col("pricing_type"),
      col("can_convert"),
      col("pub_rule_id"),
      col("is_control"),
      col("control_pct"),
      col("control_creative_id"),
      col("predicted_cpm"),
      col("actual_bid"),
      col("site_id"),
      col("content_category_id"),
      col("auction_service_fees"),
      col("discrepancy_allowance"),
      col("forex_allowance"),
      col("creative_overage_fees"),
      col("fold_position"),
      col("external_inv_id"),
      col("cadence_modifier"),
      col("imp_type"),
      col("advertiser_currency"),
      col("advertiser_exchange_rate"),
      col("ip_address"),
      col("publisher_id"),
      col("auction_service_deduction"),
      col("insertion_order_id"),
      col("predict_type_rev"),
      col("predict_type_goal"),
      col("predict_type_cost"),
      col("booked_revenue_dollars"),
      col("booked_revenue_adv_curr"),
      col("commission_cpm"),
      col("commission_revshare"),
      col("serving_fees_cpm"),
      col("serving_fees_revshare"),
      col("user_tz_offset"),
      col("media_type"),
      col("operating_system"),
      col("browser"),
      col("language"),
      col("publisher_currency"),
      col("publisher_exchange_rate"),
      col("media_cost_dollars_cpm"),
      col("payment_type"),
      col("revenue_type"),
      col("seller_revenue_cpm"),
      col("bidder_id"),
      col("inv_code"),
      col("application_id"),
      col("shadow_price"),
      col("eap"),
      col("datacenter_id"),
      col("imp_blacklist_or_fraud"),
      col("vp_expose_domains"),
      col("vp_expose_categories"),
      col("vp_expose_pubs"),
      col("vp_expose_tag"),
      col("vp_expose_age"),
      col("vp_expose_gender"),
      col("inventory_url_id"),
      col("audit_type"),
      col("is_exclusive"),
      col("truncate_ip"),
      col("device_id"),
      col("carrier_id"),
      col("creative_audit_status"),
      col("is_creative_hosted"),
      col("seller_deduction"),
      col("city"),
      col("latitude"),
      col("longitude"),
      col("device_unique_id"),
      col("package_id"),
      col("targeted_segments"),
      col("supply_type"),
      col("is_toolbar"),
      col("deal_id"),
      col("vp_bitmap"),
      col("view_detection_enabled"),
      col("view_result"),
      col("ozone_id"),
      col("is_performance"),
      col("sdk_version"),
      col("inventory_session_frequency"),
      col("device_type"),
      col("dma"),
      col("postal"),
      col("viewdef_definition_id"),
      col("viewdef_viewable"),
      col("view_measurable"),
      col("viewable"),
      col("is_secure"),
      col("view_non_measurable_reason"),
      col("data_costs"),
      col("bidder_instance_id"),
      col("campaign_group_freq"),
      col("campaign_group_rec"),
      col("insertion_order_freq"),
      col("insertion_order_rec"),
      col("buyer_gender"),
      col("buyer_age"),
      col("targeted_segment_list"),
      col("custom_model_id"),
      col("custom_model_last_modified"),
      col("custom_model_output_code"),
      col("external_uid"),
      col("request_uuid"),
      col("mobile_app_instance_id"),
      col("traffic_source_code"),
      col("external_request_id"),
      col("stitch_group_id"),
      col("deal_type"),
      col("ym_floor_id"),
      col("ym_bias_id"),
      col("bid_priority"),
      col("buyer_charges"),
      col("seller_charges"),
      col("explore_disposition"),
      col("device_make_id"),
      col("operating_system_family_id"),
      col("tag_sizes"),
      col("campaign_group_models"),
      col("pricing_media_type"),
      col("buyer_trx_event_id"),
      col("seller_trx_event_id"),
      col("revenue_auction_event_type"),
      col("is_prebid"),
      col("is_unit_of_trx"),
      col("imps_for_budget_caps_pacing"),
      col("auction_timestamp"),
      col("two_phase_reduction_applied"),
      col("region_id"),
      col("media_company_id"),
      col("trade_agreement_id"),
      col("personal_data"),
      col("anonymized_user_info"),
      col("gdpr_consent_cookie"),
      col("additional_clearing_events"),
      col("fx_rate_snapshot_id"),
      col("crossdevice_group_anon"),
      col("crossdevice_graph_cost"),
      col("revenue_event_type_id"),
      col("buyer_trx_event_type_id"),
      col("seller_trx_event_type_id"),
      col("external_creative_id"),
      col("targeted_segment_details"),
      col("bidder_seat_id"),
      col("is_whiteops_scanned"),
      col("default_referrer_url"),
      col("is_curated"),
      col("curator_member_id"),
      col("total_partner_fees_microcents"),
      col("net_buyer_spend"),
      col("is_prebid_server"),
      col("cold_start_price_type"),
      col("discovery_state"),
      col("billing_period_id"),
      col("flight_id"),
      col("split_id"),
      col("net_media_cost_dollars_cpm"),
      col("total_data_costs_microcents"),
      col("total_profit_microcents"),
      col("targeted_crossdevice_graph_id"),
      col("discovery_prediction"),
      col("campaign_group_type_id"),
      col("hb_source"),
      col("external_campaign_id"),
      col("excluded_targeted_segment_details"),
      col("trust_id"),
      col("predicted_kpi_event_rate"),
      col("has_crossdevice_reach_extension"),
      col("crossdevice_graph_membership"),
      col("total_segment_data_costs_microcents"),
      col("total_feature_costs_microcents"),
      col("counterparty_ruleset_type"),
      col("log_product_ads"),
      col("buyer_line_item_currency"),
      col("deal_line_item_currency"),
      col("measurement_fee_usd"),
      col("measurement_provider_member_id"),
      col("offline_attribution_provider_member_id"),
      col("offline_attribution_cost_usd_cpm"),
      col("pred_info"),
      col("imp_rejecter_do_auction"),
      col("personal_identifiers"),
      col("imp_rejecter_applied"),
      col("ip_derived_latitude"),
      col("ip_derived_longitude"),
      col("personal_identifiers_experimental"),
      col("postal_code_ext_id"),
      col("ecpm_conversion_rate"),
      col("is_residential_ip"),
      col("hashed_ip"),
      col("targeted_segment_details_by_id_type"),
      col("offline_attribution"),
      col("frequency_cap_type_internal"),
      col("modeled_cap_did_override_line_item_daily_cap"),
      col("modeled_cap_user_sample_rate"),
      col("estimated_audience_imps"),
      col("audience_imps"),
      col("district_postal_code_lists"),
      col("bidding_host_id"),
      col("buyer_dpvp_bitmap"),
      col("seller_dpvp_bitmap"),
      col("browser_code_id"),
      col("is_prebid_server_included"),
      col("feature_tests_bitmap"),
      col("private_auction_eligible"),
      col("chrome_traffic_label"),
      col("is_private_auction"),
      col("creative_media_subtype_id"),
      col("allowed_media_types")
    )

}
