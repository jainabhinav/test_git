{"initCode":"","code":" \nudf({ (_virtual_log_dw_bid: Row, _f_is_buy_side: Int, log_dw_bid: Row, f_is_error_imp: Int, is_dw: Int, imp_type: Int, f_is_default_or_error_imp: Int, log_impbus_impressions_payment_type: Int, seller_trx_event_id: Int) =>\n  var virtual_log_dw_bid = _virtual_log_dw_bid\n  if (_f_is_buy_side == 0) {\n    if (log_dw_bid == null && (f_is_error_imp == 1 || is_dw == 1 && (imp_type == 2 || imp_type == 4))) {\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 1, 1)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 0, 1)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 48, 1)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 59, \"--\")\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 46, \"\\\\\\\\N\")\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 62, 0)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 10, -2)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 11, -2)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 51, -2)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 52, -2)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 8, -2)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 9, -2)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 53, -2)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 54, -2)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 18, \"---\")\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 24, \"USD\")\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 25, 1)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 55, \"u\")\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 23, 1)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 20, 2)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 27, -1)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 28, -1)\n    } else {\n      if (f_is_default_or_error_imp == 1) {\n        if (log_dw_bid != null) virtual_log_dw_bid = log_dw_bid\n        if (f_is_default_or_error_imp == 1) {\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 10, -2)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 11, -2)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 51, -2)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 52, -2)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 8, -2)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 9, -2)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 53, -2)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 54, -2)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 4, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 6, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 5, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 7, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 23, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 12, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 72, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 73, 0)\n        }\n        if (f_is_error_imp == 1) {\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 24, \"USD\")\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 25, 1.0d)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 55, \"u\")\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 56, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 19, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 20, 2)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 21, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 22, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 27, -1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 28, -1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 18, \"---\")\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 7, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 26, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 43, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 16, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 23, 1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 31, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 32, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 14, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 17, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 2, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 33, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 34, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 29, 0)\n        }\n      } else {\n        if (imp_type == 9 || imp_type == 2 || imp_type == 5) {\n          virtual_log_dw_bid = log_dw_bid\n        } else {\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 1, 1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 0, 1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 48, 1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 10, -1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 11, -1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 51, -1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 52, -1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 8, -1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 9, -1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 53, -1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 54, -1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 57, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 58, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 59, \"---\")\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 24, \"USD\")\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 25, 1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 18, \"---\")\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 66, 2)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 41, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 37, log_impbus_impressions_payment_type)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 62, seller_trx_event_id)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 28, -2)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 27, -2)\n        }\n      }\n    }\n  }\n  virtual_log_dw_bid\n},\n StructType(\n  Array(\n    StructField(\"date_time\", LongType, true),\n    StructField(\"auction_id_64\", LongType, true),\n    StructField(\"price\", DoubleType, true),\n    StructField(\"member_id\", IntegerType, true),\n    StructField(\"advertiser_id\", IntegerType, true),\n    StructField(\"campaign_group_id\", IntegerType, true),\n    StructField(\"campaign_id\", IntegerType, true),\n    StructField(\"creative_id\", IntegerType, true),\n    StructField(\"creative_freq\", IntegerType, true),\n    StructField(\"creative_rec\", IntegerType, true),\n    StructField(\"advertiser_freq\", IntegerType, true),\n    StructField(\"advertiser_rec\", IntegerType, true),\n    StructField(\"is_remarketing\", IntegerType, true),\n    StructField(\"user_group_id\", IntegerType, true),\n    StructField(\"media_buy_cost\", DoubleType, true),\n    StructField(\"is_default\", IntegerType, true),\n    StructField(\"pub_rule_id\", IntegerType, true),\n    StructField(\"media_buy_rev_share_pct\", DoubleType, true),\n    StructField(\"pricing_type\", StringType, true),\n    StructField(\"can_convert\", IntegerType, true),\n    StructField(\"is_control\", IntegerType, true),\n    StructField(\"control_pct\", DoubleType, true),\n    StructField(\"control_creative_id\", IntegerType, true),\n    StructField(\"cadence_modifier\", DoubleType, true),\n    StructField(\"advertiser_currency\", StringType, true),\n    StructField(\"advertiser_exchange_rate\", DoubleType, true),\n    StructField(\"insertion_order_id\", IntegerType, true),\n    StructField(\"predict_type\", IntegerType, true),\n    StructField(\"predict_type_goal\", IntegerType, true),\n    StructField(\"revenue_value_dollars\", DoubleType, true),\n    StructField(\"revenue_value_adv_curr\", DoubleType, true),\n    StructField(\"commission_cpm\", DoubleType, true),\n    StructField(\"commission_revshare\", DoubleType, true),\n    StructField(\"serving_fees_cpm\", DoubleType, true),\n    StructField(\"serving_fees_revshare\", DoubleType, true),\n    StructField(\"publisher_currency\", StringType, true),\n    StructField(\"publisher_exchange_rate\", DoubleType, true),\n    StructField(\"payment_type\", IntegerType, true),\n    StructField(\"payment_value\", DoubleType, true),\n    StructField(\"creative_group_freq\", IntegerType, true),\n    StructField(\"creative_group_rec\", IntegerType, true),\n    StructField(\"revenue_type\", IntegerType, true),\n    StructField(\"apply_cost_on_default\", IntegerType, true),\n    StructField(\"instance_id\", IntegerType, true),\n    StructField(\"vp_expose_age\", IntegerType, true),\n    StructField(\"vp_expose_gender\", IntegerType, true),\n    StructField(\"targeted_segments\", StringType, true),\n    StructField(\"ttl\", IntegerType, true),\n    StructField(\"auction_timestamp\", LongType, true),\n    StructField(\n      \"data_costs\",\n      ArrayType(\n        StructType(\n          Array(\n            StructField(\"data_member_id\", IntegerType, true),\n            StructField(\"cost\", DoubleType, true),\n            StructField(\"used_segments\", ArrayType(IntegerType, true), true),\n            StructField(\"cost_pct\", DoubleType, true)\n          )\n        ),\n        true\n      ),\n      true\n    ),\n    StructField(\"targeted_segment_list\", ArrayType(IntegerType, true), true),\n    StructField(\"campaign_group_freq\", IntegerType, true),\n    StructField(\"campaign_group_rec\", IntegerType, true),\n    StructField(\"insertion_order_freq\", IntegerType, true),\n    StructField(\"insertion_order_rec\", IntegerType, true),\n    StructField(\"buyer_gender\", StringType, true),\n    StructField(\"buyer_age\", IntegerType, true),\n    StructField(\"custom_model_id\", IntegerType, true),\n    StructField(\"custom_model_last_modified\", LongType, true),\n    StructField(\"custom_model_output_code\", StringType, true),\n    StructField(\"bid_priority\", IntegerType, true),\n    StructField(\"explore_disposition\", IntegerType, true),\n    StructField(\"revenue_auction_event_type\", IntegerType, true),\n    StructField(\n      \"campaign_group_models\",\n      ArrayType(\n        StructType(\n          Array(\n            StructField(\"model_type\", IntegerType, true),\n            StructField(\"model_id\", IntegerType, true),\n            StructField(\"leaf_code\", StringType, true),\n            StructField(\"origin\", IntegerType, true),\n            StructField(\"experiment\", IntegerType, true),\n            StructField(\"value\", FloatType, true)\n          )\n        ),\n        true\n      ),\n      true\n    ),\n    StructField(\"impression_transaction_type\", IntegerType, true),\n    StructField(\"is_deferred\", IntegerType, true),\n    StructField(\"log_type\", IntegerType, true),\n    StructField(\n      \"crossdevice_group_anon\",\n      StructType(\n        Array(\n          StructField(\"graph_id\", IntegerType, true),\n          StructField(\"group_id\", BinaryType, true)\n        )\n      ),\n      true\n    ),\n    StructField(\"fx_rate_snapshot_id\", IntegerType, true),\n    StructField(\n      \"crossdevice_graph_cost\",\n      StructType(\n        Array(\n          StructField(\"graph_provider_member_id\", IntegerType, true),\n          StructField(\"cost_cpm_usd\", DoubleType, true)\n        )\n      ),\n      true\n    ),\n    StructField(\"revenue_event_type_id\", IntegerType, true),\n    StructField(\n      \"targeted_segment_details\",\n      ArrayType(\n        StructType(\n          Array(\n            StructField(\"segment_id\", IntegerType, true),\n            StructField(\"last_seen_min\", IntegerType, true)\n          )\n        ),\n        true\n      ),\n      true\n    ),\n    StructField(\"insertion_order_budget_interval_id\", IntegerType, true),\n    StructField(\"campaign_group_budget_interval_id\", IntegerType, true),\n    StructField(\"cold_start_price_type\", IntegerType, true),\n    StructField(\"discovery_state\", IntegerType, true),\n    StructField(\n      \"revenue_info\",\n      StructType(\n        Array(\n          StructField(\"total_partner_fees_microcents\", LongType, true),\n          StructField(\"booked_revenue_dollars\", DoubleType, true),\n          StructField(\"booked_revenue_adv_curr\", DoubleType, true),\n          StructField(\"total_data_costs_microcents\", LongType, true),\n          StructField(\"total_profit_microcents\", LongType, true),\n          StructField(\"total_segment_data_costs_microcents\", LongType, true),\n          StructField(\"total_feature_costs_microcents\", LongType, true)\n        )\n      ),\n      true\n    ),\n    StructField(\"use_revenue_info\", BooleanType, true),\n    StructField(\"sales_tax_rate_pct\", DoubleType, true),\n    StructField(\"targeted_crossdevice_graph_id\", IntegerType, true),\n    StructField(\"product_feed_id\", IntegerType, true),\n    StructField(\"item_selection_strategy_id\", IntegerType, true),\n    StructField(\"discovery_prediction\", DoubleType, true),\n    StructField(\"bidding_host_id\", IntegerType, true),\n    StructField(\"split_id\", IntegerType, true),\n    StructField(\n      \"excluded_targeted_segment_details\",\n      ArrayType(\n        StructType(Array(StructField(\"segment_id\", IntegerType, true))),\n        true\n      ),\n      true\n    ),\n    StructField(\"predicted_kpi_event_rate\", DoubleType, true),\n    StructField(\"has_crossdevice_reach_extension\", BooleanType, true),\n    StructField(\"advertiser_expected_value_ecpm_ac\", DoubleType, true),\n    StructField(\"bpp_multiplier\", DoubleType, true),\n    StructField(\"bpp_offset\", DoubleType, true),\n    StructField(\"bid_modifier\", DoubleType, true),\n    StructField(\"payment_value_microcents\", LongType, true),\n    StructField(\n      \"crossdevice_graph_membership\",\n      ArrayType(\n        StructType(\n          Array(\n            StructField(\"graph_id\", IntegerType, true),\n            StructField(\"group_id\", BinaryType, true)\n          )\n        ),\n        true\n      ),\n      true\n    ),\n    StructField(\n      \"valuation_landscape\",\n      ArrayType(\n        StructType(\n          Array(\n            StructField(\"kpi_event_id\", IntegerType, true),\n            StructField(\"ev_kpi_event_ac\", DoubleType, true),\n            StructField(\"p_kpi_event\", DoubleType, true),\n            StructField(\"bpo_aggressiveness_factor\", DoubleType, true),\n            StructField(\"min_margin_pct\", DoubleType, true),\n            StructField(\"max_revenue_or_bid_value\", DoubleType, true),\n            StructField(\"min_revenue_or_bid_value\", DoubleType, true),\n            StructField(\"cold_start_price_ac\", DoubleType, true),\n            StructField(\"dynamic_bid_max_revenue_ac\", DoubleType, true),\n            StructField(\"p_revenue_event\", DoubleType, true),\n            StructField(\"total_fees_deducted_ac\", DoubleType, true)\n          )\n        ),\n        true\n      ),\n      true\n    ),\n    StructField(\"line_item_currency\", StringType, true),\n    StructField(\"measurement_fee_cpm_usd\", DoubleType, true),\n    StructField(\"measurement_provider_id\", IntegerType, true),\n    StructField(\"measurement_provider_member_id\", IntegerType, true),\n    StructField(\"offline_attribution_provider_member_id\", IntegerType, true),\n    StructField(\"offline_attribution_cost_usd_cpm\", DoubleType, true),\n    StructField(\n      \"targeted_segment_details_by_id_type\",\n      ArrayType(\n        StructType(\n          Array(\n            StructField(\"identity_type\", IntegerType, true),\n            StructField(\n              \"targeted_segment_details\",\n              ArrayType(\n                StructType(\n                  Array(\n                    StructField(\"segment_id\", IntegerType, true),\n                    StructField(\"last_seen_min\", IntegerType, true)\n                  )\n                ),\n                true\n              ),\n              true\n            )\n          )\n        ),\n        true\n      ),\n      true\n    ),\n    StructField(\n      \"offline_attribution\",\n      ArrayType(\n        StructType(\n          Array(\n            StructField(\"provider_member_id\", IntegerType, true),\n            StructField(\"cost_usd_cpm\", DoubleType, true)\n          )\n        ),\n        true\n      ),\n      true\n    ),\n    StructField(\"frequency_cap_type_internal\", IntegerType, true),\n    StructField(\n      \"modeled_cap_did_override_line_item_daily_cap\",\n      BooleanType,\n      true\n    ),\n    StructField(\"modeled_cap_user_sample_rate\", DoubleType, true),\n    StructField(\"bid_rate\", DoubleType, true),\n    StructField(\n      \"district_postal_code_lists\",\n      ArrayType(IntegerType, true),\n      true\n    ),\n    StructField(\"pre_bpp_price\", DoubleType, true),\n    StructField(\"feature_tests_bitmap\", IntegerType, true)\n  )\n)\n)\n"}