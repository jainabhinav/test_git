{"initCode":"","code":"udf((_current_date: Integer, _current_hour: Integer) => {\n  var current_hour = _current_hour\nvar current_date = _current_date\n \nwhile(compareTo(current_hour, 0) < 0) {\ncurrent_date = current_date - 1\ncurrent_hour = current_hour + 24\n}\n\n\nwhile(compareTo(current_hour, 24) >= 0) {\ncurrent_date = current_date + 1\ncurrent_hour = current_hour - 24\n}\n\nRow(convertToInt(current_hour), convertToInt(current_date))\n},  StructType(\n      List(\n      StructField(\"current_hour\", IntegerType, false),StructField(\"current_date\", IntegerType, false)\n      )\n    ))"}