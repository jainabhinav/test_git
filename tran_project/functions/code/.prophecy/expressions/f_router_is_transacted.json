{"parameters":[{"name":"in1","type":"column","metadata":{"description":"","tags":[],"mappings":[]}}],"isCustomSchemaEnabled":false,"code":"var has_imp:      org.apache.spark.sql.Column = lit(0)\n  var is_delivered: org.apache.spark.sql.Column = lit(0)\n  var has_preempt:  org.apache.spark.sql.Column = lit(0)\n  has_imp =\n    when(is_not_null(in1.getField(\"log_impbus_impressions\")).cast(BooleanType),\n         lit(1)\n    ).otherwise(has_imp).cast(IntegerType)\n  is_delivered = when(\n    is_not_null(in1.getField(\"log_impbus_impressions\").getField(\"is_delivered\"))\n      .and(\n        in1.getField(\"log_impbus_impressions\").getField(\"is_delivered\") === lit(\n          1\n        )\n      ),\n    lit(1)\n  ).otherwise(is_delivered).cast(IntegerType)\n  has_preempt =\n    when(is_not_null(in1.getField(\"log_impbus_preempt\")).cast(BooleanType),\n         lit(1)\n    ).otherwise(has_preempt).cast(IntegerType)\n  (has_imp === lit(1)).and((has_preempt === lit(1)).or(is_delivered === lit(1)))","language":"scala","description":""}