{"parameters":[{"name":"preempt_exists","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"impression_value","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"preempt_value","type":"column","metadata":{"description":"","tags":[],"mappings":[]}}],"isCustomSchemaEnabled":false,"code":"coalesce(\n      when(preempt_exists\n        .cast(BooleanType)\n        .and(is_not_null(preempt_value))\n        .and(preempt_value =!= lit(0)),\n        preempt_value\n      ),\n      when(not(preempt_exists.cast(BooleanType))\n        .and(is_not_null(impression_value))\n        .and(impression_value =!= lit(0)),\n        impression_value\n      ),\n      lit(null)\n    )","language":"scala","description":""}