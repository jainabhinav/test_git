{"parameters":[{"name":"term_id","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"pricing_terms","type":"column","metadata":{"description":"","tags":[],"mappings":[]}}],"output":{"type":"struct","fields":[{"name":"term_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amount","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_deduction","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_media_cost_dependent","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"data_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"isCustomSchemaEnabled":true,"code":"when(\n      is_not_null(\n        when(is_not_null(pricing_terms).cast(BooleanType), pricing_terms)\n          .otherwise(\n            lit(null).cast(\n              ArrayType(\n                StructType(\n                  List(\n                    StructField(\"term_id\",                 IntegerType, true),\n                    StructField(\"amount\",                  DoubleType,  true),\n                    StructField(\"rate\",                    DoubleType,  true),\n                    StructField(\"is_deduction\",            BooleanType, true),\n                    StructField(\"is_media_cost_dependent\", BooleanType, true),\n                    StructField(\"data_member_id\",          IntegerType, true)\n                  )\n                ),\n                true\n              )\n            )\n          )\n      ).cast(BooleanType),\n      temp1248596_UDF(\n        lit(0),\n        term_id,\n        when(is_not_null(pricing_terms).cast(BooleanType), pricing_terms)\n          .otherwise(\n            lit(null).cast(\n              ArrayType(\n                StructType(\n                  List(\n                    StructField(\"term_id\",                 IntegerType, true),\n                    StructField(\"amount\",                  DoubleType,  true),\n                    StructField(\"rate\",                    DoubleType,  true),\n                    StructField(\"is_deduction\",            BooleanType, true),\n                    StructField(\"is_media_cost_dependent\", BooleanType, true),\n                    StructField(\"data_member_id\",          IntegerType, true)\n                  )\n                ),\n                true\n              )\n            )\n          ),\n        lit(0)\n      ).getField(\"l_pricing_term\")\n    ).otherwise(\n      lit(null).cast(\n        StructType(\n          List(\n            StructField(\"term_id\",                 IntegerType, true),\n            StructField(\"amount\",                  DoubleType,  true),\n            StructField(\"rate\",                    DoubleType,  true),\n            StructField(\"is_deduction\",            BooleanType, true),\n            StructField(\"is_media_cost_dependent\", BooleanType, true),\n            StructField(\"data_member_id\",          IntegerType, true)\n          )\n        )\n      )\n    )","language":"scala","description":""}