{"initCode":"\ndef convertToDouble(input: Any): Double = {\n    try {\n      input match {\n        case x: Boolean    ⇒ if (x) 1 else 0\n        case x: Int        ⇒ x.toDouble\n        case x: Integer    ⇒ x.toDouble\n        case x: Long       ⇒ x.toDouble\n        case x: BigDecimal ⇒ x.toDouble\n        case x: Double     ⇒ x\n        case x: Float      ⇒ x.toDouble\n        case \"null\" ⇒ Double.MinValue\n        case x: String ⇒ x.toDouble\n        case x @ _ ⇒ x.toString.toDouble\n      }\n    } catch {\n      case _: Throwable ⇒ Double.MinValue\n    }\n  }\n","code":"udf(\n    (_input: Seq[Row]) => {\n      var input = _input.toArray\n      var out = Row(\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        Row(\n          null,\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          null,\n          null.asInstanceOf[String],\n          null,\n          null,\n          null.asInstanceOf[String],\n          null.asInstanceOf[String],\n          null.asInstanceOf[String],\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          null.asInstanceOf[String],\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          null.asInstanceOf[String],\n          null,\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          null,\n          null.asInstanceOf[String],\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          null.asInstanceOf[String],\n          null.asInstanceOf[String],\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          null,\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          null,\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          null,\n          null,\n          null.asInstanceOf[String],\n          null.asInstanceOf[String],\n          null,\n          null.asInstanceOf[String],\n          null.asInstanceOf[String],\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          Row(null, null),\n          Row(null, null),\n          Row(null, null, null, null, null, null),\n          Row(null.asInstanceOf[String]),\n          null,\n          null,\n          null,\n          Row(null, null),\n          null,\n          null.asInstanceOf[String],\n          null,\n          null.asInstanceOf[String],\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          Row(null),\n          null,\n          null,\n          null.asInstanceOf[String],\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          Row(null, null, null.asInstanceOf[String]),\n          null,\n          null,\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          null.asInstanceOf[String],\n          null,\n          null.asInstanceOf[String],\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          null\n        ),\n        null,\n        Row(\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          Row(null, null),\n          Row(null, null),\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          null.asInstanceOf[String],\n          Row(null, null, null.asInstanceOf[String]),\n          null,\n          null,\n          null\n        ),\n        Row(\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          Row(null, null),\n          Row(null, null),\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          null.asInstanceOf[String],\n          Row(null, null, null.asInstanceOf[String]),\n          null,\n          null,\n          null\n        ),\n        null,\n        Row(\n          null,\n          null,\n          Row(null, null, null, null, null, null, null, null),\n          Row(null, null, null, null, null, null, null, null),\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          Row(null, null, null),\n          null,\n          null,\n          Row(null,\n              null,\n              null,\n              Row(null, null, null, null, null, null, null, null),\n              Row(null, null, null, null, null, null, null, null),\n              null,\n              null\n          ),\n          null,\n          null,\n          null\n        ),\n        Row(\n          null,\n          null,\n          Row(null, null, null, null, null, null, null, null),\n          Row(null, null, null, null, null, null, null, null),\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          Row(null, null, null),\n          null,\n          null,\n          Row(null,\n              null,\n              null,\n              Row(null, null, null, null, null, null, null, null),\n              Row(null, null, null, null, null, null, null, null),\n              null,\n              null\n          ),\n          null,\n          null,\n          null\n        )\n      )\n      var i = 0\n      \n      while (compareTo(i, input.length) < 0) {\n        var in   = input(convertToInt(i))\n        var temp = out\n        if (i == 0) {\n          out = updateIndexInRow(out,\n                                 0,\n                                 convertToLong(in.getAs[Long](\"auction_id_64\"))\n          )\n          out =\n            updateIndexInRow(out, 1, convertToLong(in.getAs[Long](\"date_time\")))\n          out =\n            updateIndexInRow(out, 3, convertToInt(in.getAs[Integer](\"is_dw\")))\n          out =\n            updateIndexInRow(out,\n                             5,\n                             convertToInt(in.getAs[Integer](\"buyer_member_id\"))\n            )\n          out = updateIndexInRow(out,\n                                 14,\n                                 convertToInt(in.getAs[Integer](\"imp_type\"))\n          )\n          out = updateIndexInRow(out, 20, 0)\n        }\n        temp = out\n        var log_impbus_preempt_last = Row(\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          Row(null, null),\n          Row(null, null),\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          null.asInstanceOf[String],\n          Row(null, null, null.asInstanceOf[String]),\n          null,\n          null,\n          null\n        )\n        var log_impbus_preempt_first = Row(\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          Row(null, null),\n          Row(null, null),\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          null,\n          null,\n          null,\n          null.asInstanceOf[String],\n          null.asInstanceOf[String],\n          Row(null, null, null.asInstanceOf[String]),\n          null,\n          null,\n          null\n        )\n        if (\n          ((!temp.getAs[Row](21).isNullAt(44)) && (!_isnull(\n            convertToLong(in.getAs[Long](\"accept_timestamp\"))\n          ))) && (compareTo(convertToLong(in.getAs[Long](\"accept_timestamp\")),\n                            temp.getAs[Row](21).getAs[Long](44)\n          ) < 0)\n        ) {\n          log_impbus_preempt_last = in\n          log_impbus_preempt_first = temp.getAs[Row](21)\n        } else if (temp.getAs[Row](21).isNullAt(44)) {\n          log_impbus_preempt_last = in\n          log_impbus_preempt_first = temp.getAs[Row](21)\n        } else {\n          log_impbus_preempt_last = temp.getAs[Row](21)\n          log_impbus_preempt_first = in\n        }\n        out = updateIndexInRow(out, 0, log_impbus_preempt_last.getAs[Long](1))\n        out = updateIndexInRow(out, 1, log_impbus_preempt_last.getAs[Long](0))\n        out =\n          updateIndexInRow(out, 3, log_impbus_preempt_last.getAs[Integer](26))\n        out =\n          updateIndexInRow(out, 5, log_impbus_preempt_last.getAs[Integer](9))\n        out =\n          updateIndexInRow(out,     14, log_impbus_preempt_last.getAs[Integer](25))\n        out = updateIndexInRow(out, 20, temp.getAs[Integer](20) + 1)\n        out = updateIndexInRow(out, 21, log_impbus_preempt_last)\n        out = updateIndexInRow(out, 22, log_impbus_preempt_first)\n        i = i + convertToInt(1)\n      }\n\n      out\n    },\n    StructType(\n      List(\n        StructField(\"auction_id_64\",            LongType,    true),\n        StructField(\"date_time\",                LongType,    true),\n        StructField(\"is_delivered\",             IntegerType, true),\n        StructField(\"is_dw\",                    IntegerType, true),\n        StructField(\"seller_member_id\",         IntegerType, true),\n        StructField(\"buyer_member_id\",          IntegerType, true),\n        StructField(\"member_id\",                IntegerType, true),\n        StructField(\"publisher_id\",             IntegerType, true),\n        StructField(\"site_id\",                  IntegerType, true),\n        StructField(\"tag_id\",                   IntegerType, true),\n        StructField(\"advertiser_id\",            IntegerType, true),\n        StructField(\"campaign_group_id\",        IntegerType, true),\n        StructField(\"campaign_id\",              IntegerType, true),\n        StructField(\"insertion_order_id\",       IntegerType, true),\n        StructField(\"imp_type\",                 IntegerType, true),\n        StructField(\"is_transactable\",          BooleanType, true),\n        StructField(\"is_transacted_previously\", BooleanType, true),\n        StructField(\"is_deferred_impression\",   BooleanType, true),\n        StructField(\"has_null_bid\",             BooleanType, true),\n        StructField(\n          \"log_impbus_impressions\",\n          StructType(\n            List(\n              StructField(\"date_time\",                   LongType,    true),\n              StructField(\"auction_id_64\",               LongType,    true),\n              StructField(\"user_id_64\",                  LongType,    true),\n              StructField(\"tag_id\",                      IntegerType, true),\n              StructField(\"ip_address\",                  StringType,  true),\n              StructField(\"venue_id\",                    IntegerType, true),\n              StructField(\"site_domain\",                 StringType,  true),\n              StructField(\"width\",                       IntegerType, true),\n              StructField(\"height\",                      IntegerType, true),\n              StructField(\"geo_country\",                 StringType,  true),\n              StructField(\"geo_region\",                  StringType,  true),\n              StructField(\"gender\",                      StringType,  true),\n              StructField(\"age\",                         IntegerType, true),\n              StructField(\"bidder_id\",                   IntegerType, true),\n              StructField(\"seller_member_id\",            IntegerType, true),\n              StructField(\"buyer_member_id\",             IntegerType, true),\n              StructField(\"creative_id\",                 IntegerType, true),\n              StructField(\"imp_blacklist_or_fraud\",      IntegerType, true),\n              StructField(\"imp_bid_on\",                  IntegerType, true),\n              StructField(\"buyer_bid\",                   DoubleType,  true),\n              StructField(\"buyer_spend\",                 DoubleType,  true),\n              StructField(\"seller_revenue\",              DoubleType,  true),\n              StructField(\"num_of_bids\",                 IntegerType, true),\n              StructField(\"ecp\",                         DoubleType,  true),\n              StructField(\"reserve_price\",               DoubleType,  true),\n              StructField(\"inv_code\",                    StringType,  true),\n              StructField(\"call_type\",                   StringType,  true),\n              StructField(\"inventory_source_id\",         IntegerType, true),\n              StructField(\"cookie_age\",                  IntegerType, true),\n              StructField(\"brand_id\",                    IntegerType, true),\n              StructField(\"cleared_direct\",              IntegerType, true),\n              StructField(\"forex_allowance\",             DoubleType,  true),\n              StructField(\"fold_position\",               IntegerType, true),\n              StructField(\"external_inv_id\",             IntegerType, true),\n              StructField(\"imp_type\",                    IntegerType, true),\n              StructField(\"is_delivered\",                IntegerType, true),\n              StructField(\"is_dw\",                       IntegerType, true),\n              StructField(\"publisher_id\",                IntegerType, true),\n              StructField(\"site_id\",                     IntegerType, true),\n              StructField(\"content_category_id\",         IntegerType, true),\n              StructField(\"datacenter_id\",               IntegerType, true),\n              StructField(\"eap\",                         DoubleType,  true),\n              StructField(\"user_tz_offset\",              IntegerType, true),\n              StructField(\"user_group_id\",               IntegerType, true),\n              StructField(\"pub_rule_id\",                 IntegerType, true),\n              StructField(\"media_type\",                  IntegerType, true),\n              StructField(\"operating_system\",            IntegerType, true),\n              StructField(\"browser\",                     IntegerType, true),\n              StructField(\"language\",                    IntegerType, true),\n              StructField(\"application_id\",              StringType,  true),\n              StructField(\"user_locale\",                 StringType,  true),\n              StructField(\"inventory_url_id\",            IntegerType, true),\n              StructField(\"audit_type\",                  IntegerType, true),\n              StructField(\"shadow_price\",                DoubleType,  true),\n              StructField(\"impbus_id\",                   IntegerType, true),\n              StructField(\"buyer_currency\",              StringType,  true),\n              StructField(\"buyer_exc hhhange_rate\",         DoubleType,  true),\n              StructField(\"seller_currency\",             StringType,  true),\n              StructField(\"seller_exchange_rate\",        DoubleType,  true),\n              StructField(\"vp_expose_domains\",           IntegerType, true),\n              StructField(\"vp_expose_categories\",        IntegerType, true),\n              StructField(\"vp_expose_pubs\",              IntegerType, true),\n              StructField(\"vp_expose_tag\",               IntegerType, true),\n              StructField(\"is_exclusive\",                IntegerType, true),\n              StructField(\"bidder_instance_id\",          IntegerType, true),\n              StructField(\"visibility_profile_id\",       IntegerType, true),\n              StructField(\"truncate_ip\",                 IntegerType, true),\n              StructField(\"device_id\",                   IntegerType, true),\n              StructField(\"carrier_id\",                  IntegerType, true),\n              StructField(\"creative_audit_status\",       IntegerType, true),\n              StructField(\"is_creative_hosted\",          IntegerType, true),\n              StructField(\"city\",                        IntegerType, true),\n              StructField(\"latitude\",                    StringType,  true),\n              StructField(\"longitude\",                   StringType,  true),\n              StructField(\"device_unique_id\",            StringType,  true),\n              StructField(\"supply_type\",                 IntegerType, true),\n              StructField(\"is_toolbar\",                  IntegerType, true),\n              StructField(\"deal_id\",                     IntegerType, true),\n              StructField(\"vp_bitmap\",                   LongType,    true),\n              StructField(\"ttl\",                         IntegerType, true),\n              StructField(\"view_detection_enabled\",      IntegerType, true),\n              StructField(\"ozone_id\",                    IntegerType, true),\n              StructField(\"is_performance\",              IntegerType, true),\n              StructField(\"sdk_version\",                 StringType,  true),\n              StructField(\"inventory_session_frequency\", IntegerType, true),\n              StructField(\"bid_price_type\",              IntegerType, true),\n              StructField(\"device_type\",                 IntegerType, true),\n              StructField(\"dma\",                         IntegerType, true),\n              StructField(\"postal\",                      StringType,  true),\n              StructField(\"package_id\",                  IntegerType, true),\n              StructField(\"spend_protection\",            IntegerType, true),\n              StructField(\"is_secure\",                   IntegerType, true),\n              StructField(\"estimated_view_rate\",         DoubleType,  true),\n              StructField(\"external_request_id\",         StringType,  true),\n              StructField(\"viewdef_definition_id_buyer_member\",\n                          IntegerType,\n                          true\n              ),\n              StructField(\"spend_protection_pixel_id\",      IntegerType, true),\n              StructField(\"external_uid\",                   StringType,  true),\n              StructField(\"request_uuid\",                   StringType,  true),\n              StructField(\"mobile_app_instance_id\",         IntegerType, true),\n              StructField(\"traffic_source_code\",            StringType,  true),\n              StructField(\"stitch_group_id\",                StringType,  true),\n              StructField(\"deal_type\",                      IntegerType, true),\n              StructField(\"ym_floor_id\",                    IntegerType, true),\n              StructField(\"ym_bias_id\",                     IntegerType, true),\n              StructField(\"estimated_view_rate_over_total\", DoubleType,  true),\n              StructField(\"device_make_id\",                 IntegerType, true),\n              StructField(\"operating_system_family_id\",     IntegerType, true),\n              StructField(\"tag_sizes\",\n                          ArrayType(\n                            StructType(\n                              List(\n                                StructField(\"width\",  IntegerType, true),\n                                StructField(\"height\", IntegerType, true)\n                              )\n                            )\n                          ),\n                          true\n              ),\n              StructField(\n                \"seller_transaction_def\",\n                StructType(\n                  List(\n                    StructField(\"transaction_event\",         IntegerType, true),\n                    StructField(\"transaction_event_type_id\", IntegerType, true)\n                  )\n                ),\n                true\n              ),\n              StructField(\n                \"buyer_transaction_def\",\n                StructType(\n                  List(\n                    StructField(\"transaction_event\",         IntegerType, true),\n                    StructField(\"transaction_event_type_id\", IntegerType, true)\n                  )\n                ),\n                true\n              ),\n              StructField(\n                \"predicted_video_view_info\",\n                StructType(\n                  List(\n                    StructField(\"iab_view_rate_over_measured\",\n                                DoubleType,\n                                true\n                    ),\n                    StructField(\"iab_view_rate_over_total\", DoubleType, true),\n                    StructField(\"predicted_100pv50pd_video_view_rate\",\n                                DoubleType,\n                                true\n                    ),\n                    StructField(\n                      \"predicted_100pv50pd_video_view_rate_over_total\",\n                      DoubleType,\n                      true\n                    ),\n                    StructField(\"video_completion_rate\",  DoubleType,  true),\n                    StructField(\"view_prediction_source\", IntegerType, true)\n                  )\n                ),\n                true\n              ),\n              StructField(\"auction_url\",\n                          StructType(\n                            List(\n                              StructField(\"site_url\", StringType, true)\n                            )\n                          ),\n                          true\n              ),\n              StructField(\"allowed_media_types\",     ArrayType(IntegerType), true),\n              StructField(\"is_imp_rejecter_applied\", BooleanType,            true),\n              StructField(\"imp_rejecter_do_auction\", BooleanType,            true),\n              StructField(\"geo_location\",\n                          StructType(\n                            List(\n                              StructField(\"latitude\",  FloatType, true),\n                              StructField(\"longitude\", FloatType, true)\n                            )\n                          ),\n                          true\n              ),\n              StructField(\"seller_bid_currency_conversion_rate\",\n                          DoubleType,\n                          true\n              ),\n              StructField(\"seller_bid_currency_code\", StringType,  true),\n              StructField(\"is_prebid\",                BooleanType, true),\n              StructField(\"default_referrer_url\",     StringType,  true),\n              StructField(\n                \"engagement_rates\",\n                ArrayType(\n                  StructType(\n                    List(\n                      StructField(\"engagement_rate_type\",    IntegerType, true),\n                      StructField(\"rate\",                    DoubleType,  true),\n                      StructField(\"engagement_rate_type_id\", IntegerType, true)\n                    )\n                  )\n                ),\n                true\n              ),\n              StructField(\"fx_rate_snapshot_id\",     IntegerType, true),\n              StructField(\"payment_type\",            IntegerType, true),\n              StructField(\"apply_cost_on_default\",   IntegerType, true),\n              StructField(\"media_buy_cost\",          DoubleType,  true),\n              StructField(\"media_buy_rev_share_pct\", DoubleType,  true),\n              StructField(\"auction_duration_ms\",     IntegerType, true),\n              StructField(\"expected_events\",         IntegerType, true),\n              StructField(\"anonymized_user_info\",\n                          StructType(\n                            List(\n                              StructField(\"user_id\", BinaryType, true)\n                            )\n                          ),\n                          true\n              ),\n              StructField(\"region_id\",                 IntegerType, true),\n              StructField(\"media_company_id\",          IntegerType, true),\n              StructField(\"gdpr_consent_cookie\",       StringType,  true),\n              StructField(\"subject_to_gdpr\",           BooleanType, true),\n              StructField(\"browser_code_id\",           IntegerType, true),\n              StructField(\"is_prebid_server_included\", IntegerType, true),\n              StructField(\"seat_id\",                   IntegerType, true),\n              StructField(\"uid_source\",                IntegerType, true),\n              StructField(\"is_whiteops_scanned\",       BooleanType, true),\n              StructField(\"pred_info\",                 IntegerType, true),\n              StructField(\"crossdevice_groups\",\n                          ArrayType(\n                            StructType(\n                              List(\n                                StructField(\"graph_id\", IntegerType, true),\n                                StructField(\"group_id\", LongType,    true)\n                              )\n                            )\n                          ),\n                          true\n              ),\n              StructField(\"is_amp\",               BooleanType, true),\n              StructField(\"hb_source\",            IntegerType, true),\n              StructField(\"external_campaign_id\", StringType,  true),\n              StructField(\n                \"log_product_ads\",\n                StructType(\n                  List(\n                    StructField(\"product_feed_id\", IntegerType, true),\n                    StructField(\"item_selection_strategy_id\",\n                                IntegerType,\n                                true\n                    ),\n                    StructField(\"product_uuid\", StringType, true)\n                  )\n                ),\n                true\n              ),\n              StructField(\"ss_native_assembly_enabled\", BooleanType, true),\n              StructField(\"emp\",                        DoubleType,  true),\n              StructField(\n                \"personal_identifiers\",\n                ArrayType(\n                  StructType(\n                    List(\n                      StructField(\"identity_type\",  IntegerType, true),\n                      StructField(\"identity_value\", StringType,  true)\n                    )\n                  )\n                ),\n                true\n              ),\n              StructField(\n                \"personal_identifiers_experimental\",\n                ArrayType(\n                  StructType(\n                    List(\n                      StructField(\"identity_type\",  IntegerType, true),\n                      StructField(\"identity_value\", StringType,  true)\n                    )\n                  )\n                ),\n                true\n              ),\n              StructField(\"postal_code_ext_id\",        IntegerType, true),\n              StructField(\"hashed_ip\",                 StringType,  true),\n              StructField(\"external_deal_code\",        StringType,  true),\n              StructField(\"creative_duration\",         IntegerType, true),\n              StructField(\"openrtb_req_subdomain\",     StringType,  true),\n              StructField(\"creative_media_subtype_id\", IntegerType, true),\n              StructField(\"is_private_auction\",        BooleanType, true),\n              StructField(\"private_auction_eligible\",  BooleanType, true),\n              StructField(\"client_request_id\",         StringType,  true),\n              StructField(\"chrome_traffic_label\",      IntegerType, true)\n            )\n          ),\n          true\n        ),\n        StructField(\"log_impbus_preempt_count\", IntegerType, true),\n        StructField(\n          \"log_impbus_preempt\",\n          StructType(\n            List(\n              StructField(\"date_time\",              LongType,    true),\n              StructField(\"auction_id_64\",          LongType,    true),\n              StructField(\"imp_transacted\",         IntegerType, true),\n              StructField(\"buyer_spend\",            DoubleType,  true),\n              StructField(\"seller_revenue\",         DoubleType,  true),\n              StructField(\"bidder_fees\",            DoubleType,  true),\n              StructField(\"instance_id\",            IntegerType, true),\n              StructField(\"fold_position\",          IntegerType, true),\n              StructField(\"seller_deduction\",       DoubleType,  true),\n              StructField(\"buyer_member_id\",        IntegerType, true),\n              StructField(\"creative_id\",            IntegerType, true),\n              StructField(\"cleared_direct\",         IntegerType, true),\n              StructField(\"buyer_currency\",         StringType,  true),\n              StructField(\"buyer_exchange_rate\",    DoubleType,  true),\n              StructField(\"width\",                  IntegerType, true),\n              StructField(\"height\",                 IntegerType, true),\n              StructField(\"brand_id\",               IntegerType, true),\n              StructField(\"creative_audit_status\",  IntegerType, true),\n              StructField(\"is_creative_hosted\",     IntegerType, true),\n              StructField(\"vp_expose_domains\",      IntegerType, true),\n              StructField(\"vp_expose_categories\",   IntegerType, true),\n              StructField(\"vp_expose_pubs\",         IntegerType, true),\n              StructField(\"vp_expose_tag\",          IntegerType, true),\n              StructField(\"bidder_id\",              IntegerType, true),\n              StructField(\"deal_id\",                IntegerType, true),\n              StructField(\"imp_type\",               IntegerType, true),\n              StructField(\"is_dw\",                  IntegerType, true),\n              StructField(\"vp_bitmap\",              LongType,    true),\n              StructField(\"ttl\",                    IntegerType, true),\n              StructField(\"view_detection_enabled\", IntegerType, true),\n              StructField(\"media_type\",             IntegerType, true),\n              StructField(\"auction_timestamp\",      LongType,    true),\n              StructField(\"spend_protection\",       IntegerType, true),\n              StructField(\"viewdef_definition_id_buyer_member\",\n                          IntegerType,\n                          true\n              ),\n              StructField(\"deal_type\",                 IntegerType, true),\n              StructField(\"ym_floor_id\",               IntegerType, true),\n              StructField(\"ym_bias_id\",                IntegerType, true),\n              StructField(\"bid_price_type\",            IntegerType, true),\n              StructField(\"spend_protection_pixel_id\", IntegerType, true),\n              StructField(\"ip_address\",                StringType,  true),\n              StructField(\n                \"buyer_transaction_def\",\n                StructType(\n                  List(\n                    StructField(\"transaction_event\",         IntegerType, true),\n                    StructField(\"transaction_event_type_id\", IntegerType, true)\n                  )\n                ),\n                true\n              ),\n              StructField(\n                \"seller_transaction_def\",\n                StructType(\n                  List(\n                    StructField(\"transaction_event\",         IntegerType, true),\n                    StructField(\"transaction_event_type_id\", IntegerType, true)\n                  )\n                ),\n                true\n              ),\n              StructField(\"buyer_bid\",            DoubleType,  true),\n              StructField(\"expected_events\",      IntegerType, true),\n              StructField(\"accept_timestamp\",     LongType,    true),\n              StructField(\"external_creative_id\", StringType,  true),\n              StructField(\"seat_id\",              IntegerType, true),\n              StructField(\"is_prebid_server\",     BooleanType, true),\n              StructField(\"curated_deal_id\",      IntegerType, true),\n              StructField(\"external_campaign_id\", StringType,  true),\n              StructField(\"trust_id\",             StringType,  true),\n              StructField(\n                \"log_product_ads\",\n                StructType(\n                  List(\n                    StructField(\"product_feed_id\", IntegerType, true),\n                    StructField(\"item_selection_strategy_id\",\n                                IntegerType,\n                                true\n                    ),\n                    StructField(\"product_uuid\", StringType, true)\n                  )\n                ),\n                true\n              ),\n              StructField(\"external_bidrequest_id\",     LongType,    true),\n              StructField(\"external_bidrequest_imp_id\", LongType,    true),\n              StructField(\"creative_media_subtype_id\",  IntegerType, true)\n            )\n          ),\n          true\n        ),\n        StructField(\n          \"log_impbus_preempt_dup\",\n          StructType(\n            List(\n              StructField(\"date_time\",              LongType,    true),\n              StructField(\"auction_id_64\",          LongType,    true),\n              StructField(\"imp_transacted\",         IntegerType, true),\n              StructField(\"buyer_spend\",            DoubleType,  true),\n              StructField(\"seller_revenue\",         DoubleType,  true),\n              StructField(\"bidder_fees\",            DoubleType,  true),\n              StructField(\"instance_id\",            IntegerType, true),\n              StructField(\"fold_position\",          IntegerType, true),\n              StructField(\"seller_deduction\",       DoubleType,  true),\n              StructField(\"buyer_member_id\",        IntegerType, true),\n              StructField(\"creative_id\",            IntegerType, true),\n              StructField(\"cleared_direct\",         IntegerType, true),\n              StructField(\"buyer_currency\",         StringType,  true),\n              StructField(\"buyer_exchange_rate\",    DoubleType,  true),\n              StructField(\"width\",                  IntegerType, true),\n              StructField(\"height\",                 IntegerType, true),\n              StructField(\"brand_id\",               IntegerType, true),\n              StructField(\"creative_audit_status\",  IntegerType, true),\n              StructField(\"is_creative_hosted\",     IntegerType, true),\n              StructField(\"vp_expose_domains\",      IntegerType, true),\n              StructField(\"vp_expose_categories\",   IntegerType, true),\n              StructField(\"vp_expose_pubs\",         IntegerType, true),\n              StructField(\"vp_expose_tag\",          IntegerType, true),\n              StructField(\"bidder_id\",              IntegerType, true),\n              StructField(\"deal_id\",                IntegerType, true),\n              StructField(\"imp_type\",               IntegerType, true),\n              StructField(\"is_dw\",                  IntegerType, true),\n              StructField(\"vp_bitmap\",              LongType,    true),\n              StructField(\"ttl\",                    IntegerType, true),\n              StructField(\"view_detection_enabled\", IntegerType, true),\n              StructField(\"media_type\",             IntegerType, true),\n              StructField(\"auction_timestamp\",      LongType,    true),\n              StructField(\"spend_protection\",       IntegerType, true),\n              StructField(\"viewdef_definition_id_buyer_member\",\n                          IntegerType,\n                          true\n              ),\n              StructField(\"deal_type\",                 IntegerType, true),\n              StructField(\"ym_floor_id\",               IntegerType, true),\n              StructField(\"ym_bias_id\",                IntegerType, true),\n              StructField(\"bid_price_type\",            IntegerType, true),\n              StructField(\"spend_protection_pixel_id\", IntegerType, true),\n              StructField(\"ip_address\",                StringType,  true),\n              StructField(\n                \"buyer_transaction_def\",\n                StructType(\n                  List(\n                    StructField(\"transaction_event\",         IntegerType, true),\n                    StructField(\"transaction_event_type_id\", IntegerType, true)\n                  )\n                ),\n                true\n              ),\n              StructField(\n                \"seller_transaction_def\",\n                StructType(\n                  List(\n                    StructField(\"transaction_event\",         IntegerType, true),\n                    StructField(\"transaction_event_type_id\", IntegerType, true)\n                  )\n                ),\n                true\n              ),\n              StructField(\"buyer_bid\",            DoubleType,  true),\n              StructField(\"expected_events\",      IntegerType, true),\n              StructField(\"accept_timestamp\",     LongType,    true),\n              StructField(\"external_creative_id\", StringType,  true),\n              StructField(\"seat_id\",              IntegerType, true),\n              StructField(\"is_prebid_server\",     BooleanType, true),\n              StructField(\"curated_deal_id\",      IntegerType, true),\n              StructField(\"external_campaign_id\", StringType,  true),\n              StructField(\"trust_id\",             StringType,  true),\n              StructField(\n                \"log_product_ads\",\n                StructType(\n                  List(\n                    StructField(\"product_feed_id\", IntegerType, true),\n                    StructField(\"item_selection_strategy_id\",\n                                IntegerType,\n                                true\n                    ),\n                    StructField(\"product_uuid\", StringType, true)\n                  )\n                ),\n                true\n              ),\n              StructField(\"external_bidrequest_id\",     LongType,    true),\n              StructField(\"external_bidrequest_imp_id\", LongType,    true),\n              StructField(\"creative_media_subtype_id\",  IntegerType, true)\n            )\n          ),\n          true\n        ),\n        StructField(\"log_impbus_impressions_pricing_count\", IntegerType, true),\n        StructField(\n          \"log_impbus_impressions_pricing\",\n          StructType(\n            List(\n              StructField(\"date_time\",     LongType, true),\n              StructField(\"auction_id_64\", LongType, true),\n              StructField(\n                \"buyer_charges\",\n                StructType(\n                  List(\n                    StructField(\"rate_card_id\", IntegerType, true),\n                    StructField(\"member_id\",    IntegerType, true),\n                    StructField(\"is_dw\",        BooleanType, true),\n                    StructField(\n                      \"pricing_terms\",\n                      ArrayType(\n                        StructType(\n                          List(\n                            StructField(\"term_id\",      IntegerType, true),\n                            StructField(\"amount\",       DoubleType,  true),\n                            StructField(\"rate\",         DoubleType,  true),\n                            StructField(\"is_deduction\", BooleanType, true),\n                            StructField(\"is_media_cost_dependent\",\n                                        BooleanType,\n                                        true\n                            ),\n                            StructField(\"data_member_id\", IntegerType, true)\n                          )\n                        )\n                      ),\n                      true\n                    ),\n                    StructField(\"fx_margin_rate_id\",      IntegerType, true),\n                    StructField(\"marketplace_owner_id\",   IntegerType, true),\n                    StructField(\"virtual_marketplace_id\", IntegerType, true),\n                    StructField(\"amino_enabled\",          BooleanType, true)\n                  )\n                ),\n                true\n              ),\n              StructField(\n                \"seller_charges\",\n                StructType(\n                  List(\n                    StructField(\"rate_card_id\", IntegerType, true),\n                    StructField(\"member_id\",    IntegerType, true),\n                    StructField(\"is_dw\",        BooleanType, true),\n                    StructField(\n                      \"pricing_terms\",\n                      ArrayType(\n                        StructType(\n                          List(\n                            StructField(\"term_id\",      IntegerType, true),\n                            StructField(\"amount\",       DoubleType,  true),\n                            StructField(\"rate\",         DoubleType,  true),\n                            StructField(\"is_deduction\", BooleanType, true),\n                            StructField(\"is_media_cost_dependent\",\n                                        BooleanType,\n                                        true\n                            ),\n                            StructField(\"data_member_id\", IntegerType, true)\n                          )\n                        )\n                      ),\n                      true\n                    ),\n                    StructField(\"fx_margin_rate_id\",      IntegerType, true),\n                    StructField(\"marketplace_owner_id\",   IntegerType, true),\n                    StructField(\"virtual_marketplace_id\", IntegerType, true),\n                    StructField(\"amino_enabled\",          BooleanType, true)\n                  )\n                ),\n                true\n              ),\n              StructField(\"buyer_spend\",                 DoubleType,  true),\n              StructField(\"seller_revenue\",              DoubleType,  true),\n              StructField(\"rate_card_auction_type\",      IntegerType, true),\n              StructField(\"rate_card_media_type\",        IntegerType, true),\n              StructField(\"direct_clear\",                BooleanType, true),\n              StructField(\"auction_timestamp\",           LongType,    true),\n              StructField(\"instance_id\",                 IntegerType, true),\n              StructField(\"two_phase_reduction_applied\", BooleanType, true),\n              StructField(\"trade_agreement_id\",          IntegerType, true),\n              StructField(\"log_timestamp\",               LongType,    true),\n              StructField(\n                \"trade_agreement_info\",\n                StructType(\n                  List(\n                    StructField(\"applied_term_id\",   IntegerType, true),\n                    StructField(\"applied_term_type\", IntegerType, true),\n                    StructField(\"targeted_term_ids\",\n                                ArrayType(IntegerType),\n                                true\n                    )\n                  )\n                ),\n                true\n              ),\n              StructField(\"is_buy_it_now\",   BooleanType, true),\n              StructField(\"net_buyer_spend\", DoubleType,  true),\n              StructField(\n                \"impression_event_pricing\",\n                StructType(\n                  List(\n                    StructField(\"gross_payment_value_microcents\",\n                                LongType,\n                                true\n                    ),\n                    StructField(\"net_payment_value_microcents\",\n                                LongType,\n                                true\n                    ),\n                    StructField(\"seller_revenue_microcents\", LongType, true),\n                    StructField(\n                      \"buyer_charges\",\n                      StructType(\n                        List(\n                          StructField(\"rate_card_id\", IntegerType, true),\n                          StructField(\"member_id\",    IntegerType, true),\n                          StructField(\"is_dw\",        BooleanType, true),\n                          StructField(\n                            \"pricing_terms\",\n                            ArrayType(\n                              StructType(\n                                List(\n                                  StructField(\"term_id\", IntegerType, true),\n                                  StructField(\"amount\",  DoubleType,  true),\n                                  StructField(\"rate\",    DoubleType,  true),\n                                  StructField(\"is_deduction\",\n                                              BooleanType,\n                                              true\n                                  ),\n                                  StructField(\"is_media_cost_dependent\",\n                                              BooleanType,\n                                              true\n                                  ),\n                                  StructField(\"data_member_id\",\n                                              IntegerType,\n                                              true\n                                  )\n                                )\n                              )\n                            ),\n                            true\n                          ),\n                          StructField(\"fx_margin_rate_id\", IntegerType, true),\n                          StructField(\"marketplace_owner_id\",\n                                      IntegerType,\n                                      true\n                          ),\n                          StructField(\"virtual_marketplace_id\",\n                                      IntegerType,\n                                      true\n                          ),\n                          StructField(\"amino_enabled\", BooleanType, true)\n                        )\n                      ),\n                      true\n                    ),\n                    StructField(\n                      \"seller_charges\",\n                      StructType(\n                        List(\n                          StructField(\"rate_card_id\", IntegerType, true),\n                          StructField(\"member_id\",    IntegerType, true),\n                          StructField(\"is_dw\",        BooleanType, true),\n                          StructField(\n                            \"pricing_terms\",\n                            ArrayType(\n                              StructType(\n                                List(\n                                  StructField(\"term_id\", IntegerType, true),\n                                  StructField(\"amount\",  DoubleType,  true),\n                                  StructField(\"rate\",    DoubleType,  true),\n                                  StructField(\"is_deduction\",\n                                              BooleanType,\n                                              true\n                                  ),\n                                  StructField(\"is_media_cost_dependent\",\n                                              BooleanType,\n                                              true\n                                  ),\n                                  StructField(\"data_member_id\",\n                                              IntegerType,\n                                              true\n                                  )\n                                )\n                              )\n                            ),\n                            true\n                          ),\n                          StructField(\"fx_margin_rate_id\", IntegerType, true),\n                          StructField(\"marketplace_owner_id\",\n                                      IntegerType,\n                                      true\n                          ),\n                          StructField(\"virtual_marketplace_id\",\n                                      IntegerType,\n                                      true\n                          ),\n                          StructField(\"amino_enabled\", BooleanType, true)\n                        )\n                      ),\n                      true\n                    ),\n                    StructField(\"buyer_transacted\",  BooleanType, true),\n                    StructField(\"seller_transacted\", BooleanType, true)\n                  )\n                ),\n                true\n              ),\n              StructField(\"counterparty_ruleset_type\", IntegerType, true),\n              StructField(\"estimated_audience_imps\",   FloatType,   true),\n              StructField(\"audience_imps\",             FloatType,   true)\n            )\n          ),\n          true\n        ),\n        StructField(\n          \"log_impbus_impressions_pricing_dup\",\n          StructType(\n            List(\n              StructField(\"date_time\",     LongType, true),\n              StructField(\"auction_id_64\", LongType, true),\n              StructField(\n                \"buyer_charges\",\n                StructType(\n                  List(\n                    StructField(\"rate_card_id\", IntegerType, true),\n                    StructField(\"member_id\",    IntegerType, true),\n                    StructField(\"is_dw\",        BooleanType, true),\n                    StructField(\n                      \"pricing_terms\",\n                      ArrayType(\n                        StructType(\n                          List(\n                            StructField(\"term_id\",      IntegerType, true),\n                            StructField(\"amount\",       DoubleType,  true),\n                            StructField(\"rate\",         DoubleType,  true),\n                            StructField(\"is_deduction\", BooleanType, true),\n                            StructField(\"is_media_cost_dependent\",\n                                        BooleanType,\n                                        true\n                            ),\n                            StructField(\"data_member_id\", IntegerType, true)\n                          )\n                        )\n                      ),\n                      true\n                    ),\n                    StructField(\"fx_margin_rate_id\",      IntegerType, true),\n                    StructField(\"marketplace_owner_id\",   IntegerType, true),\n                    StructField(\"virtual_marketplace_id\", IntegerType, true),\n                    StructField(\"amino_enabled\",          BooleanType, true)\n                  )\n                ),\n                true\n              ),\n              StructField(\n                \"seller_charges\",\n                StructType(\n                  List(\n                    StructField(\"rate_card_id\", IntegerType, true),\n                    StructField(\"member_id\",    IntegerType, true),\n                    StructField(\"is_dw\",        BooleanType, true),\n                    StructField(\n                      \"pricing_terms\",\n                      ArrayType(\n                        StructType(\n                          List(\n                            StructField(\"term_id\",      IntegerType, true),\n                            StructField(\"amount\",       DoubleType,  true),\n                            StructField(\"rate\",         DoubleType,  true),\n                            StructField(\"is_deduction\", BooleanType, true),\n                            StructField(\"is_media_cost_dependent\",\n                                        BooleanType,\n                                        true\n                            ),\n                            StructField(\"data_member_id\", IntegerType, true)\n                          )\n                        )\n                      ),\n                      true\n                    ),\n                    StructField(\"fx_margin_rate_id\",      IntegerType, true),\n                    StructField(\"marketplace_owner_id\",   IntegerType, true),\n                    StructField(\"virtual_marketplace_id\", IntegerType, true),\n                    StructField(\"amino_enabled\",          BooleanType, true)\n                  )\n                ),\n                true\n              ),\n              StructField(\"buyer_spend\",                 DoubleType,  true),\n              StructField(\"seller_revenue\",              DoubleType,  true),\n              StructField(\"rate_card_auction_type\",      IntegerType, true),\n              StructField(\"rate_card_media_type\",        IntegerType, true),\n              StructField(\"direct_clear\",                BooleanType, true),\n              StructField(\"auction_timestamp\",           LongType,    true),\n              StructField(\"instance_id\",                 IntegerType, true),\n              StructField(\"two_phase_reduction_applied\", BooleanType, true),\n              StructField(\"trade_agreement_id\",          IntegerType, true),\n              StructField(\"log_timestamp\",               LongType,    true),\n              StructField(\n                \"trade_agreement_info\",\n                StructType(\n                  List(\n                    StructField(\"applied_term_id\",   IntegerType, true),\n                    StructField(\"applied_term_type\", IntegerType, true),\n                    StructField(\"targeted_term_ids\",\n                                ArrayType(IntegerType),\n                                true\n                    )\n                  )\n                ),\n                true\n              ),\n              StructField(\"is_buy_it_now\",   BooleanType, true),\n              StructField(\"net_buyer_spend\", DoubleType,  true),\n              StructField(\n                \"impression_event_pricing\",\n                StructType(\n                  List(\n                    StructField(\"gross_payment_value_microcents\",\n                                LongType,\n                                true\n                    ),\n                    StructField(\"net_payment_value_microcents\",\n                                LongType,\n                                true\n                    ),\n                    StructField(\"seller_revenue_microcents\", LongType, true),\n                    StructField(\n                      \"buyer_charges\",\n                      StructType(\n                        List(\n                          StructField(\"rate_card_id\", IntegerType, true),\n                          StructField(\"member_id\",    IntegerType, true),\n                          StructField(\"is_dw\",        BooleanType, true),\n                          StructField(\n                            \"pricing_terms\",\n                            ArrayType(\n                              StructType(\n                                List(\n                                  StructField(\"term_id\", IntegerType, true),\n                                  StructField(\"amount\",  DoubleType,  true),\n                                  StructField(\"rate\",    DoubleType,  true),\n                                  StructField(\"is_deduction\",\n                                              BooleanType,\n                                              true\n                                  ),\n                                  StructField(\"is_media_cost_dependent\",\n                                              BooleanType,\n                                              true\n                                  ),\n                                  StructField(\"data_member_id\",\n                                              IntegerType,\n                                              true\n                                  )\n                                )\n                              )\n                            ),\n                            true\n                          ),\n                          StructField(\"fx_margin_rate_id\", IntegerType, true),\n                          StructField(\"marketplace_owner_id\",\n                                      IntegerType,\n                                      true\n                          ),\n                          StructField(\"virtual_marketplace_id\",\n                                      IntegerType,\n                                      true\n                          ),\n                          StructField(\"amino_enabled\", BooleanType, true)\n                        )\n                      ),\n                      true\n                    ),\n                    StructField(\n                      \"seller_charges\",\n                      StructType(\n                        List(\n                          StructField(\"rate_card_id\", IntegerType, true),\n                          StructField(\"member_id\",    IntegerType, true),\n                          StructField(\"is_dw\",        BooleanType, true),\n                          StructField(\n                            \"pricing_terms\",\n                            ArrayType(\n                              StructType(\n                                List(\n                                  StructField(\"term_id\", IntegerType, true),\n                                  StructField(\"amount\",  DoubleType,  true),\n                                  StructField(\"rate\",    DoubleType,  true),\n                                  StructField(\"is_deduction\",\n                                              BooleanType,\n                                              true\n                                  ),\n                                  StructField(\"is_media_cost_dependent\",\n                                              BooleanType,\n                                              true\n                                  ),\n                                  StructField(\"data_member_id\",\n                                              IntegerType,\n                                              true\n                                  )\n                                )\n                              )\n                            ),\n                            true\n                          ),\n                          StructField(\"fx_margin_rate_id\", IntegerType, true),\n                          StructField(\"marketplace_owner_id\",\n                                      IntegerType,\n                                      true\n                          ),\n                          StructField(\"virtual_marketplace_id\",\n                                      IntegerType,\n                                      true\n                          ),\n                          StructField(\"amino_enabled\", BooleanType, true)\n                        )\n                      ),\n                      true\n                    ),\n                    StructField(\"buyer_transacted\",  BooleanType, true),\n                    StructField(\"seller_transacted\", BooleanType, true)\n                  )\n                ),\n                true\n              ),\n              StructField(\"counterparty_ruleset_type\", IntegerType, true),\n              StructField(\"estimated_audience_imps\",   FloatType,   true),\n              StructField(\"audience_imps\",             FloatType,   true)\n            )\n          ),\n          true\n        )\n      )\n    )\n  )"}