{"initCode":"","code":"udf((_bumper_count: Integer, _index: Integer, _i: Integer, _placements: Seq[Row]) => {\n  var placements = (_placements).toArray\nvar is_ad_pod = 0\nvar i = _i \nvar bumper_count = _bumper_count\nvar index = _index\n\nwhile(compareTo(i, placements(convertToInt(index)).getAs[Seq[Row]](\"ad_slots\").toArray[Row].length) < 0) {\nif(!_isnull((placements(convertToInt(index)).getAs[Seq[Row]](\"ad_slots\").toArray[Row]).array(convertToInt(i)).getAs[Integer](\"slot_type\"))){\nif((placements(convertToInt(index)).getAs[Seq[Row]](\"ad_slots\").toArray[Row]).array(convertToInt(i)).getAs[Integer](\"slot_type\") != 0){\nbumper_count = bumper_count + convertToInt(1)\nis_ad_pod = 1\n}\n}\nif(!_isnull((placements(convertToInt(index)).getAs[Seq[Row]](\"ad_slots\").toArray[Row]).array(convertToInt(i)).getAs[Integer](\"ad_slot_position\"))){\nif(compareTo((placements(convertToInt(index)).getAs[Seq[Row]](\"ad_slots\").toArray[Row]).array(convertToInt(i)).getAs[Integer](\"ad_slot_position\"), 0) > 0){\nis_ad_pod = 1\n}\n}\ni = i + convertToInt(1)\n}\n\nRow(convertToInt(is_ad_pod), convertToInt(i), convertToInt(bumper_count))\n},  StructType(\n      List(\n      StructField(\"is_ad_pod\", IntegerType, false),StructField(\"i\", IntegerType, false),StructField(\"bumper_count\", IntegerType, false)\n      )\n    ))"}