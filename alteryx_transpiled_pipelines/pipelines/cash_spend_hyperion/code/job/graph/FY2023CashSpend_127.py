from pyspark.sql import *
from pyspark.sql.functions import *
from pyspark.sql.types import *
from prophecy.utils import *
from prophecy.libs import typed_lit
from job.config.ConfigStore import *
from job.udfs.UDFs import *

def FY2023CashSpend_127(spark: SparkSession) -> DataFrame:
    return spark.read\
        .schema(
          StructType([
            StructField("Country Short", StringType(), True), StructField("fit supplier diversity flag", StringType(), True), StructField("po line number", StringType(), True), StructField("source_procurement channel code - procurement channel code", StringType(), True), StructField("company code number", StringType(), True), StructField("source_cost center", StringType(), True), StructField("_version", StringType(), True), StructField("hyperion sub mc3", StringType(), True), StructField("hyperion cc_function_descr", StringType(), True), StructField("hyperion function description", StringType(), True), StructField("source_accounting date - quarter", StringType(), True), StructField("_planning sku", StringType(), True), StructField("source_amgen region/country - world sub-region_temp", StringType(), True), StructField("source_mg code description", StringType(), True), StructField("ParentVendor_match_flag", StringType(), True), StructField("source_wbs - accounting treatment", StringType(), True), StructField("source_amgen region/country - world sub-region", StringType(), True), StructField("Country", StringType(), True), StructField("Country_match_flag", StringType(), True), StructField("Country Old", StringType(), True), StructField("source_sap_vendor description", StringType(), True), StructField("Category Old", StringType(), True), StructField("_Sum_LCL", StringType(), True), StructField("tableau display material group", StringType(), True), StructField("_Sum_USDAFX", StringType(), True), StructField("Sub_group_flag", StringType(), True), StructField("SUB GROUP", StringType(), True), StructField("po id", StringType(), True), StructField("_scenario type", StringType(), True), StructField("source_vendor - vendor global ultimate parent (enriched)", StringType(), True), StructField("source_vendor - cc3 - veteran owned small bus", StringType(), True), StructField("source_accounting date - month", StringType(), True), StructField("source_wbs - description", StringType(), True), StructField("source_vendor - cc1 - type", StringType(), True), StructField("source_invoice spend (actual fx rate)", StringType(), True), StructField("hyperion function level 4", StringType(), True), StructField("_Gl Account", StringType(), True), StructField("vendor country", StringType(), True), StructField("source_vendor_number", StringType(), True), StructField("source_invoice number", StringType(), True), StructField("GL Account Description Updated", StringType(), True), StructField("source_vendor - cc3 - svc disabled vet owned sb", StringType(), True), StructField("tableau display category", StringType(), True), StructField("source_vendor - cc4 - obs-foreign supplier", StringType(), True), StructField("source_vendor - vendor global ultimate parent (enriched) temp1", StringType(), True), StructField("hyperion sub mc2", StringType(), True), StructField("hyperion sub mc", StringType(), True), StructField("source_vendor - cc2 - women owned small bus", StringType(), True), StructField("tableau display mega category", StringType(), True), StructField("source_vendor - vendor global ultimate parent (enriched) old", StringType(), True), StructField("source_vendor - cc5 - small business", StringType(), True), StructField("source_amgen region/country - world sub-region Old", StringType(), True), StructField("vendor country code", StringType(), True), StructField("_Gl Account (# only)", StringType(), True), StructField("source_vendor - vendor (enriched)", StringType(), True), StructField("_Category", StringType(), True), StructField("Sum of Commitment Amount", StringType(), True), StructField("hyperion function level 3", StringType(), True), StructField("hyperion evp", StringType(), True), StructField("_Planning Account", StringType(), True), StructField("_GL", StringType(), True), StructField("source_invoice spend (budget fx rate)", StringType(), True), StructField("source_requester - user/buyer name responsible for spend", StringType(), True), StructField("source_vendor - cc4 - hubzone small business", StringType(), True), StructField("sap/concur source", StringType(), True), StructField("source_amgen region/country - world region", StringType(), True), StructField("_category code", StringType(), True), StructField("source_invoice spend (original currency)", StringType(), True), StructField("_product description", StringType(), True), StructField("source_cost center number", StringType(), True), StructField("source_vendor - cc1 - indicator", StringType(), True), StructField("hyperion cc description", StringType(), True), StructField("invoice linenumber", StringType(), True), StructField("source_amgen region/country - sap company code", StringType(), True), StructField("hyperion function level 2", StringType(), True), StructField("_Regrouped Level 4", StringType(), True), StructField("hyperion cc_function_mapping", StringType(), True), StructField("source_vendor - vendor global ultimate parent (enriched) temp", StringType(), True), StructField("SUB-GROUP_Temp", StringType(), True), StructField("source_gl number", StringType(), True), StructField("source_wbs - product name", StringType(), True), StructField("Site", StringType(), True), StructField("po description", StringType(), True), StructField("source_mg code", StringType(), True), StructField("tableau display meta category", StringType(), True), StructField("source_accounting date - year", StringType(), True), StructField("source_amgen region/country - country", StringType(), True), StructField("Mega Category Old", StringType(), True), StructField("hyperion hlmc", StringType(), True), StructField("company code name", StringType(), True), StructField("source_invoice quantity", StringType(), True), StructField("hyperion mc", StringType(), True), StructField("source_vendor - cc5 - obs-large business", StringType(), True), StructField("source_accounting date", StringType(), True), StructField("Company Description", StringType(), True)
        ])
        )\
        .option("header", True)\
        .option("quote", "\"")\
        .option("sep", ",")\
        .csv("C:\\Users\\nikhil.f.bansal\\Amgen\\Amgen India - 08.15 Baseline Analytics Engine and Dashboards\\Data Shared by ACN\\Cash Spend - Hyperion Mapping\\02. Source Data for the Model\\FY 2023 Cash Spend Data.csv")
