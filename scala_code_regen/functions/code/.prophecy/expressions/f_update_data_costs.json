{"parameters":[{"name":"data_costs","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"imp_type","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"agg_type","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"payment_type","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"media_cost_cpm","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"member_sales_tax_rate_pct","type":"column","metadata":{"description":"","tags":[],"mappings":[]}}],"output":{"type":"array","elementType":{"type":"struct","fields":[{"name":"data_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"cost","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"used_segments","type":{"type":"array","elementType":"integer","containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"cost_pct","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"isCustomSchemaEnabled":true,"code":"when(is_not_null(data_costs), when((coalesce(imp_type, lit(1)).cast(IntegerType) === lit(5)) or (coalesce(imp_type, lit(1)).cast(IntegerType) === lit(7)), array_union(data_costs, temp10430067_UDF(array(), coalesce(payment_type, lit(0)).cast(IntegerType), coalesce(member_sales_tax_rate_pct, lit(0)).cast(DoubleType), lit(0), coalesce(media_cost_cpm, lit(0)).cast(DoubleType), coalesce(agg_type, lit(0)).cast(IntegerType), lit(null).cast(StructType(List(StructField(\"data_member_id\", IntegerType, true), StructField(\"cost\", DoubleType, true), StructField(\"used_segments\", ArrayType(IntegerType, true), true), StructField(\"cost_pct\", DoubleType, true)))), data_costs).getField(\"l_data_costs\"))))","language":"scala","description":""}