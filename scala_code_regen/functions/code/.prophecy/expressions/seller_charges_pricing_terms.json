{"parameters":[],"isCustomSchemaEnabled":false,"code":"when(is_not_null(when(is_not_null(f_get_transaction_event_pricing(col(\"log_impbus_impressions_pricing.impression_event_pricing\"), col(\"log_impbus_auction_event.auction_event_pricing\"), col(\"log_impbus_impressions_pricing.buyer_charges\"), col(\"log_impbus_impressions_pricing.seller_charges\"), f_should_process_views(col(\"log_dw_view\"), f_transaction_event(col(\"log_impbus_impressions.seller_transaction_def\"), col(\"log_impbus_preempt.seller_transaction_def\")), f_transaction_event(col(\"log_impbus_impressions.buyer_transaction_def\"), col(\"log_impbus_preempt.buyer_transaction_def\")))).getField(\"seller_charges\").getField(\"pricing_terms\")), f_get_transaction_event_pricing(col(\"log_impbus_impressions_pricing.impression_event_pricing\"), col(\"log_impbus_auction_event.auction_event_pricing\"), col(\"log_impbus_impressions_pricing.buyer_charges\"), col(\"log_impbus_impressions_pricing.seller_charges\"), f_should_process_views(col(\"log_dw_view\"), f_transaction_event(col(\"log_impbus_impressions.seller_transaction_def\"), col(\"log_impbus_preempt.seller_transaction_def\")).cast(IntegerType), f_transaction_event(col(\"log_impbus_impressions.buyer_transaction_def\"), col(\"log_impbus_preempt.buyer_transaction_def\")).cast(IntegerType)).cast(IntegerType)).getField(\"seller_charges\").getField(\"pricing_terms\")).otherwise(lit(null).cast(ArrayType(StructType(List(StructField(\"term_id\", IntegerType, true), StructField(\"amount\", DoubleType, true), StructField(\"rate\", DoubleType, true), StructField(\"is_deduction\", BooleanType, true), StructField(\"is_media_cost_dependent\", BooleanType, true), StructField(\"data_member_id\", IntegerType, true))), true)))), f_convert_pricing_term_amount(when(is_not_null(f_get_transaction_event_pricing(col(\"log_impbus_impressions_pricing.impression_event_pricing\"), col(\"log_impbus_auction_event.auction_event_pricing\"), col(\"log_impbus_impressions_pricing.buyer_charges\"), col(\"log_impbus_impressions_pricing.seller_charges\"), f_should_process_views(col(\"log_dw_view\"), f_transaction_event(col(\"log_impbus_impressions.seller_transaction_def\"), col(\"log_impbus_preempt.seller_transaction_def\")), f_transaction_event(col(\"log_impbus_impressions.buyer_transaction_def\"), col(\"log_impbus_preempt.buyer_transaction_def\")))).getField(\"seller_charges\").getField(\"pricing_terms\")), f_get_transaction_event_pricing(col(\"log_impbus_impressions_pricing.impression_event_pricing\"), col(\"log_impbus_auction_event.auction_event_pricing\"), col(\"log_impbus_impressions_pricing.buyer_charges\"), col(\"log_impbus_impressions_pricing.seller_charges\"), f_should_process_views(col(\"log_dw_view\"), f_transaction_event(col(\"log_impbus_impressions.seller_transaction_def\"), col(\"log_impbus_preempt.seller_transaction_def\")).cast(IntegerType), f_transaction_event(col(\"log_impbus_impressions.buyer_transaction_def\"), col(\"log_impbus_preempt.buyer_transaction_def\")).cast(IntegerType)).cast(IntegerType)).getField(\"seller_charges\").getField(\"pricing_terms\")).otherwise(lit(null).cast(ArrayType(StructType(List(StructField(\"term_id\", IntegerType, true), StructField(\"amount\", DoubleType, true), StructField(\"rate\", DoubleType, true), StructField(\"is_deduction\", BooleanType, true), StructField(\"is_media_cost_dependent\", BooleanType, true), StructField(\"data_member_id\", IntegerType, true))), true))), lit(1000.0))).otherwise(when(is_not_null(f_get_transaction_event_pricing(col(\"log_impbus_impressions_pricing.impression_event_pricing\"), col(\"log_impbus_auction_event.auction_event_pricing\"), col(\"log_impbus_impressions_pricing.buyer_charges\"), col(\"log_impbus_impressions_pricing.seller_charges\"), f_should_process_views(col(\"log_dw_view\"), f_transaction_event(col(\"log_impbus_impressions.seller_transaction_def\"), col(\"log_impbus_preempt.seller_transaction_def\")), f_transaction_event(col(\"log_impbus_impressions.buyer_transaction_def\"), col(\"log_impbus_preempt.buyer_transaction_def\")))).getField(\"seller_charges\").getField(\"pricing_terms\")), f_get_transaction_event_pricing(col(\"log_impbus_impressions_pricing.impression_event_pricing\"), col(\"log_impbus_auction_event.auction_event_pricing\"), col(\"log_impbus_impressions_pricing.buyer_charges\"), col(\"log_impbus_impressions_pricing.seller_charges\"), f_should_process_views(col(\"log_dw_view\"), f_transaction_event(col(\"log_impbus_impressions.seller_transaction_def\"), col(\"log_impbus_preempt.seller_transaction_def\")).cast(IntegerType), f_transaction_event(col(\"log_impbus_impressions.buyer_transaction_def\"), col(\"log_impbus_preempt.buyer_transaction_def\")).cast(IntegerType)).cast(IntegerType)).getField(\"seller_charges\").getField(\"pricing_terms\")).otherwise(lit(null).cast(ArrayType(StructType(List(StructField(\"term_id\", IntegerType, true), StructField(\"amount\", DoubleType, true), StructField(\"rate\", DoubleType, true), StructField(\"is_deduction\", BooleanType, true), StructField(\"is_media_cost_dependent\", BooleanType, true), StructField(\"data_member_id\", IntegerType, true))), true))))","language":"scala","description":""}