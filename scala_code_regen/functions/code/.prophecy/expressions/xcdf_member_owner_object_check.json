{"parameters":[{"name":"imp_type","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"buyer_member_id","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"seller_member_id","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"advertiser_id","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"campaign_group_id","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"publisher_id","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"advertiser_buyer_member_id","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"campaign_group_advertiser_id","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"publisher_seller_member_id","type":"column","metadata":{"description":"","tags":[],"mappings":[]}}],"isCustomSchemaEnabled":false,"code":"var good_data: org.apache.spark.sql.Column = lit(1)\nvar owner_member_id: org.apache.spark.sql.Column = lit(null).cast(IntegerType)\nowner_member_id = when(is_not_null(imp_type), when(imp_type.isin(lit(11), lit(10), lit(9), lit(5), lit(7)), buyer_member_id).otherwise(seller_member_id)).otherwise(owner_member_id)\ngood_data = when(isnull(publisher_seller_member_id) and (is_not_null(publisher_id) and (publisher_id =!= lit(0))), lit(0)).when((((is_not_null(campaign_group_id) and (campaign_group_id =!= lit(0))) and is_not_null(advertiser_id)) and (advertiser_id =!= lit(0))) and (((((((is_not_null(imp_type) and imp_type.isin(lit(6), lit(2))) and is_not_null(seller_member_id)) and is_not_null(publisher_seller_member_id)) and (seller_member_id =!= publisher_seller_member_id)) or (((((is_not_null(imp_type) and (imp_type =!= lit(6))) and (imp_type =!= lit(2))) and is_not_null(buyer_member_id)) and is_not_null(advertiser_buyer_member_id)) and (buyer_member_id =!= advertiser_buyer_member_id))) or ((is_not_null(owner_member_id) and is_not_null(advertiser_buyer_member_id)) and (owner_member_id =!= advertiser_buyer_member_id))) or ((((is_not_null(owner_member_id) and is_not_null(advertiser_buyer_member_id)) and is_not_null(campaign_group_advertiser_id)) and (owner_member_id === advertiser_buyer_member_id)) and (advertiser_id =!= campaign_group_advertiser_id))), lit(0)).when((((is_not_null(imp_type) and imp_type.isin(lit(6), lit(2))) and is_not_null(seller_member_id)) and is_not_null(publisher_seller_member_id)) and (seller_member_id =!= publisher_seller_member_id), lit(0)).when((((is_not_null(publisher_id) and is_not_null(publisher_seller_member_id)) and is_not_null(seller_member_id)) and (publisher_id =!= lit(0))) and (publisher_seller_member_id =!= seller_member_id), lit(0)).when(((((is_not_null(imp_type) and (imp_type === lit(5))) and is_not_null(seller_member_id)) and is_not_null(buyer_member_id)) and (buyer_member_id =!= lit(0))) and (seller_member_id =!= buyer_member_id), lit(0)).otherwise(good_data)\ngood_data === lit(1)","language":"scala","description":""}