{"parameters":[{"name":"term_id","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"pricing_terms","type":"column","metadata":{"description":"","tags":[],"mappings":[]}}],"output":{"type":"struct","fields":[{"name":"term_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amount","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_deduction","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_media_cost_dependent","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"data_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"isCustomSchemaEnabled":true,"code":"when(is_not_null(when(is_not_null(pricing_terms), pricing_terms).otherwise(lit(null).cast(ArrayType(StructType(List(StructField(\"term_id\", IntegerType, true), StructField(\"amount\", DoubleType, true), StructField(\"rate\", DoubleType, true), StructField(\"is_deduction\", BooleanType, true), StructField(\"is_media_cost_dependent\", BooleanType, true), StructField(\"data_member_id\", IntegerType, true))), true)))), temp1151664_UDF(lit(0), term_id, when(is_not_null(pricing_terms), pricing_terms).otherwise(lit(null).cast(ArrayType(StructType(List(StructField(\"term_id\", IntegerType, true), StructField(\"amount\", DoubleType, true), StructField(\"rate\", DoubleType, true), StructField(\"is_deduction\", BooleanType, true), StructField(\"is_media_cost_dependent\", BooleanType, true), StructField(\"data_member_id\", IntegerType, true))), true))), lit(0)).getField(\"l_pricing_term\")).otherwise(lit(null).cast(StructType(List(StructField(\"term_id\", IntegerType, true), StructField(\"amount\", DoubleType, true), StructField(\"rate\", DoubleType, true), StructField(\"is_deduction\", BooleanType, true), StructField(\"is_media_cost_dependent\", BooleanType, true), StructField(\"data_member_id\", IntegerType, true)))))","language":"scala","description":""}