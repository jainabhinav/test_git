{"parameters":[{"name":"in1","type":"column","metadata":{"description":"","tags":[],"mappings":[]}}],"isCustomSchemaEnabled":true,"code":"var has_imp: org.apache.spark.sql.Column = lit(0)\nvar is_delivered: org.apache.spark.sql.Column = lit(0)\nvar has_preempt: org.apache.spark.sql.Column = lit(0)\nhas_imp = when(is_not_null(col(\"log_impbus_impressions\")), lit(1)).otherwise(has_imp).cast(IntegerType)\nis_delivered = when(is_not_null(col(\"log_impbus_impressions.is_delivered\").cast(IntegerType)) and (col(\"log_impbus_impressions.is_delivered\").cast(IntegerType) === lit(1)), lit(1)).otherwise(is_delivered).cast(IntegerType)\nhas_preempt = when(is_not_null(col(\"log_impbus_preempt\")), lit(1)).otherwise(has_preempt).cast(IntegerType)\n(has_imp === lit(1)) and ((has_preempt === lit(1)) or (is_delivered === lit(1)))","language":"scala","description":""}