{"parameters":[{"name":"imp_type","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"payment_type","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"revenue_type","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"in_pricing_terms","type":"column","metadata":{"description":"","tags":[],"mappings":[]}}],"output":{"type":"array","elementType":{"type":"struct","fields":[{"name":"term_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amount","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_deduction","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_media_cost_dependent","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"data_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"isCustomSchemaEnabled":true,"code":"when(is_not_null(in_pricing_terms), when(((is_not_null(imp_type) and is_not_null(payment_type)) and is_not_null(revenue_type)) and (((imp_type === lit(6)) and revenue_type.isin(lit(3), lit(4))) or ((imp_type === lit(7)) and payment_type.isin(lit(1), lit(2)))), temp6282792_UDF(in_pricing_terms, in_pricing_terms, lit(0)).getField(\"l_pricing_terms\")).otherwise(in_pricing_terms)).otherwise(lit(null).cast(ArrayType(StructType(List(StructField(\"term_id\", IntegerType, true), StructField(\"amount\", DoubleType, true), StructField(\"rate\", DoubleType, true), StructField(\"is_deduction\", BooleanType, true), StructField(\"is_media_cost_dependent\", BooleanType, true), StructField(\"data_member_id\", IntegerType, true))), true)))","language":"scala","description":""}