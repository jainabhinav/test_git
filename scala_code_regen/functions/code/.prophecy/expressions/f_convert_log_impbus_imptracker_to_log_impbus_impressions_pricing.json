{"parameters":[],"output":{"type":"struct","fields":[{"name":"date_time","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"auction_id_64","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_charges","type":{"type":"struct","fields":[{"name":"rate_card_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_dw","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"pricing_terms","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"term_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amount","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_deduction","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_media_cost_dependent","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"data_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"fx_margin_rate_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"marketplace_owner_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"virtual_marketplace_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amino_enabled","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_charges","type":{"type":"struct","fields":[{"name":"rate_card_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_dw","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"pricing_terms","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"term_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amount","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_deduction","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_media_cost_dependent","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"data_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"fx_margin_rate_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"marketplace_owner_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"virtual_marketplace_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amino_enabled","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_spend","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_revenue","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"rate_card_auction_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"rate_card_media_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"direct_clear","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"auction_timestamp","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"instance_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"two_phase_reduction_applied","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"trade_agreement_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"log_timestamp","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"trade_agreement_info","type":{"type":"struct","fields":[{"name":"applied_term_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"applied_term_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"targeted_term_ids","type":{"type":"array","elementType":"integer","containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_buy_it_now","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"net_buyer_spend","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"impression_event_pricing","type":{"type":"struct","fields":[{"name":"gross_payment_value_microcents","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"net_payment_value_microcents","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_revenue_microcents","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_charges","type":{"type":"struct","fields":[{"name":"rate_card_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_dw","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"pricing_terms","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"term_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amount","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_deduction","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_media_cost_dependent","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"data_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"fx_margin_rate_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"marketplace_owner_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"virtual_marketplace_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amino_enabled","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_charges","type":{"type":"struct","fields":[{"name":"rate_card_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_dw","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"pricing_terms","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"term_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amount","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_deduction","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_media_cost_dependent","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"data_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"fx_margin_rate_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"marketplace_owner_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"virtual_marketplace_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amino_enabled","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_transacted","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_transacted","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"counterparty_ruleset_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"estimated_audience_imps","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"audience_imps","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"isCustomSchemaEnabled":true,"code":"struct(struct(col(\"*\")).getField(\"date_time\").cast(LongType).as(\"date_time\"),struct(col(\"*\")).getField(\"auction_id_64\").cast(LongType).as(\"auction_id_64\"),struct(lit(null).cast(IntegerType).as(\"rate_card_id\"),lit(null).cast(IntegerType).as(\"member_id\"),lit(null).cast(BooleanType).as(\"is_dw\"),lit(null).cast(ArrayType(StructType(List(StructField(\"term_id\", IntegerType, true), StructField(\"amount\", DoubleType, true), StructField(\"rate\", DoubleType, true), StructField(\"is_deduction\", BooleanType, true), StructField(\"is_media_cost_dependent\", BooleanType, true), StructField(\"data_member_id\", IntegerType, true))), true)).as(\"pricing_terms\"),lit(null).cast(IntegerType).as(\"fx_margin_rate_id\"),lit(null).cast(IntegerType).as(\"marketplace_owner_id\"),lit(null).cast(IntegerType).as(\"virtual_marketplace_id\"),lit(null).cast(BooleanType).as(\"amino_enabled\")).as(\"buyer_charges\"),struct(lit(null).cast(IntegerType).as(\"rate_card_id\"),lit(null).cast(IntegerType).as(\"member_id\"),lit(null).cast(BooleanType).as(\"is_dw\"),lit(null).cast(ArrayType(StructType(List(StructField(\"term_id\", IntegerType, true), StructField(\"amount\", DoubleType, true), StructField(\"rate\", DoubleType, true), StructField(\"is_deduction\", BooleanType, true), StructField(\"is_media_cost_dependent\", BooleanType, true), StructField(\"data_member_id\", IntegerType, true))), true)).as(\"pricing_terms\"),lit(null).cast(IntegerType).as(\"fx_margin_rate_id\"),lit(null).cast(IntegerType).as(\"marketplace_owner_id\"),lit(null).cast(IntegerType).as(\"virtual_marketplace_id\"),lit(null).cast(BooleanType).as(\"amino_enabled\")).as(\"seller_charges\"),lit(0.0).as(\"buyer_spend\"),lit(0.0).as(\"seller_revenue\"),lit(null).cast(IntegerType).as(\"rate_card_auction_type\"),lit(null).cast(IntegerType).as(\"rate_card_media_type\"),lit(0).cast(BooleanType).as(\"direct_clear\"),col(\"date_time\").cast(LongType).as(\"auction_timestamp\"),lit(null).cast(IntegerType).as(\"instance_id\"),lit(0).cast(BooleanType).as(\"two_phase_reduction_applied\"),lit(0).as(\"trade_agreement_id\"),lit(null).cast(LongType).as(\"log_timestamp\"),struct(lit(null).cast(IntegerType).as(\"applied_term_id\"),lit(null).cast(IntegerType).as(\"applied_term_type\"),lit(null).cast(ArrayType(IntegerType, true)).as(\"targeted_term_ids\")).as(\"trade_agreement_info\"),lit(null).cast(BooleanType).as(\"is_buy_it_now\"),lit(null).cast(DoubleType).as(\"net_buyer_spend\"),struct(lit(null).cast(LongType).as(\"gross_payment_value_microcents\"),lit(null).cast(LongType).as(\"net_payment_value_microcents\"),lit(null).cast(LongType).as(\"seller_revenue_microcents\"),struct(lit(null).cast(IntegerType).as(\"rate_card_id\"),lit(null).cast(IntegerType).as(\"member_id\"),lit(null).cast(BooleanType).as(\"is_dw\"),lit(null).cast(ArrayType(StructType(List(StructField(\"term_id\", IntegerType, true), StructField(\"amount\", DoubleType, true), StructField(\"rate\", DoubleType, true), StructField(\"is_deduction\", BooleanType, true), StructField(\"is_media_cost_dependent\", BooleanType, true), StructField(\"data_member_id\", IntegerType, true))), true)).as(\"pricing_terms\"),lit(null).cast(IntegerType).as(\"fx_margin_rate_id\"),lit(null).cast(IntegerType).as(\"marketplace_owner_id\"),lit(null).cast(IntegerType).as(\"virtual_marketplace_id\"),lit(null).cast(BooleanType).as(\"amino_enabled\")).as(\"buyer_charges\"),struct(lit(null).cast(IntegerType).as(\"rate_card_id\"),lit(null).cast(IntegerType).as(\"member_id\"),lit(null).cast(BooleanType).as(\"is_dw\"),lit(null).cast(ArrayType(StructType(List(StructField(\"term_id\", IntegerType, true), StructField(\"amount\", DoubleType, true), StructField(\"rate\", DoubleType, true), StructField(\"is_deduction\", BooleanType, true), StructField(\"is_media_cost_dependent\", BooleanType, true), StructField(\"data_member_id\", IntegerType, true))), true)).as(\"pricing_terms\"),lit(null).cast(IntegerType).as(\"fx_margin_rate_id\"),lit(null).cast(IntegerType).as(\"marketplace_owner_id\"),lit(null).cast(IntegerType).as(\"virtual_marketplace_id\"),lit(null).cast(BooleanType).as(\"amino_enabled\")).as(\"seller_charges\"),lit(null).cast(BooleanType).as(\"buyer_transacted\"),lit(null).cast(BooleanType).as(\"seller_transacted\")).as(\"impression_event_pricing\"),lit(null).cast(IntegerType).as(\"counterparty_ruleset_type\"),lit(null).cast(DoubleType).as(\"estimated_audience_imps\"),lit(null).cast(DoubleType).as(\"audience_imps\"))","language":"scala","description":""}