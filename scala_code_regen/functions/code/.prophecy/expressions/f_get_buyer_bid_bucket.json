{"parameters":[{"name":"bid","type":"column","metadata":{"description":"","tags":[],"mappings":[]}}],"isCustomSchemaEnabled":false,"code":"var MIN_BID: org.apache.spark.sql.Column = lit(0.01)\nvar MAX_BID: org.apache.spark.sql.Column = lit(1000.0)\nvar BID_SCALE: org.apache.spark.sql.Column = lit(1000000.0)\nvar MIN_BUCKET: org.apache.spark.sql.Column = (MIN_BID * BID_SCALE).cast(IntegerType)\nvar MAX_BUCKET: org.apache.spark.sql.Column = (MAX_BID * BID_SCALE).cast(IntegerType)\nvar BUCKET_SIZE: org.apache.spark.sql.Column = ((log10(MAX_BID) - log10(MIN_BID)) / lit(1500)).cast(DoubleType)\nvar l_bid: org.apache.spark.sql.Column = lit(0)\nvar l_bid_bucket: org.apache.spark.sql.Column = lit(0)\nl_bid = when(is_not_null(bid), bid).otherwise(l_bid).cast(DoubleType)\nl_bid_bucket = when(l_bid > lit(0), when(l_bid <= MIN_BID, MIN_BUCKET).when(l_bid >= MAX_BID, MAX_BUCKET).otherwise(floor(pow(lit(10), decimal_round(log10(l_bid) / BUCKET_SIZE, 0) * BUCKET_SIZE) * BID_SCALE))).otherwise(l_bid_bucket).cast(IntegerType)\nl_bid_bucket","language":"scala","description":""}