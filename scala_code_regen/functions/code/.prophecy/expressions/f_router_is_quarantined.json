{"parameters":[{"name":"in1","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"advertiser_id_by_campaign_group_id_lookup","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"member_id_by_advertiser_id_lookup","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"member_id_by_publisher_id_lookup","type":"column","metadata":{"description":"","tags":[],"mappings":[]}}],"isCustomSchemaEnabled":true,"code":"var imp_type: org.apache.spark.sql.Column = col(\"imp_type\").cast(IntegerType).cast(IntegerType)\nvar seller_member_id: org.apache.spark.sql.Column = col(\"log_impbus_impressions.seller_member_id\").cast(IntegerType).cast(IntegerType)\nvar publisher_id: org.apache.spark.sql.Column = col(\"publisher_id\").cast(IntegerType).cast(IntegerType)\nvar buyer_member_id: org.apache.spark.sql.Column = coalesce(col(\"log_dw_bid.member_id\").cast(IntegerType), col(\"log_impbus_preempt.buyer_member_id\").cast(IntegerType), col(\"log_impbus_impressions.buyer_member_id\").cast(IntegerType), lit(null)).cast(IntegerType)\nvar advertiser_id: org.apache.spark.sql.Column = col(\"advertiser_id\").cast(IntegerType).cast(IntegerType)\nvar campaign_group_id: org.apache.spark.sql.Column = col(\"campaign_group_id\").cast(IntegerType).cast(IntegerType)\nvar publisher_seller_member_id: org.apache.spark.sql.Column = lit(null).cast(IntegerType)\nvar advertiser_buyer_member_id: org.apache.spark.sql.Column = lit(null).cast(IntegerType)\nvar campaign_group_advertiser_id: org.apache.spark.sql.Column = lit(null).cast(IntegerType)\nvar quarantine: org.apache.spark.sql.Column = lit(0)\nvar log_impbus_impressions_pricing_count: org.apache.spark.sql.Column = coalesce(col(\"log_impbus_impressions_pricing_count\").cast(IntegerType), lit(0)).cast(IntegerType)\nvar gross_payment_value_microcents: org.apache.spark.sql.Column = coalesce(col(\"log_impbus_impressions_pricing.impression_event_pricing.gross_payment_value_microcents\").cast(LongType), lit(0)).cast(LongType)\nvar gross_payment_value_microcents_dup: org.apache.spark.sql.Column = coalesce(col(\"log_impbus_impressions_pricing_dup.impression_event_pricing.gross_payment_value_microcents\").cast(LongType), lit(0)).cast(LongType)\nquarantine = when((is_not_null(col(\"log_dw_bid.member_id\").cast(IntegerType)) and is_not_null(coalesce(col(\"log_impbus_preempt.buyer_member_id\").cast(IntegerType), col(\"log_impbus_impressions.buyer_member_id\").cast(IntegerType), lit(null)))) and (coalesce(col(\"log_impbus_preempt.buyer_member_id\").cast(IntegerType), col(\"log_impbus_impressions.buyer_member_id\").cast(IntegerType), lit(null)) =!= col(\"log_dw_bid.member_id\").cast(IntegerType)), lit(1)).when((is_not_null(col(\"log_dw_bid_last.member_id\").cast(IntegerType)) and is_not_null(col(\"log_dw_bid.member_id\").cast(IntegerType))) and (col(\"log_dw_bid_last.member_id\").cast(IntegerType) =!= col(\"log_dw_bid.member_id\").cast(IntegerType)), lit(1)).when((is_not_null(col(\"log_dw_bid_last.advertiser_id\").cast(IntegerType)) and is_not_null(col(\"log_dw_bid.advertiser_id\").cast(IntegerType))) and (col(\"log_dw_bid_last.advertiser_id\").cast(IntegerType) =!= col(\"log_dw_bid.advertiser_id\").cast(IntegerType)), lit(1)).when((is_not_null(col(\"log_dw_bid_last.campaign_group_id\").cast(IntegerType)) and is_not_null(col(\"log_dw_bid.campaign_group_id\").cast(IntegerType))) and (col(\"log_dw_bid_last.campaign_group_id\").cast(IntegerType) =!= col(\"log_dw_bid.campaign_group_id\").cast(IntegerType)), lit(1)).otherwise(quarantine).cast(IntegerType)\nquarantine = when(quarantine === lit(0), when(isnull(member_id_by_publisher_id_lookup.getField(\"seller_member_id\")) and (is_not_null(publisher_id) and (publisher_id =!= lit(0))), lit(1)).when((((is_not_null(campaign_group_id) and (campaign_group_id =!= lit(0))) and is_not_null(advertiser_id)) and (advertiser_id =!= lit(0))) and ((((((is_not_null(imp_type) and ((imp_type === lit(6)) and (imp_type === lit(2)))) and is_not_null(seller_member_id)) and is_not_null(member_id_by_publisher_id_lookup.getField(\"seller_member_id\"))) and (seller_member_id =!= member_id_by_publisher_id_lookup.getField(\"seller_member_id\"))) or (((((is_not_null(imp_type) and (imp_type =!= lit(6))) and (imp_type =!= lit(2))) and is_not_null(buyer_member_id)) and is_not_null(member_id_by_advertiser_id_lookup.getField(\"buyer_member_id\"))) and (buyer_member_id =!= member_id_by_advertiser_id_lookup.getField(\"buyer_member_id\")))) or ((((is_not_null(buyer_member_id) and is_not_null(member_id_by_advertiser_id_lookup.getField(\"buyer_member_id\"))) and is_not_null(advertiser_id_by_campaign_group_id_lookup.getField(\"advertiser_id\"))) and (buyer_member_id =!= member_id_by_advertiser_id_lookup.getField(\"buyer_member_id\"))) and (advertiser_id =!= advertiser_id_by_campaign_group_id_lookup.getField(\"advertiser_id\")))), lit(1)).when((((is_not_null(imp_type) and ((imp_type === lit(6)) and (imp_type === lit(2)))) and is_not_null(seller_member_id)) and is_not_null(member_id_by_publisher_id_lookup.getField(\"seller_member_id\"))) and (seller_member_id =!= member_id_by_publisher_id_lookup.getField(\"seller_member_id\")), lit(1)).when((((is_not_null(publisher_id) and is_not_null(member_id_by_publisher_id_lookup.getField(\"seller_member_id\"))) and is_not_null(seller_member_id)) and (publisher_id =!= lit(0))) and (member_id_by_publisher_id_lookup.getField(\"seller_member_id\") =!= seller_member_id), lit(1)).when(((((is_not_null(imp_type) and (imp_type === lit(5))) and is_not_null(seller_member_id)) and is_not_null(buyer_member_id)) and (buyer_member_id =!= lit(0))) and (seller_member_id =!= buyer_member_id), lit(1)).otherwise(quarantine)).otherwise(quarantine).cast(IntegerType)\nquarantine = when(quarantine === lit(0), when((log_impbus_impressions_pricing_count > lit(1)) and (gross_payment_value_microcents =!= gross_payment_value_microcents_dup), lit(1)).otherwise(quarantine)).otherwise(quarantine).cast(IntegerType)\nquarantine","language":"scala","description":""}