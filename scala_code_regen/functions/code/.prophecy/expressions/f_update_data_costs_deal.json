{"parameters":[{"name":"data_costs","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"member_sales_tax_rate_pct","type":"column","metadata":{"description":"","tags":[],"mappings":[]}}],"output":{"type":"array","elementType":{"type":"struct","fields":[{"name":"data_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"cost","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"used_segments","type":{"type":"array","elementType":"integer","containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"cost_pct","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"isCustomSchemaEnabled":true,"code":"when(is_not_null(data_costs), temp2762257_UDF(array(), member_sales_tax_rate_pct.cast(DoubleType), lit(0), lit(null).cast(StructType(List(StructField(\"data_member_id\", IntegerType, true), StructField(\"cost\", DoubleType, true), StructField(\"used_segments\", ArrayType(IntegerType, true), true), StructField(\"cost_pct\", DoubleType, true)))), data_costs).getField(\"l_data_costs\"))","language":"scala","description":""}