{"parameters":[{"name":"impression_transaction_event_pricing","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"auction_transaction_event_pricing","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"buyer_charges","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"seller_charges","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"should_process_views","type":"column","metadata":{"description":"","tags":[],"mappings":[]}}],"output":{"type":"struct","fields":[{"name":"gross_payment_value_microcents","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"net_payment_value_microcents","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_revenue_microcents","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_charges","type":{"type":"struct","fields":[{"name":"rate_card_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_dw","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"pricing_terms","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"term_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amount","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_deduction","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_media_cost_dependent","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"data_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"fx_margin_rate_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"marketplace_owner_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"virtual_marketplace_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amino_enabled","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_charges","type":{"type":"struct","fields":[{"name":"rate_card_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_dw","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"pricing_terms","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"term_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amount","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_deduction","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_media_cost_dependent","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"data_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"fx_margin_rate_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"marketplace_owner_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"virtual_marketplace_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amino_enabled","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_transacted","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_transacted","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"isCustomSchemaEnabled":true,"code":"var l_transaction_event_pricing: org.apache.spark.sql.Column = struct(lit(null).as(\"gross_payment_value_microcents\"),lit(null).as(\"net_payment_value_microcents\"),lit(null).as(\"seller_revenue_microcents\"),lit(null).as(\"buyer_charges\"),lit(null).as(\"seller_charges\"),lit(null).as(\"buyer_transacted\"),lit(null).as(\"seller_transacted\"))\nl_transaction_event_pricing = impression_transaction_event_pricing\nl_transaction_event_pricing = struct(when(((should_process_views === lit(1)) and is_not_null(auction_transaction_event_pricing.getField(\"buyer_transacted\"))) and (auction_transaction_event_pricing.getField(\"buyer_transacted\") === lit(1)), auction_transaction_event_pricing.getField(\"gross_payment_value_microcents\")).otherwise(impression_transaction_event_pricing.getField(\"gross_payment_value_microcents\")).as(\"gross_payment_value_microcents\"),when(((should_process_views === lit(1)) and is_not_null(auction_transaction_event_pricing.getField(\"buyer_transacted\"))) and (auction_transaction_event_pricing.getField(\"buyer_transacted\") === lit(1)), auction_transaction_event_pricing.getField(\"net_payment_value_microcents\")).otherwise(impression_transaction_event_pricing.getField(\"net_payment_value_microcents\")).as(\"net_payment_value_microcents\"),when(((should_process_views === lit(1)) and is_not_null(auction_transaction_event_pricing.getField(\"seller_transacted\"))) and (auction_transaction_event_pricing.getField(\"seller_transacted\") === lit(1)), auction_transaction_event_pricing.getField(\"seller_revenue_microcents\")).otherwise(impression_transaction_event_pricing.getField(\"seller_revenue_microcents\")).as(\"seller_revenue_microcents\"),struct(when(is_not_null(buyer_charges), buyer_charges.getField(\"rate_card_id\")).otherwise(impression_transaction_event_pricing.getField(\"buyer_charges\").getField(\"rate_card_id\")).as(\"rate_card_id\"),when(is_not_null(buyer_charges), buyer_charges.getField(\"member_id\")).otherwise(impression_transaction_event_pricing.getField(\"buyer_charges\").getField(\"member_id\")).as(\"member_id\"),when(is_not_null(buyer_charges), buyer_charges.getField(\"is_dw\")).otherwise(impression_transaction_event_pricing.getField(\"buyer_charges\").getField(\"is_dw\")).as(\"is_dw\"),impression_transaction_event_pricing.getField(\"buyer_charges\").getField(\"pricing_terms\").as(\"pricing_terms\"),when(is_not_null(buyer_charges), buyer_charges.getField(\"fx_margin_rate_id\")).otherwise(impression_transaction_event_pricing.getField(\"buyer_charges\").getField(\"fx_margin_rate_id\")).as(\"fx_margin_rate_id\"),when(is_not_null(buyer_charges), buyer_charges.getField(\"marketplace_owner_id\")).otherwise(impression_transaction_event_pricing.getField(\"buyer_charges\").getField(\"marketplace_owner_id\")).as(\"marketplace_owner_id\"),when(is_not_null(buyer_charges), buyer_charges.getField(\"virtual_marketplace_id\")).otherwise(impression_transaction_event_pricing.getField(\"buyer_charges\").getField(\"virtual_marketplace_id\")).as(\"virtual_marketplace_id\"),when(is_not_null(buyer_charges), buyer_charges.getField(\"amino_enabled\")).otherwise(impression_transaction_event_pricing.getField(\"buyer_charges\").getField(\"amino_enabled\")).as(\"amino_enabled\")).as(\"buyer_charges\"),struct(when(is_not_null(seller_charges), seller_charges.getField(\"rate_card_id\")).otherwise(impression_transaction_event_pricing.getField(\"seller_charges\").getField(\"rate_card_id\")).as(\"rate_card_id\"),when(is_not_null(seller_charges), seller_charges.getField(\"member_id\")).otherwise(impression_transaction_event_pricing.getField(\"seller_charges\").getField(\"member_id\")).as(\"member_id\"),when(is_not_null(seller_charges), seller_charges.getField(\"is_dw\")).otherwise(impression_transaction_event_pricing.getField(\"seller_charges\").getField(\"is_dw\")).as(\"is_dw\"),impression_transaction_event_pricing.getField(\"seller_charges\").getField(\"pricing_terms\").as(\"pricing_terms\"),when(is_not_null(seller_charges), seller_charges.getField(\"fx_margin_rate_id\")).otherwise(impression_transaction_event_pricing.getField(\"seller_charges\").getField(\"fx_margin_rate_id\")).as(\"fx_margin_rate_id\"),when(is_not_null(seller_charges), seller_charges.getField(\"marketplace_owner_id\")).otherwise(impression_transaction_event_pricing.getField(\"seller_charges\").getField(\"marketplace_owner_id\")).as(\"marketplace_owner_id\"),when(is_not_null(seller_charges), seller_charges.getField(\"virtual_marketplace_id\")).otherwise(impression_transaction_event_pricing.getField(\"seller_charges\").getField(\"virtual_marketplace_id\")).as(\"virtual_marketplace_id\"),when(is_not_null(seller_charges), seller_charges.getField(\"amino_enabled\")).otherwise(impression_transaction_event_pricing.getField(\"seller_charges\").getField(\"amino_enabled\")).as(\"amino_enabled\")).as(\"seller_charges\"),when(((should_process_views === lit(1)) and is_not_null(auction_transaction_event_pricing.getField(\"buyer_transacted\"))) and (auction_transaction_event_pricing.getField(\"buyer_transacted\") === lit(1)), auction_transaction_event_pricing.getField(\"buyer_transacted\")).otherwise(impression_transaction_event_pricing.getField(\"buyer_transacted\")).as(\"buyer_transacted\"),when(((should_process_views === lit(1)) and is_not_null(auction_transaction_event_pricing.getField(\"seller_transacted\"))) and (auction_transaction_event_pricing.getField(\"seller_transacted\") === lit(1)), auction_transaction_event_pricing.getField(\"seller_transacted\")).otherwise(impression_transaction_event_pricing.getField(\"seller_transacted\")).as(\"seller_transacted\"))\nl_transaction_event_pricing","language":"scala","description":""}