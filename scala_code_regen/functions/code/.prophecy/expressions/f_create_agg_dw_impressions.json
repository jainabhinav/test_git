{"parameters":[{"name":"sup_ip_range_lookup_count","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"sup_bidder_member_sales_tax_rate_lookup_2","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"sup_common_deal_lookup_2","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"sup_bidder_member_sales_tax_rate_lookup","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"sup_common_deal_lookup","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"sup_bidder_campaign_lookup","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"_f_view_detection_enabled","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"f_transaction_event_type_id_87067","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"_f_viewdef_definition_id","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"_f_is_buy_side","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"_f_has_transacted","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"f_transaction_event_87047","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"f_transaction_event_87057","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"f_preempt_over_impression_95337","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"f_transaction_event_type_id_87077","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"f_preempt_over_impression_94298","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"f_preempt_over_impression_88439","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"f_preempt_over_impression_88639","type":"column","metadata":{"description":"","tags":[],"mappings":[]}}],"output":{"type":"struct","fields":[{"name":"date_time","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"auction_id_64","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"user_id_64","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"tag_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"venue_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"inventory_source_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"session_frequency","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"site_domain","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"width","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"height","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"geo_country","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"geo_region","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"gender","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"age","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"creative_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_currency","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_currency","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_bid","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_spend","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"ecp","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"reserve_price","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"advertiser_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"campaign_group_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"campaign_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"creative_freq","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"creative_rec","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_learn","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_remarketing","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"advertiser_frequency","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"advertiser_recency","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"user_group_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"camp_dp_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"media_buy_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"media_buy_cost","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"brand_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"cleared_direct","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"clear_fees","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"media_buy_rev_share_pct","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"revenue_value","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"pricing_type","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"can_convert","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"pub_rule_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_control","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"control_pct","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"control_creative_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"predicted_cpm","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"actual_bid","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"site_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"content_category_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"auction_service_fees","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"discrepancy_allowance","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"forex_allowance","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"creative_overage_fees","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"fold_position","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"external_inv_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"cadence_modifier","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"imp_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"advertiser_currency","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"advertiser_exchange_rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"ip_address","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"publisher_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"auction_service_deduction","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"insertion_order_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"predict_type_rev","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"predict_type_goal","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"predict_type_cost","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"booked_revenue_dollars","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"booked_revenue_adv_curr","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"commission_cpm","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"commission_revshare","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"serving_fees_cpm","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"serving_fees_revshare","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"user_tz_offset","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"media_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"operating_system","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"browser","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"language","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"publisher_currency","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"publisher_exchange_rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"media_cost_dollars_cpm","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"payment_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"revenue_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_revenue_cpm","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"bidder_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"inv_code","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"application_id","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"shadow_price","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"eap","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"datacenter_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"imp_blacklist_or_fraud","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"vp_expose_domains","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"vp_expose_categories","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"vp_expose_pubs","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"vp_expose_tag","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"vp_expose_age","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"vp_expose_gender","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"inventory_url_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"audit_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_exclusive","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"truncate_ip","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"device_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"carrier_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"creative_audit_status","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_creative_hosted","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_deduction","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"city","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"latitude","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"longitude","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"device_unique_id","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"package_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"targeted_segments","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"supply_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_toolbar","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"deal_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"vp_bitmap","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"view_detection_enabled","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"view_result","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"ozone_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_performance","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"sdk_version","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"inventory_session_frequency","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"device_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"dma","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"postal","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"viewdef_definition_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"viewdef_viewable","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"view_measurable","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"viewable","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_secure","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"view_non_measurable_reason","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"data_costs","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"data_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"cost","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"used_segments","type":{"type":"array","elementType":"integer","containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"cost_pct","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"bidder_instance_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"campaign_group_freq","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"campaign_group_rec","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"insertion_order_freq","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"insertion_order_rec","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_gender","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_age","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"targeted_segment_list","type":{"type":"array","elementType":"integer","containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"custom_model_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"custom_model_last_modified","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"custom_model_output_code","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"external_uid","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"request_uuid","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"mobile_app_instance_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"traffic_source_code","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"external_request_id","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"stitch_group_id","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"deal_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"ym_floor_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"ym_bias_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"bid_priority","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_charges","type":{"type":"struct","fields":[{"name":"rate_card_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_dw","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"pricing_terms","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"term_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amount","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_deduction","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_media_cost_dependent","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"data_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"fx_margin_rate_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"marketplace_owner_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"virtual_marketplace_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amino_enabled","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_charges","type":{"type":"struct","fields":[{"name":"rate_card_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_dw","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"pricing_terms","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"term_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amount","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_deduction","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_media_cost_dependent","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"data_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"fx_margin_rate_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"marketplace_owner_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"virtual_marketplace_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amino_enabled","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"explore_disposition","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"device_make_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"operating_system_family_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"tag_sizes","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"width","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"height","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"campaign_group_models","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"model_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"model_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"leaf_code","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"origin","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"experiment","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"value","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"pricing_media_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_trx_event_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_trx_event_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"revenue_auction_event_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_prebid","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_unit_of_trx","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"imps_for_budget_caps_pacing","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"auction_timestamp","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"two_phase_reduction_applied","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"region_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"media_company_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"trade_agreement_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"personal_data","type":{"type":"struct","fields":[{"name":"user_id_64","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"device_unique_id","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"external_uid","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"ip_address","type":"binary","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"crossdevice_group","type":{"type":"struct","fields":[{"name":"graph_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"group_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"latitude","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"longitude","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"ipv6_address","type":"binary","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"subject_to_gdpr","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"geo_country","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"gdpr_consent_string","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"preempt_ip_address","type":"binary","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"device_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"device_make_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"device_model_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"new_user_id_64","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_service_provider_mode","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_personal_info_sale","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"anonymized_user_info","type":{"type":"struct","fields":[{"name":"user_id","type":"binary","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"gdpr_consent_cookie","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"additional_clearing_events","type":{"type":"array","elementType":"integer","containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"fx_rate_snapshot_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"crossdevice_group_anon","type":{"type":"struct","fields":[{"name":"graph_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"group_id","type":"binary","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"crossdevice_graph_cost","type":{"type":"struct","fields":[{"name":"graph_provider_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"cost_cpm_usd","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"revenue_event_type_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_trx_event_type_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_trx_event_type_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"external_creative_id","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"targeted_segment_details","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"segment_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"last_seen_min","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"bidder_seat_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_whiteops_scanned","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"default_referrer_url","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_curated","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"curator_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"total_partner_fees_microcents","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"net_buyer_spend","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_prebid_server","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"cold_start_price_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"discovery_state","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"billing_period_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"flight_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"split_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"net_media_cost_dollars_cpm","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"total_data_costs_microcents","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"total_profit_microcents","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"targeted_crossdevice_graph_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"discovery_prediction","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"campaign_group_type_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"hb_source","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"external_campaign_id","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"excluded_targeted_segment_details","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"segment_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"trust_id","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"predicted_kpi_event_rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"has_crossdevice_reach_extension","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"crossdevice_graph_membership","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"graph_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"group_id","type":"binary","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"total_segment_data_costs_microcents","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"total_feature_costs_microcents","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"counterparty_ruleset_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"log_product_ads","type":{"type":"struct","fields":[{"name":"product_feed_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"item_selection_strategy_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"product_uuid","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_line_item_currency","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"deal_line_item_currency","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"measurement_fee_usd","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"measurement_provider_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"offline_attribution_provider_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"offline_attribution_cost_usd_cpm","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"pred_info","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"imp_rejecter_do_auction","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"personal_identifiers","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"identity_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"identity_value","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"imp_rejecter_applied","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"ip_derived_latitude","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"ip_derived_longitude","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"personal_identifiers_experimental","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"identity_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"identity_value","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"postal_code_ext_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"ecpm_conversion_rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_residential_ip","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"hashed_ip","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"targeted_segment_details_by_id_type","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"identity_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"targeted_segment_details","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"segment_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"last_seen_min","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"offline_attribution","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"provider_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"cost_usd_cpm","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"frequency_cap_type_internal","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"modeled_cap_did_override_line_item_daily_cap","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"modeled_cap_user_sample_rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"estimated_audience_imps","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"audience_imps","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"district_postal_code_lists","type":{"type":"array","elementType":"integer","containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"bidding_host_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_dpvp_bitmap","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_dpvp_bitmap","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"browser_code_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_prebid_server_included","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"feature_tests_bitmap","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"private_auction_eligible","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"chrome_traffic_label","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_private_auction","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"creative_media_subtype_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"allowed_media_types","type":{"type":"array","elementType":"integer","containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"isCustomSchemaEnabled":true,"code":"var imp_type: org.apache.spark.sql.Column = lit(1)\nvar is_dw_normalized: org.apache.spark.sql.Column = lit(0)\nvar buyer_member_id: org.apache.spark.sql.Column = lit(0)\nvar campaign: org.apache.spark.sql.Column = lit(null).cast(StructType(List(StructField(\"campaign_id\", IntegerType, true), StructField(\"campaign_type_id\", IntegerType, true), StructField(\"campaign_group_id\", IntegerType, true), StructField(\"campaign_group_type_id\", IntegerType, true))))\nvar split_id: org.apache.spark.sql.Column = coalesce(col(\"log_dw_bid.split_id\").cast(IntegerType), lit(0)).cast(IntegerType)\nvar seller_trx_event_id: org.apache.spark.sql.Column = lit(0)\nvar buyer_trx_event_id: org.apache.spark.sql.Column = lit(0)\nvar seller_trx_event_type_id: org.apache.spark.sql.Column = lit(0)\nvar buyer_trx_event_type_id: org.apache.spark.sql.Column = lit(0)\nvar payment_type_normalized: org.apache.spark.sql.Column = lit(999)\nvar revenue_type_normalized: org.apache.spark.sql.Column = lit(999)\nvar has_seller_transacted: org.apache.spark.sql.Column = lit(0).cast(BooleanType)\nvar has_buyer_transacted: org.apache.spark.sql.Column = lit(0).cast(BooleanType)\nvar view_detection_enabled: org.apache.spark.sql.Column = lit(0)\nvar view_measurable: org.apache.spark.sql.Column = lit(0)\nvar viewable: org.apache.spark.sql.Column = lit(0)\nvar view_non_measurable_reason: org.apache.spark.sql.Column = lit(0)\nvar viewdef_definition_id: org.apache.spark.sql.Column = lit(0)\nvar viewdef_viewable: org.apache.spark.sql.Column = lit(0)\nvar view_result: org.apache.spark.sql.Column = lit(0)\nvar is_curated: org.apache.spark.sql.Column = lit(0)\nvar curator_member_id: org.apache.spark.sql.Column = lit(null).cast(IntegerType)\nvar member_id_by_deal_id: org.apache.spark.sql.Column = lit(null).cast(StructType(List(StructField(\"id\", IntegerType, true), StructField(\"member_id\", IntegerType, true), StructField(\"deal_type_id\", IntegerType, true))))\nvar deal_id: org.apache.spark.sql.Column = lit(0)\nvar deal_type: org.apache.spark.sql.Column = lit(null).cast(IntegerType)\nvar ttl: org.apache.spark.sql.Column = lit(0)\nvar imps_for_budget_caps_pacing: org.apache.spark.sql.Column = lit(0)\nvar is_budget_table_imp_type: org.apache.spark.sql.Column = lit(0)\nvar is_not_roadblock_secondary: org.apache.spark.sql.Column = lit(0)\nvar is_external_imp_type: org.apache.spark.sql.Column = lit(0)\nvar is_not_video_imp: org.apache.spark.sql.Column = lit(0)\nvar creative_id: org.apache.spark.sql.Column = lit(null).cast(IntegerType)\nvar advertiser_id: org.apache.spark.sql.Column = lit(null).cast(IntegerType)\nvar campaign_group_id: org.apache.spark.sql.Column = lit(null).cast(IntegerType)\nvar insertion_order_id: org.apache.spark.sql.Column = lit(null).cast(IntegerType)\nvar campaign_id: org.apache.spark.sql.Column = lit(null).cast(IntegerType)\nvar campaign_group_type_id: org.apache.spark.sql.Column = lit(0)\nvar is_placeholder_bid: org.apache.spark.sql.Column = lit(0)\nvar flight_id: org.apache.spark.sql.Column = lit(null).cast(IntegerType)\nvar billing_period_id: org.apache.spark.sql.Column = lit(null).cast(IntegerType)\nvar should_process_views: org.apache.spark.sql.Column = lit(null).cast(IntegerType)\nvar should_zero_seller_revenue: org.apache.spark.sql.Column = lit(0).cast(BooleanType)\nvar v_transaction_event_pricing: org.apache.spark.sql.Column = lit(null).cast(StructType(List(StructField(\"gross_payment_value_microcents\", LongType, true), StructField(\"net_payment_value_microcents\", LongType, true), StructField(\"seller_revenue_microcents\", LongType, true), StructField(\"buyer_charges\", StructType(List(StructField(\"rate_card_id\", IntegerType, true), StructField(\"member_id\", IntegerType, true), StructField(\"is_dw\", BooleanType, true), StructField(\"pricing_terms\", ArrayType(StructType(List(StructField(\"term_id\", IntegerType, true), StructField(\"amount\", DoubleType, true), StructField(\"rate\", DoubleType, true), StructField(\"is_deduction\", BooleanType, true), StructField(\"is_media_cost_dependent\", BooleanType, true), StructField(\"data_member_id\", IntegerType, true))), true), true), StructField(\"fx_margin_rate_id\", IntegerType, true), StructField(\"marketplace_owner_id\", IntegerType, true), StructField(\"virtual_marketplace_id\", IntegerType, true), StructField(\"amino_enabled\", BooleanType, true))), true), StructField(\"seller_charges\", StructType(List(StructField(\"rate_card_id\", IntegerType, true), StructField(\"member_id\", IntegerType, true), StructField(\"is_dw\", BooleanType, true), StructField(\"pricing_terms\", ArrayType(StructType(List(StructField(\"term_id\", IntegerType, true), StructField(\"amount\", DoubleType, true), StructField(\"rate\", DoubleType, true), StructField(\"is_deduction\", BooleanType, true), StructField(\"is_media_cost_dependent\", BooleanType, true), StructField(\"data_member_id\", IntegerType, true))), true), true), StructField(\"fx_margin_rate_id\", IntegerType, true), StructField(\"marketplace_owner_id\", IntegerType, true), StructField(\"virtual_marketplace_id\", IntegerType, true), StructField(\"amino_enabled\", BooleanType, true))), true), StructField(\"buyer_transacted\", BooleanType, true), StructField(\"seller_transacted\", BooleanType, true))))\nvar buyer_charges_pricing_terms: org.apache.spark.sql.Column = lit(null).cast(ArrayType(StructType(List(StructField(\"term_id\", IntegerType, true), StructField(\"amount\", DoubleType, true), StructField(\"rate\", DoubleType, true), StructField(\"is_deduction\", BooleanType, true), StructField(\"is_media_cost_dependent\", BooleanType, true), StructField(\"data_member_id\", IntegerType, true))), true))\nvar seller_charges_pricing_terms: org.apache.spark.sql.Column = lit(null).cast(ArrayType(StructType(List(StructField(\"term_id\", IntegerType, true), StructField(\"amount\", DoubleType, true), StructField(\"rate\", DoubleType, true), StructField(\"is_deduction\", BooleanType, true), StructField(\"is_media_cost_dependent\", BooleanType, true), StructField(\"data_member_id\", IntegerType, true))), true))\nvar v_pricing_term: org.apache.spark.sql.Column = lit(null).cast(StructType(List(StructField(\"term_id\", IntegerType, true), StructField(\"amount\", DoubleType, true), StructField(\"rate\", DoubleType, true), StructField(\"is_deduction\", BooleanType, true), StructField(\"is_media_cost_dependent\", BooleanType, true), StructField(\"data_member_id\", IntegerType, true))))\nvar auction_service_deduction: org.apache.spark.sql.Column = lit(0)\nvar auction_service_fees: org.apache.spark.sql.Column = lit(0)\nvar discrepancy_allowance: org.apache.spark.sql.Column = lit(0)\nvar creative_overage_fees: org.apache.spark.sql.Column = lit(0)\nvar buyer_spend_cpm: org.apache.spark.sql.Column = lit(0)\nvar buyer_spend_microcents: org.apache.spark.sql.Column = lit(0)\nvar seller_revenue_cpm: org.apache.spark.sql.Column = lit(0)\nvar seller_revenue_microcents: org.apache.spark.sql.Column = lit(0)\nvar seller_deduction_term_id_1: org.apache.spark.sql.Column = lit(0)\nvar seller_deduction_term_id_74: org.apache.spark.sql.Column = lit(0)\nvar seller_deduction: org.apache.spark.sql.Column = lit(0)\nvar commission_cpm: org.apache.spark.sql.Column = lit(0)\nvar commission_revshare: org.apache.spark.sql.Column = lit(0)\nvar serving_fees_cpm: org.apache.spark.sql.Column = lit(0)\nvar serving_fees_revshare: org.apache.spark.sql.Column = lit(0)\nvar booked_revenue_dollars: org.apache.spark.sql.Column = lit(0)\nvar media_buy_rev_share_pct: org.apache.spark.sql.Column = lit(0)\nvar media_buy_cost: org.apache.spark.sql.Column = lit(0)\nvar booked_revenue_adv_curr: org.apache.spark.sql.Column = lit(0)\nvar media_cost_dollars_cpm: org.apache.spark.sql.Column = lit(0)\nvar member_sales_tax_rate_pct: org.apache.spark.sql.Column = lit(0)\nvar revenue_value: org.apache.spark.sql.Column = coalesce(col(\"log_dw_bid.revenue_value_dollars\"), lit(0)).cast(DoubleType)\nvar data_costs: org.apache.spark.sql.Column = lit(null).cast(ArrayType(StructType(List(StructField(\"data_member_id\", IntegerType, true), StructField(\"cost\", DoubleType, true), StructField(\"used_segments\", ArrayType(IntegerType, true), true), StructField(\"cost_pct\", DoubleType, true))), true))\nvar virtual_log_dw_bid: org.apache.spark.sql.Column = struct(lit(0L).cast(LongType).as(\"date_time\"),lit(0L).cast(LongType).as(\"auction_id_64\"),lit(null).as(\"price\"),lit(null).as(\"member_id\"),lit(null).as(\"advertiser_id\"),lit(null).as(\"campaign_group_id\"),lit(null).as(\"campaign_id\"),lit(null).as(\"creative_id\"),lit(null).as(\"creative_freq\"),lit(null).as(\"creative_rec\"),lit(null).as(\"advertiser_freq\"),lit(null).as(\"advertiser_rec\"),lit(null).as(\"is_remarketing\"),lit(null).as(\"user_group_id\"),lit(null).as(\"media_buy_cost\"),lit(null).as(\"is_default\"),lit(null).as(\"pub_rule_id\"),lit(null).as(\"media_buy_rev_share_pct\"),lit(null).as(\"pricing_type\"),lit(null).as(\"can_convert\"),lit(null).as(\"is_control\"),lit(null).as(\"control_pct\"),lit(null).as(\"control_creative_id\"),lit(null).as(\"cadence_modifier\"),lit(null).as(\"advertiser_currency\"),lit(null).as(\"advertiser_exchange_rate\"),lit(null).as(\"insertion_order_id\"),lit(null).as(\"predict_type\"),lit(null).as(\"predict_type_goal\"),lit(null).as(\"revenue_value_dollars\"),lit(null).as(\"revenue_value_adv_curr\"),lit(null).as(\"commission_cpm\"),lit(null).as(\"commission_revshare\"),lit(null).as(\"serving_fees_cpm\"),lit(null).as(\"serving_fees_revshare\"),lit(null).as(\"publisher_currency\"),lit(null).as(\"publisher_exchange_rate\"),lit(null).as(\"payment_type\"),lit(null).as(\"payment_value\"),lit(null).as(\"creative_group_freq\"),lit(null).as(\"creative_group_rec\"),lit(null).as(\"revenue_type\"),lit(null).as(\"apply_cost_on_default\"),lit(null).as(\"instance_id\"),lit(null).as(\"vp_expose_age\"),lit(null).as(\"vp_expose_gender\"),lit(null).as(\"targeted_segments\"),lit(null).as(\"ttl\"),lit(0L).cast(LongType).as(\"auction_timestamp\"),array().cast(ArrayType(StructType(List(StructField(\"data_member_id\", IntegerType, true), StructField(\"cost\", DoubleType, true), StructField(\"used_segments\", ArrayType(IntegerType, true), true), StructField(\"cost_pct\", DoubleType, true))), true)).as(\"data_costs\"),array().cast(ArrayType(IntegerType, true)).as(\"targeted_segment_list\"),lit(null).as(\"campaign_group_freq\"),lit(null).as(\"campaign_group_rec\"),lit(null).as(\"insertion_order_freq\"),lit(null).as(\"insertion_order_rec\"),lit(null).as(\"buyer_gender\"),lit(null).as(\"buyer_age\"),lit(null).as(\"custom_model_id\"),lit(null).as(\"custom_model_last_modified\"),lit(null).as(\"custom_model_output_code\"),lit(null).as(\"bid_priority\"),lit(null).as(\"explore_disposition\"),lit(null).as(\"revenue_auction_event_type\"),array().cast(ArrayType(StructType(List(StructField(\"model_type\", IntegerType, true), StructField(\"model_id\", IntegerType, true), StructField(\"leaf_code\", StringType, true), StructField(\"origin\", IntegerType, true), StructField(\"experiment\", IntegerType, true), StructField(\"value\", DoubleType, true))), true)).as(\"campaign_group_models\"),lit(null).as(\"impression_transaction_type\"),lit(null).as(\"is_deferred\"),lit(null).as(\"log_type\"),lit(null).as(\"crossdevice_group_anon\"),lit(null).as(\"fx_rate_snapshot_id\"),lit(null).as(\"crossdevice_graph_cost\"),lit(null).as(\"revenue_event_type_id\"),array().cast(ArrayType(StructType(List(StructField(\"segment_id\", IntegerType, true), StructField(\"last_seen_min\", IntegerType, true))), true)).as(\"targeted_segment_details\"),lit(null).as(\"insertion_order_budget_interval_id\"),lit(null).as(\"campaign_group_budget_interval_id\"),lit(null).as(\"cold_start_price_type\"),lit(null).as(\"discovery_state\"),lit(null).as(\"revenue_info\"),lit(null).as(\"use_revenue_info\"),lit(null).as(\"sales_tax_rate_pct\"),lit(null).as(\"targeted_crossdevice_graph_id\"),lit(null).as(\"product_feed_id\"),lit(null).as(\"item_selection_strategy_id\"),lit(null).as(\"discovery_prediction\"),lit(null).as(\"bidding_host_id\"),lit(null).as(\"split_id\"),array().cast(ArrayType(StructType(List(StructField(\"segment_id\", IntegerType, true))), true)).as(\"excluded_targeted_segment_details\"),lit(null).as(\"predicted_kpi_event_rate\"),lit(null).as(\"has_crossdevice_reach_extension\"),lit(null).as(\"advertiser_expected_value_ecpm_ac\"),lit(null).as(\"bpp_multiplier\"),lit(null).as(\"bpp_offset\"),lit(null).as(\"bid_modifier\"),lit(null).as(\"payment_value_microcents\"),array().cast(ArrayType(StructType(List(StructField(\"graph_id\", IntegerType, true), StructField(\"group_id\", BinaryType, true))), true)).as(\"crossdevice_graph_membership\"),array().cast(ArrayType(StructType(List(StructField(\"kpi_event_id\", IntegerType, true), StructField(\"ev_kpi_event_ac\", DoubleType, true), StructField(\"p_kpi_event\", DoubleType, true), StructField(\"bpo_aggressiveness_factor\", DoubleType, true), StructField(\"min_margin_pct\", DoubleType, true), StructField(\"max_revenue_or_bid_value\", DoubleType, true), StructField(\"min_revenue_or_bid_value\", DoubleType, true), StructField(\"cold_start_price_ac\", DoubleType, true), StructField(\"dynamic_bid_max_revenue_ac\", DoubleType, true), StructField(\"p_revenue_event\", DoubleType, true), StructField(\"total_fees_deducted_ac\", DoubleType, true))), true)).as(\"valuation_landscape\"),lit(null).as(\"line_item_currency\"),lit(null).as(\"measurement_fee_cpm_usd\"),lit(null).as(\"measurement_provider_id\"),lit(null).as(\"measurement_provider_member_id\"),lit(null).as(\"offline_attribution_provider_member_id\"),lit(null).as(\"offline_attribution_cost_usd_cpm\"),array().cast(ArrayType(StructType(List(StructField(\"identity_type\", IntegerType, true), StructField(\"targeted_segment_details\", ArrayType(StructType(List(StructField(\"segment_id\", IntegerType, true), StructField(\"last_seen_min\", IntegerType, true))), true), true))), true)).as(\"targeted_segment_details_by_id_type\"),array().cast(ArrayType(StructType(List(StructField(\"provider_member_id\", IntegerType, true), StructField(\"cost_usd_cpm\", DoubleType, true))), true)).as(\"offline_attribution\"),lit(null).as(\"frequency_cap_type_internal\"),lit(null).as(\"modeled_cap_did_override_line_item_daily_cap\"),lit(null).as(\"modeled_cap_user_sample_rate\"),lit(null).as(\"bid_rate\"),array().cast(ArrayType(IntegerType, true)).as(\"district_postal_code_lists\"),lit(null).as(\"pre_bpp_price\"),lit(null).as(\"feature_tests_bitmap\"))\nvar data_costs_deal: org.apache.spark.sql.Column = lit(null).cast(ArrayType(StructType(List(StructField(\"data_member_id\", IntegerType, true), StructField(\"cost\", DoubleType, true), StructField(\"used_segments\", ArrayType(IntegerType, true), true), StructField(\"cost_pct\", DoubleType, true))), true))\nimp_type = when(is_not_null(col(\"imp_type\").cast(IntegerType)), col(\"imp_type\").cast(IntegerType)).otherwise(imp_type).cast(IntegerType)\nttl = coalesce(col(\"log_impbus_impressions.ttl\").cast(IntegerType), lit(0)).cast(IntegerType)\nbuyer_member_id = f_preempt_over_impression_non_zero_explicit(is_not_null(col(\"log_impbus_preempt.buyer_member_id\").cast(IntegerType)), col(\"log_impbus_impressions.buyer_member_id\").cast(IntegerType), col(\"log_impbus_preempt.buyer_member_id\").cast(IntegerType)).cast(IntegerType)\nis_dw_normalized = when(((((((((is_not_null(col(\"log_impbus_impressions_pricing.seller_charges.is_dw\")) and (col(\"log_impbus_impressions_pricing.seller_charges.is_dw\") === lit(1))) and is_not_null(col(\"log_impbus_impressions_pricing.buyer_charges.is_dw\"))) and (col(\"log_impbus_impressions_pricing.buyer_charges.is_dw\") === lit(1))) and ((((((imp_type =!= lit(1)) and (imp_type =!= lit(2))) and (imp_type =!= lit(3))) and (imp_type =!= lit(8))) and (imp_type =!= lit(5))) and (imp_type =!= lit(9)))) and is_not_null(col(\"seller_member_id\").cast(IntegerType))) and (col(\"seller_member_id\").cast(IntegerType) =!= lit(0))) and is_not_null(f_preempt_over_impression_non_zero_explicit(is_not_null(col(\"log_impbus_preempt.buyer_member_id\").cast(IntegerType)), col(\"log_impbus_impressions.buyer_member_id\").cast(IntegerType), col(\"log_impbus_preempt.buyer_member_id\").cast(IntegerType)))) and (f_preempt_over_impression_non_zero_explicit(is_not_null(col(\"log_impbus_preempt.buyer_member_id\").cast(IntegerType)), col(\"log_impbus_impressions.buyer_member_id\").cast(IntegerType), col(\"log_impbus_preempt.buyer_member_id\").cast(IntegerType)) =!= lit(0))) and (col(\"seller_member_id\").cast(IntegerType) =!= f_preempt_over_impression_non_zero_explicit(is_not_null(col(\"log_impbus_preempt.buyer_member_id\").cast(IntegerType)), col(\"log_impbus_impressions.buyer_member_id\").cast(IntegerType), col(\"log_impbus_preempt.buyer_member_id\").cast(IntegerType))), lit(1)).otherwise(is_dw_normalized).cast(IntegerType)\ncampaign_group_type_id = when(((is_not_null(col(\"campaign_id\").cast(IntegerType)) and (col(\"campaign_id\").cast(IntegerType) =!= lit(0))) and (is_not_null(sup_bidder_campaign_lookup) and is_not_null(sup_bidder_campaign_lookup.getField(\"campaign_group_type_id\")))) and (_f_is_buy_side === lit(1)), sup_bidder_campaign_lookup.getField(\"campaign_group_type_id\")).otherwise(campaign_group_type_id).cast(IntegerType)\nseller_trx_event_id = f_transaction_event_87047.cast(IntegerType)\nbuyer_trx_event_id = f_transaction_event_87057.cast(IntegerType)\nseller_trx_event_type_id = f_transaction_event_type_id_87067.cast(IntegerType)\nbuyer_trx_event_type_id = f_transaction_event_type_id_87077.cast(IntegerType)\nshould_process_views = f_should_process_views(col(\"log_dw_view\"), seller_trx_event_id, buyer_trx_event_id).cast(IntegerType)\nv_transaction_event_pricing = f_get_transaction_event_pricing(col(\"log_impbus_impressions_pricing.impression_event_pricing\"), col(\"log_impbus_auction_event.auction_event_pricing\"), col(\"log_impbus_impressions_pricing.buyer_charges\"), col(\"log_impbus_impressions_pricing.seller_charges\"), should_process_views)\nbuyer_charges_pricing_terms = when(is_not_null(f_get_transaction_event_pricing(col(\"log_impbus_impressions_pricing.impression_event_pricing\"), col(\"log_impbus_auction_event.auction_event_pricing\"), col(\"log_impbus_impressions_pricing.buyer_charges\"), col(\"log_impbus_impressions_pricing.seller_charges\"), f_should_process_views(col(\"log_dw_view\"), f_transaction_event_87047, f_transaction_event_87057)).getField(\"buyer_charges\").getField(\"pricing_terms\")), v_transaction_event_pricing.getField(\"buyer_charges\").getField(\"pricing_terms\")).otherwise(buyer_charges_pricing_terms)\nseller_charges_pricing_terms = when(is_not_null(f_get_transaction_event_pricing(col(\"log_impbus_impressions_pricing.impression_event_pricing\"), col(\"log_impbus_auction_event.auction_event_pricing\"), col(\"log_impbus_impressions_pricing.buyer_charges\"), col(\"log_impbus_impressions_pricing.seller_charges\"), f_should_process_views(col(\"log_dw_view\"), f_transaction_event_87047, f_transaction_event_87057)).getField(\"seller_charges\").getField(\"pricing_terms\")), v_transaction_event_pricing.getField(\"seller_charges\").getField(\"pricing_terms\")).otherwise(seller_charges_pricing_terms)\nhas_seller_transacted = _f_has_transacted.cast(BooleanType)\nhas_seller_transacted = when(_f_has_transacted.cast(BooleanType) === lit(0), v_transaction_event_pricing.getField(\"seller_transacted\").cast(BooleanType)).otherwise(has_seller_transacted)\nhas_buyer_transacted = _f_has_transacted.cast(BooleanType)\nhas_buyer_transacted = when(_f_has_transacted.cast(BooleanType) === lit(0), coalesce(v_transaction_event_pricing.getField(\"buyer_transacted\").cast(BooleanType), lit(0).cast(BooleanType))).otherwise(has_buyer_transacted)\npayment_type_normalized = when(_f_is_buy_side === lit(1), coalesce(col(\"log_dw_bid.payment_type\").cast(IntegerType), col(\"log_impbus_impressions.payment_type\").cast(IntegerType), lit(999))).otherwise(coalesce(col(\"log_impbus_impressions.payment_type\").cast(IntegerType), lit(999))).cast(IntegerType)\npayment_type_normalized = when((((((((_f_is_buy_side === lit(1)) and is_not_null(col(\"buyer_member_id\").cast(IntegerType))) and is_not_null(col(\"log_dw_bid.member_id\").cast(IntegerType))) and imp_type.isin(lit(6), lit(7))) and (col(\"buyer_member_id\").cast(IntegerType) === col(\"log_dw_bid.member_id\").cast(IntegerType))) and (f_transaction_event_87047 =!= lit(0))) and (f_transaction_event_87057 =!= lit(0))) and (f_transaction_event_87047 =!= f_transaction_event_87057), {\npayment_type_normalized = when(buyer_trx_event_id === lit(1), lit(0)).otherwise(payment_type_normalized).cast(IntegerType)\npayment_type_normalized = when(buyer_trx_event_id.isin(lit(16), lit(15), lit(14), lit(13), lit(9), lit(8), lit(7), lit(6), lit(2), lit(5)), lit(5)).otherwise(payment_type_normalized).cast(IntegerType)\npayment_type_normalized\n}).otherwise(payment_type_normalized).cast(IntegerType)\nrevenue_type_normalized = when(_f_is_buy_side === lit(1), coalesce(col(\"log_dw_bid.revenue_type\").cast(IntegerType), lit(0))).when(is_not_null(col(\"log_dw_bid.payment_type\").cast(IntegerType)) and (col(\"log_dw_bid.payment_type\").cast(IntegerType) === lit(1)), lit(3)).when(is_not_null(col(\"log_dw_bid.payment_type\").cast(IntegerType)) and (col(\"log_dw_bid.payment_type\").cast(IntegerType) === lit(2)), lit(4)).otherwise(lit(0)).cast(IntegerType)\nrevenue_type_normalized = when((((_f_is_buy_side === lit(1)) and is_not_null(col(\"log_dw_bid.log_type\").cast(IntegerType))) and imp_type.isin(lit(6), lit(7))) and (col(\"log_dw_bid.log_type\").cast(IntegerType) === lit(2)), {\nrevenue_type_normalized = when(((seller_trx_event_id =!= lit(0)) and (buyer_trx_event_id =!= lit(0))) and (seller_trx_event_id =!= buyer_trx_event_id), {\nrevenue_type_normalized = when(seller_trx_event_id === lit(1), lit(0)).otherwise(revenue_type_normalized).cast(IntegerType)\nrevenue_type_normalized = when(seller_trx_event_id.isin(lit(16), lit(15), lit(14), lit(13), lit(9), lit(8), lit(7), lit(6), lit(2), lit(5)), lit(9)).otherwise(revenue_type_normalized).cast(IntegerType)\nrevenue_type_normalized\n}).otherwise(revenue_type_normalized).cast(IntegerType)\nrevenue_type_normalized = when((seller_trx_event_id === lit(2)) and (buyer_trx_event_id === lit(2)), lit(9)).otherwise(revenue_type_normalized).cast(IntegerType)\nrevenue_type_normalized\n}).otherwise(revenue_type_normalized).cast(IntegerType)\nbuyer_charges_pricing_terms = f_zero_pricing_term_amount_if_non_cpm(imp_type, payment_type_normalized, revenue_type_normalized, buyer_charges_pricing_terms)\nseller_charges_pricing_terms = f_zero_pricing_term_amount_if_non_cpm(imp_type, payment_type_normalized, revenue_type_normalized, seller_charges_pricing_terms)\nview_detection_enabled = _f_view_detection_enabled.cast(IntegerType)\nview_measurable = f_view_measurable(view_detection_enabled, col(\"log_impbus_view.view_result\").cast(IntegerType)).cast(IntegerType)\nviewable = f_viewable(view_measurable, col(\"log_impbus_view.view_result\").cast(IntegerType)).cast(IntegerType)\nview_non_measurable_reason = f_view_non_measurable_reason(view_detection_enabled, col(\"log_impbus_view.view_result\").cast(IntegerType)).cast(IntegerType)\nviewdef_definition_id = _f_viewdef_definition_id.cast(IntegerType)\nviewdef_viewable = f_viewdef_viewable(viewdef_definition_id, view_measurable, col(\"log_impbus_view.viewdef_view_result\").cast(IntegerType)).cast(IntegerType)\nview_result = f_view_result(view_detection_enabled, col(\"log_impbus_view.view_result\").cast(IntegerType)).cast(IntegerType)\nis_budget_table_imp_type = when(((((col(\"imp_type\").cast(IntegerType) === lit(5)) or (col(\"imp_type\").cast(IntegerType) === lit(7))) or (col(\"imp_type\").cast(IntegerType) === lit(9))) or (col(\"imp_type\").cast(IntegerType) === lit(11))) or (is_not_null(col(\"log_dw_bid_deal\")) and (col(\"imp_type\").cast(IntegerType) === lit(6))), lit(1)).otherwise(is_budget_table_imp_type).cast(IntegerType)\nis_not_roadblock_secondary = when(isnull(col(\"log_dw_bid.impression_transaction_type\")) or (col(\"log_dw_bid.impression_transaction_type\").cast(IntegerType) =!= lit(2)), lit(1)).otherwise(is_not_roadblock_secondary).cast(IntegerType)\nis_external_imp_type = when(col(\"imp_type\").cast(IntegerType) === lit(9), lit(1)).otherwise(is_external_imp_type).cast(IntegerType)\nis_not_video_imp = when(isnull(col(\"log_dw_bid.revenue_event_type_id\")) or (is_not_null(col(\"log_dw_bid.revenue_event_type_id\").cast(IntegerType)) and (col(\"log_dw_bid.revenue_event_type_id\").cast(IntegerType) =!= lit(5))), lit(1)).otherwise(is_not_video_imp).cast(IntegerType)\nimps_for_budget_caps_pacing = (((is_budget_table_imp_type === lit(1)) and ((is_not_roadblock_secondary === lit(1)) or (is_external_imp_type === lit(1)))) and (is_not_video_imp === lit(1))).cast(IntegerType)\ncommission_cpm = coalesce(col(\"log_dw_bid.commission_cpm\"), lit(0)).cast(DoubleType)\ncommission_revshare = coalesce(col(\"log_dw_bid.commission_revshare\"), lit(0)).cast(DoubleType)\nserving_fees_cpm = coalesce(col(\"log_dw_bid.serving_fees_cpm\"), lit(0)).cast(DoubleType)\nserving_fees_revshare = coalesce(col(\"log_dw_bid.serving_fees_revshare\"), lit(0)).cast(DoubleType)\nmedia_buy_cost = when(imp_type === lit(6), when(is_not_null(col(\"log_impbus_impressions.media_buy_cost\")), math_min(col(\"log_impbus_impressions.media_buy_cost\"), lit(999.0))).otherwise(media_buy_cost)).when(is_not_null(col(\"log_dw_bid.media_buy_cost\")), math_min(col(\"log_dw_bid.media_buy_cost\"), lit(999.0))).otherwise(media_buy_cost).cast(DoubleType)\nmedia_buy_rev_share_pct = coalesce(col(\"log_impbus_impressions.media_buy_rev_share_pct\"), lit(0)).cast(DoubleType)\nbooked_revenue_dollars = when(is_not_null(col(\"log_dw_bid.revenue_info.booked_revenue_dollars\")), col(\"log_dw_bid.revenue_info.booked_revenue_dollars\")).otherwise(booked_revenue_dollars).cast(DoubleType)\nbooked_revenue_dollars = when(is_not_null(col(\"log_dw_view.revenue_info.booked_revenue_dollars\")), booked_revenue_dollars + col(\"log_dw_view.revenue_info.booked_revenue_dollars\")).otherwise(booked_revenue_dollars).cast(DoubleType)\nbooked_revenue_adv_curr = when(is_not_null(col(\"log_dw_bid.revenue_info.booked_revenue_adv_curr\")), col(\"log_dw_bid.revenue_info.booked_revenue_adv_curr\")).otherwise(booked_revenue_adv_curr).cast(DoubleType)\nbooked_revenue_adv_curr = when(is_not_null(col(\"log_dw_view.revenue_info.booked_revenue_adv_curr\")), booked_revenue_adv_curr + col(\"log_dw_view.revenue_info.booked_revenue_adv_curr\")).otherwise(booked_revenue_adv_curr).cast(DoubleType)\nv_pricing_term = when(((f_is_non_cpm_payment_or_payment(imp_type, payment_type_normalized, revenue_type_normalized) === lit(0)) or (is_dw_normalized === lit(1))) or (f_should_process_views(col(\"log_dw_view\"), f_transaction_event_87047, f_transaction_event_87057) === lit(1)), f_get_pricing_term(lit(1), buyer_charges_pricing_terms)).otherwise(v_pricing_term)\nauction_service_fees = when(((((f_is_non_cpm_payment_or_payment(imp_type, payment_type_normalized, revenue_type_normalized) === lit(0)) or (is_dw_normalized === lit(1))) or (f_should_process_views(col(\"log_dw_view\"), f_transaction_event_87047, f_transaction_event_87057) === lit(1))) and (is_not_null(f_get_pricing_term(lit(1), buyer_charges_pricing_terms).getField(\"amount\")) and (f_get_pricing_term(lit(1), buyer_charges_pricing_terms).getField(\"amount\") > lit(0)))) and (isnull(f_get_pricing_term(lit(1), buyer_charges_pricing_terms).getField(\"is_deduction\")) or (is_not_null(f_get_pricing_term(lit(1), buyer_charges_pricing_terms).getField(\"is_deduction\")) and (f_get_pricing_term(lit(1), buyer_charges_pricing_terms).getField(\"is_deduction\") === lit(0)))), f_get_pricing_term(lit(1), buyer_charges_pricing_terms).getField(\"amount\") / lit(1000)).otherwise(auction_service_fees).cast(DoubleType)\nv_pricing_term = when(((f_is_non_cpm_payment_or_payment(imp_type, payment_type_normalized, revenue_type_normalized) === lit(0)) or (is_dw_normalized === lit(1))) or (f_should_process_views(col(\"log_dw_view\"), f_transaction_event_87047, f_transaction_event_87057) === lit(1)), f_get_pricing_term(lit(1), buyer_charges_pricing_terms)).otherwise(v_pricing_term)\nauction_service_deduction = when(((((f_is_non_cpm_payment_or_payment(imp_type, payment_type_normalized, revenue_type_normalized) === lit(0)) or (is_dw_normalized === lit(1))) or (f_should_process_views(col(\"log_dw_view\"), f_transaction_event_87047, f_transaction_event_87057) === lit(1))) and (is_not_null(f_get_pricing_term(lit(1), buyer_charges_pricing_terms).getField(\"amount\")) and (f_get_pricing_term(lit(1), buyer_charges_pricing_terms).getField(\"amount\") > lit(0)))) and (is_not_null(f_get_pricing_term(lit(1), buyer_charges_pricing_terms).getField(\"is_deduction\")) and (f_get_pricing_term(lit(1), buyer_charges_pricing_terms).getField(\"is_deduction\") === lit(1))), f_get_pricing_term(lit(1), buyer_charges_pricing_terms).getField(\"amount\") / lit(1000)).otherwise(auction_service_deduction).cast(DoubleType)\nv_pricing_term = when(((f_is_non_cpm_payment_or_payment(imp_type, payment_type_normalized, revenue_type_normalized) === lit(0)) or (is_dw_normalized === lit(1))) or (f_should_process_views(col(\"log_dw_view\"), f_transaction_event_87047, f_transaction_event_87057) === lit(1)), f_get_pricing_term(lit(11), buyer_charges_pricing_terms)).otherwise(v_pricing_term)\ncreative_overage_fees = when(((f_is_non_cpm_payment_or_payment(imp_type, payment_type_normalized, revenue_type_normalized) === lit(0)) or (is_dw_normalized === lit(1))) or (f_should_process_views(col(\"log_dw_view\"), f_transaction_event_87047, f_transaction_event_87057) === lit(1)), when(is_not_null(f_get_pricing_term(lit(11), buyer_charges_pricing_terms).getField(\"amount\")) and (f_get_pricing_term(lit(11), buyer_charges_pricing_terms).getField(\"amount\") > lit(0)), f_get_pricing_term(lit(11), buyer_charges_pricing_terms).getField(\"amount\") / lit(1000)).otherwise(creative_overage_fees)).otherwise(creative_overage_fees).cast(DoubleType)\nv_pricing_term = when(((f_is_non_cpm_payment_or_payment(imp_type, payment_type_normalized, revenue_type_normalized) === lit(0)) or (is_dw_normalized === lit(1))) or (f_should_process_views(col(\"log_dw_view\"), f_transaction_event_87047, f_transaction_event_87057) === lit(1)), f_get_pricing_term(lit(51), buyer_charges_pricing_terms)).otherwise(v_pricing_term)\ndiscrepancy_allowance = when(((f_is_non_cpm_payment_or_payment(imp_type, payment_type_normalized, revenue_type_normalized) === lit(0)) or (is_dw_normalized === lit(1))) or (f_should_process_views(col(\"log_dw_view\"), f_transaction_event_87047, f_transaction_event_87057) === lit(1)), when(is_not_null(f_get_pricing_term(lit(51), buyer_charges_pricing_terms).getField(\"amount\")) and (f_get_pricing_term(lit(51), buyer_charges_pricing_terms).getField(\"amount\") > lit(0)), f_get_pricing_term(lit(51), buyer_charges_pricing_terms).getField(\"amount\") / lit(1000)).otherwise(discrepancy_allowance)).otherwise(discrepancy_allowance).cast(DoubleType)\nbuyer_spend_microcents = when(isnull(col(\"log_dw_bid.payment_type\")) or ((is_not_null(col(\"log_dw_bid.payment_type\").cast(IntegerType)) and (col(\"log_dw_bid.payment_type\").cast(IntegerType) =!= lit(1))) and (col(\"log_dw_bid.payment_type\").cast(IntegerType) =!= lit(2))), coalesce(v_transaction_event_pricing.getField(\"gross_payment_value_microcents\"), lit(0))).otherwise(buyer_spend_microcents).cast(DoubleType)\nseller_revenue_microcents = when(isnull(col(\"log_dw_bid.payment_type\")) or ((is_not_null(col(\"log_dw_bid.payment_type\").cast(IntegerType)) and (col(\"log_dw_bid.payment_type\").cast(IntegerType) =!= lit(1))) and (col(\"log_dw_bid.payment_type\").cast(IntegerType) =!= lit(2))), coalesce(v_transaction_event_pricing.getField(\"seller_revenue_microcents\"), lit(0))).otherwise(seller_revenue_microcents).cast(DoubleType)\nbuyer_spend_cpm = (buyer_spend_microcents / lit(100000)).cast(DoubleType)\nseller_revenue_cpm = (seller_revenue_microcents / lit(100000)).cast(DoubleType)\nmedia_cost_dollars_cpm = f_get_media_cost_dollars_cpm(imp_type, payment_type_normalized, revenue_type_normalized, media_buy_cost, media_buy_rev_share_pct, seller_revenue_cpm, buyer_spend_cpm, booked_revenue_dollars, commission_cpm, commission_revshare, serving_fees_cpm, serving_fees_revshare, col(\"log_impbus_impressions.apply_cost_on_default\").cast(IntegerType), lit(0.0).cast(DoubleType)).cast(DoubleType)\nseller_deduction_term_id_1 = when(((f_is_non_cpm_payment_or_payment(imp_type, payment_type_normalized, revenue_type_normalized) === lit(0)) and is_not_null(f_get_pricing_term(lit(1), seller_charges_pricing_terms).getField(\"amount\"))) and (is_not_null(f_get_pricing_term(lit(1), seller_charges_pricing_terms).getField(\"is_deduction\")) and (f_get_pricing_term(lit(1), seller_charges_pricing_terms).getField(\"is_deduction\") === lit(1))), f_get_pricing_term(lit(1), seller_charges_pricing_terms).getField(\"amount\") / lit(1000)).otherwise(seller_deduction_term_id_1).cast(DoubleType)\nseller_deduction_term_id_74 = when(((f_is_non_cpm_payment_or_payment(imp_type, payment_type_normalized, revenue_type_normalized) === lit(0)) and is_not_null(f_get_pricing_term(lit(74), seller_charges_pricing_terms).getField(\"amount\"))) and (is_not_null(f_get_pricing_term(lit(74), seller_charges_pricing_terms).getField(\"is_deduction\")) and (f_get_pricing_term(lit(74), seller_charges_pricing_terms).getField(\"is_deduction\") === lit(1))), f_get_pricing_term(lit(74), seller_charges_pricing_terms).getField(\"amount\") / lit(1000)).otherwise(seller_deduction_term_id_74).cast(DoubleType)\nseller_deduction = when(f_is_non_cpm_payment_or_payment(imp_type, payment_type_normalized, revenue_type_normalized) === lit(0), math_max(seller_deduction_term_id_1 + seller_deduction_term_id_74, lit(0))).otherwise(seller_deduction).cast(DoubleType)\ndeal_type = f_preempt_over_impression_88439.cast(IntegerType)\ndeal_id = when(is_not_null(col(\"log_impbus_preempt.deal_id\").cast(IntegerType)) and (col(\"log_impbus_preempt.deal_id\").cast(IntegerType) > lit(0)), col(\"log_impbus_preempt.deal_id\").cast(IntegerType)).otherwise(deal_id).cast(IntegerType)\nis_curated = when(is_not_null(col(\"log_impbus_preempt.curated_deal_id\").cast(IntegerType)) and (col(\"log_impbus_preempt.curated_deal_id\").cast(IntegerType) > lit(0)), lit(1)).otherwise(is_curated).cast(IntegerType)\ncurator_member_id = when(is_not_null(col(\"log_impbus_preempt.curated_deal_id\").cast(IntegerType)) and (col(\"log_impbus_preempt.curated_deal_id\").cast(IntegerType) > lit(0)), when(is_not_null(sup_common_deal_lookup), sup_common_deal_lookup.getField(\"member_id\")).otherwise(curator_member_id)).otherwise(curator_member_id).cast(IntegerType)\ndeal_id = when(((is_not_null(col(\"log_impbus_preempt.curated_deal_id\").cast(IntegerType)) and (col(\"log_impbus_preempt.curated_deal_id\").cast(IntegerType) > lit(0))) and ((imp_type === lit(7)) or ((is_dw_normalized === lit(1)) and (imp_type === lit(6))))) and (imp_type === lit(7)), col(\"log_impbus_preempt.curated_deal_id\").cast(IntegerType)).otherwise(deal_id).cast(IntegerType)\ndeal_type = when(((is_not_null(col(\"log_impbus_preempt.curated_deal_id\").cast(IntegerType)) and (col(\"log_impbus_preempt.curated_deal_id\").cast(IntegerType) > lit(0))) and ((imp_type === lit(7)) or ((is_dw_normalized === lit(1)) and (imp_type === lit(6))))) and (imp_type === lit(7)), lit(5)).otherwise(deal_type).cast(IntegerType)\nbuyer_charges_pricing_terms = when(is_not_null(buyer_charges_pricing_terms), f_convert_pricing_term_amount(buyer_charges_pricing_terms, lit(1000.0))).otherwise(buyer_charges_pricing_terms)\nseller_charges_pricing_terms = when(is_not_null(seller_charges_pricing_terms), f_convert_pricing_term_amount(seller_charges_pricing_terms, lit(1000.0))).otherwise(seller_charges_pricing_terms)\ncreative_id = when(((isnull(col(\"log_dw_bid\")) or (imp_type === lit(3))) or (imp_type === lit(4))) or (is_not_null(col(\"log_dw_bid.creative_id\").cast(IntegerType)) and (col(\"log_dw_bid.creative_id\").cast(IntegerType) === lit(0))), f_preempt_over_impression_88639).otherwise(col(\"log_dw_bid.creative_id\").cast(IntegerType)).cast(IntegerType)\nadvertiser_id = col(\"advertiser_id\").cast(IntegerType)\ncampaign_group_id = col(\"campaign_group_id\").cast(IntegerType)\ninsertion_order_id = col(\"insertion_order_id\").cast(IntegerType)\ncampaign_id = col(\"campaign_id\").cast(IntegerType)\ncampaign_id = when(is_not_null(col(\"log_dw_bid.campaign_id\").cast(IntegerType)) and (col(\"log_dw_bid.campaign_id\").cast(IntegerType) =!= lit(0)), col(\"log_dw_bid.campaign_id\").cast(IntegerType)).otherwise(campaign_id).cast(IntegerType)\nmember_sales_tax_rate_pct = when(is_not_null(col(\"log_dw_bid.data_costs\")), coalesce(sup_bidder_member_sales_tax_rate_lookup.getField(\"sales_tax_rate_pct\"), lit(0))).otherwise(member_sales_tax_rate_pct).cast(DoubleType)\ndata_costs = when(is_not_null(col(\"log_dw_bid.data_costs\")), {\ndata_costs = col(\"log_dw_bid.data_costs\")\ndata_costs = f_update_data_costs(col(\"log_dw_bid.data_costs\"), imp_type, lit(0), payment_type_normalized, media_cost_dollars_cpm, coalesce(sup_bidder_member_sales_tax_rate_lookup.getField(\"sales_tax_rate_pct\"), lit(0)))\ndata_costs\n}).otherwise(data_costs)\ndata_costs_deal = when(f_transaction_event_87057 === lit(1), when(is_not_null(col(\"log_dw_bid_deal.data_costs\")), {\ndata_costs_deal = col(\"log_dw_bid_deal.data_costs\")\ndata_costs_deal = f_update_data_costs_deal(col(\"log_dw_bid_deal.data_costs\"), coalesce(sup_bidder_member_sales_tax_rate_lookup_2.getField(\"sales_tax_rate_pct\"), lit(0)))\ndata_costs_deal\n}).otherwise(data_costs_deal)).otherwise(data_costs_deal)\nmedia_buy_cost = when(_f_is_buy_side === lit(0), when(isnull(col(\"log_dw_bid\")) and ((f_is_error_imp(imp_type) === lit(1)) or ((is_not_null(col(\"is_dw\").cast(IntegerType)) and (col(\"is_dw\").cast(IntegerType) === lit(1))) and imp_type.isin(lit(2), lit(4)))), lit(0)).otherwise(media_buy_cost)).otherwise(media_buy_cost).cast(DoubleType)\nis_placeholder_bid = when(_f_is_buy_side === lit(0), when(isnull(col(\"log_dw_bid\")) and ((f_is_error_imp(imp_type) === lit(1)) or ((is_not_null(col(\"is_dw\").cast(IntegerType)) and (col(\"is_dw\").cast(IntegerType) === lit(1))) and imp_type.isin(lit(2), lit(4)))), lit(1)).otherwise(is_placeholder_bid)).otherwise(is_placeholder_bid).cast(IntegerType)\nadvertiser_id = when(_f_is_buy_side === lit(0), when(isnull(col(\"log_dw_bid\")) and ((f_is_error_imp(imp_type) === lit(1)) or ((is_not_null(col(\"is_dw\").cast(IntegerType)) and (col(\"is_dw\").cast(IntegerType) === lit(1))) and imp_type.isin(lit(2), lit(4)))), lit(null).cast(IntegerType)).when(f_is_default_or_error_imp(imp_type) === lit(1), {\nadvertiser_id = when(f_is_default_or_error_imp(imp_type) === lit(1), lit(null).cast(IntegerType)).otherwise(advertiser_id).cast(IntegerType)\nadvertiser_id = when(f_is_error_imp(imp_type) === lit(1), lit(null).cast(IntegerType)).otherwise(advertiser_id).cast(IntegerType)\nadvertiser_id\n}).when(!imp_type.isin(lit(5), lit(9), lit(2)), lit(null).cast(IntegerType)).otherwise(advertiser_id)).otherwise(advertiser_id).cast(IntegerType)\nserving_fees_revshare = when(_f_is_buy_side === lit(0), when(((!(isnull(col(\"log_dw_bid\")) and ((f_is_error_imp(imp_type) === lit(1)) or ((is_not_null(col(\"is_dw\").cast(IntegerType)) and (col(\"is_dw\").cast(IntegerType) === lit(1))) and imp_type.isin(lit(2), lit(4)))))) and (!(f_is_default_or_error_imp(imp_type) === lit(1)))) and (!imp_type.isin(lit(5), lit(9), lit(2))), lit(null).cast(DoubleType)).otherwise(serving_fees_revshare)).otherwise(serving_fees_revshare).cast(DoubleType)\nsplit_id = when(_f_is_buy_side === lit(0), when(((!(isnull(col(\"log_dw_bid\")) and ((f_is_error_imp(imp_type) === lit(1)) or ((is_not_null(col(\"is_dw\").cast(IntegerType)) and (col(\"is_dw\").cast(IntegerType) === lit(1))) and imp_type.isin(lit(2), lit(4)))))) and (!(f_is_default_or_error_imp(imp_type) === lit(1)))) and (!imp_type.isin(lit(5), lit(9), lit(2))), lit(0)).otherwise(split_id)).otherwise(split_id).cast(IntegerType)\nbooked_revenue_dollars = when(_f_is_buy_side === lit(0), when(((!(isnull(col(\"log_dw_bid\")) and ((f_is_error_imp(imp_type) === lit(1)) or ((is_not_null(col(\"is_dw\").cast(IntegerType)) and (col(\"is_dw\").cast(IntegerType) === lit(1))) and imp_type.isin(lit(2), lit(4)))))) and (!(f_is_default_or_error_imp(imp_type) === lit(1)))) and (!imp_type.isin(lit(5), lit(9), lit(2))), lit(0)).otherwise(booked_revenue_dollars)).otherwise(booked_revenue_dollars).cast(DoubleType)\nserving_fees_cpm = when(_f_is_buy_side === lit(0), when(((!(isnull(col(\"log_dw_bid\")) and ((f_is_error_imp(imp_type) === lit(1)) or ((is_not_null(col(\"is_dw\").cast(IntegerType)) and (col(\"is_dw\").cast(IntegerType) === lit(1))) and imp_type.isin(lit(2), lit(4)))))) and (!(f_is_default_or_error_imp(imp_type) === lit(1)))) and (!imp_type.isin(lit(5), lit(9), lit(2))), lit(null).cast(DoubleType)).otherwise(serving_fees_cpm)).otherwise(serving_fees_cpm).cast(DoubleType)\ninsertion_order_id = when(_f_is_buy_side === lit(0), when(((!(isnull(col(\"log_dw_bid\")) and ((f_is_error_imp(imp_type) === lit(1)) or ((is_not_null(col(\"is_dw\").cast(IntegerType)) and (col(\"is_dw\").cast(IntegerType) === lit(1))) and imp_type.isin(lit(2), lit(4)))))) and (!(f_is_default_or_error_imp(imp_type) === lit(1)))) and (!imp_type.isin(lit(5), lit(9), lit(2))), lit(null).cast(IntegerType)).otherwise(insertion_order_id)).otherwise(insertion_order_id).cast(IntegerType)\ncampaign_group_id = when(_f_is_buy_side === lit(0), when(isnull(col(\"log_dw_bid\")) and ((f_is_error_imp(imp_type) === lit(1)) or ((is_not_null(col(\"is_dw\").cast(IntegerType)) and (col(\"is_dw\").cast(IntegerType) === lit(1))) and imp_type.isin(lit(2), lit(4)))), lit(null).cast(IntegerType)).when(f_is_default_or_error_imp(imp_type) === lit(1), {\ncampaign_group_id = when(f_is_default_or_error_imp(imp_type) === lit(1), lit(null).cast(IntegerType)).otherwise(campaign_group_id).cast(IntegerType)\ncampaign_group_id = when(f_is_error_imp(imp_type) === lit(1), lit(null).cast(IntegerType)).otherwise(campaign_group_id).cast(IntegerType)\ncampaign_group_id\n}).when(!imp_type.isin(lit(5), lit(9), lit(2)), lit(null).cast(IntegerType)).otherwise(campaign_group_id)).otherwise(campaign_group_id).cast(IntegerType)\ncommission_cpm = when(_f_is_buy_side === lit(0), when(((!(isnull(col(\"log_dw_bid\")) and ((f_is_error_imp(imp_type) === lit(1)) or ((is_not_null(col(\"is_dw\").cast(IntegerType)) and (col(\"is_dw\").cast(IntegerType) === lit(1))) and imp_type.isin(lit(2), lit(4)))))) and (!(f_is_default_or_error_imp(imp_type) === lit(1)))) and (!imp_type.isin(lit(5), lit(9), lit(2))), lit(0)).otherwise(commission_cpm)).otherwise(commission_cpm).cast(DoubleType)\ncommission_revshare = when(_f_is_buy_side === lit(0), when(((!(isnull(col(\"log_dw_bid\")) and ((f_is_error_imp(imp_type) === lit(1)) or ((is_not_null(col(\"is_dw\").cast(IntegerType)) and (col(\"is_dw\").cast(IntegerType) === lit(1))) and imp_type.isin(lit(2), lit(4)))))) and (!(f_is_default_or_error_imp(imp_type) === lit(1)))) and (!imp_type.isin(lit(5), lit(9), lit(2))), lit(null).cast(DoubleType)).otherwise(commission_revshare)).otherwise(commission_revshare).cast(DoubleType)\ncampaign_id = when(_f_is_buy_side === lit(0), when(((!(isnull(col(\"log_dw_bid\")) and ((f_is_error_imp(imp_type) === lit(1)) or ((is_not_null(col(\"is_dw\").cast(IntegerType)) and (col(\"is_dw\").cast(IntegerType) === lit(1))) and imp_type.isin(lit(2), lit(4)))))) and (!(f_is_default_or_error_imp(imp_type) === lit(1)))) and (!imp_type.isin(lit(5), lit(9), lit(2))), lit(null).cast(IntegerType)).otherwise(campaign_id)).otherwise(campaign_id).cast(IntegerType)\nrevenue_value = when(_f_is_buy_side === lit(0), when(((!(isnull(col(\"log_dw_bid\")) and ((f_is_error_imp(imp_type) === lit(1)) or ((is_not_null(col(\"is_dw\").cast(IntegerType)) and (col(\"is_dw\").cast(IntegerType) === lit(1))) and imp_type.isin(lit(2), lit(4)))))) and (!(f_is_default_or_error_imp(imp_type) === lit(1)))) and (!imp_type.isin(lit(5), lit(9), lit(2))), lit(0)).otherwise(revenue_value)).otherwise(revenue_value).cast(DoubleType)\nvirtual_log_dw_bid = f_create_agg_dw_impressions_virtual_log_dw_bid_10949800(virtual_log_dw_bid, _f_is_buy_side, col(\"log_dw_bid\"), f_is_error_imp(imp_type), col(\"is_dw\").cast(IntegerType), imp_type, f_is_default_or_error_imp(imp_type), col(\"log_impbus_impressions.payment_type\"), seller_trx_event_id)\nbooked_revenue_adv_curr = when(_f_is_buy_side === lit(0), when(((!(isnull(col(\"log_dw_bid\")) and ((f_is_error_imp(imp_type) === lit(1)) or ((is_not_null(col(\"is_dw\").cast(IntegerType)) and (col(\"is_dw\").cast(IntegerType) === lit(1))) and imp_type.isin(lit(2), lit(4)))))) and (!(f_is_default_or_error_imp(imp_type) === lit(1)))) and (!imp_type.isin(lit(5), lit(9), lit(2))), lit(0)).otherwise(booked_revenue_adv_curr)).otherwise(booked_revenue_adv_curr).cast(DoubleType)\ncampaign_id = when(is_not_null(col(\"log_dw_bid_deal\")), col(\"campaign_id\").cast(IntegerType)).otherwise(campaign_id).cast(IntegerType)\nadvertiser_id = when(is_not_null(col(\"log_dw_bid_deal\")), {\nadvertiser_id = col(\"advertiser_id\").cast(IntegerType)\nadvertiser_id = when(imp_type === lit(6), when(is_not_null(col(\"log_dw_bid_deal.advertiser_id\").cast(IntegerType)) and (col(\"log_dw_bid_deal.advertiser_id\").cast(IntegerType) =!= lit(0)), col(\"log_dw_bid_deal.advertiser_id\").cast(IntegerType)).otherwise(advertiser_id)).otherwise(advertiser_id).cast(IntegerType)\nadvertiser_id\n}).otherwise(advertiser_id).cast(IntegerType)\ncampaign_group_id = when(is_not_null(col(\"log_dw_bid_deal\")), {\ncampaign_group_id = col(\"campaign_group_id\").cast(IntegerType)\ncampaign_group_id = when(imp_type === lit(6), when(is_not_null(col(\"log_dw_bid_deal.campaign_group_id\").cast(IntegerType)) and (col(\"log_dw_bid_deal.campaign_group_id\").cast(IntegerType) =!= lit(0)), col(\"log_dw_bid_deal.campaign_group_id\").cast(IntegerType)).otherwise(campaign_group_id)).otherwise(campaign_group_id).cast(IntegerType)\ncampaign_group_id\n}).otherwise(campaign_group_id).cast(IntegerType)\ninsertion_order_id = when(is_not_null(col(\"log_dw_bid_deal\")), {\ninsertion_order_id = col(\"insertion_order_id\").cast(IntegerType)\ninsertion_order_id = when(imp_type === lit(6), when(is_not_null(col(\"log_dw_bid_deal.insertion_order_id\").cast(IntegerType)) and (col(\"log_dw_bid_deal.insertion_order_id\").cast(IntegerType) =!= lit(0)), col(\"log_dw_bid_deal.insertion_order_id\").cast(IntegerType)).otherwise(insertion_order_id)).otherwise(insertion_order_id).cast(IntegerType)\ninsertion_order_id\n}).otherwise(insertion_order_id).cast(IntegerType)\nflight_id = when((is_not_null(col(\"log_dw_bid_deal\")) and (imp_type === lit(6))) and (is_not_null(col(\"log_dw_bid_deal.campaign_group_budget_interval_id\").cast(IntegerType)) and (col(\"log_dw_bid_deal.campaign_group_budget_interval_id\").cast(IntegerType) =!= lit(0))), col(\"log_dw_bid_deal.campaign_group_budget_interval_id\").cast(IntegerType)).otherwise(flight_id).cast(IntegerType)\nbilling_period_id = when((is_not_null(col(\"log_dw_bid_deal\")) and (imp_type === lit(6))) and (is_not_null(col(\"log_dw_bid_deal.insertion_order_budget_interval_id\").cast(IntegerType)) and (col(\"log_dw_bid_deal.insertion_order_budget_interval_id\").cast(IntegerType) =!= lit(0))), col(\"log_dw_bid_deal.insertion_order_budget_interval_id\").cast(IntegerType)).otherwise(billing_period_id).cast(IntegerType)\nshould_zero_seller_revenue = f_should_zero_seller_revenue(col(\"log_dw_bid\"), col(\"imp_type\").cast(IntegerType), revenue_type_normalized, col(\"seller_member_id\").cast(IntegerType), col(\"log_impbus_impressions_pricing.impression_event_pricing.seller_revenue_microcents\").cast(LongType)).cast(BooleanType)\nf_create_agg_dw_impressions_return_11108229(curator_member_id, discrepancy_allowance, should_process_views, buyer_member_id, imps_for_budget_caps_pacing, imp_type, is_curated, view_detection_enabled, buyer_trx_event_type_id, commission_revshare, creative_overage_fees, viewdef_definition_id, virtual_log_dw_bid, has_buyer_transacted, payment_type_normalized, seller_trx_event_id, seller_revenue_cpm, insertion_order_id, revenue_type_normalized, billing_period_id, viewdef_viewable, split_id, data_costs_deal, seller_charges_pricing_terms, f_preempt_over_impression_94298, commission_cpm, v_transaction_event_pricing, buyer_trx_event_id, campaign_group_id, has_seller_transacted, buyer_charges_pricing_terms, revenue_value, campaign_group_type_id, should_zero_seller_revenue, view_measurable, advertiser_id, media_cost_dollars_cpm, creative_id, f_preempt_over_impression_95337, flight_id, viewable, auction_service_deduction, media_buy_cost, seller_deduction, buyer_spend_cpm, seller_trx_event_type_id, auction_service_fees, serving_fees_cpm, data_costs, sup_ip_range_lookup_count, ttl, view_result, is_dw_normalized, booked_revenue_adv_curr, booked_revenue_dollars, deal_id, _f_is_buy_side, deal_type, campaign_id, is_placeholder_bid, serving_fees_revshare, view_non_measurable_reason)","language":"scala","description":""}