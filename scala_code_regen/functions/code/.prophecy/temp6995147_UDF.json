{"initCode":"","code":"udf((_id_type: String, _pi_list: Seq[Row], _i: Integer, _l_id_type: Integer) => {\n  var pi = Row(convertToInt(0), null)\nvar l_id_type = _l_id_type\nvar id_type = _id_type\nvar i = _i\nvar pi_list = (_pi_list).toArray\n\nwhile(compareTo(i, pi_list.length) < 0) {\nl_id_type = 0\nif(!_isnull(pi_list(convertToInt(i)).getAs[Integer](\"identity_type\"))){\nl_id_type = convertToInt(pi_list(convertToInt(i)).getAs[Integer](\"identity_type\"))\n}\nif(l_id_type.toString == id_type){\npi = pi_list(convertToInt(i))\n}\ni = i + convertToInt(1)\n}\n\nRow(if (!_isnull(pi)) {\n Row(convertToInt(pi.get(0)), (pi.get(1)).toString)\n} else {\n null\n}, convertToInt(l_id_type), convertToInt(i))\n},  StructType(\n      List(\n      StructField(\"pi\",  StructType(\n      List(\n      StructField(\"identity_type\", IntegerType, false),StructField(\"identity_value\", StringType, true)\n      )\n    ), false),StructField(\"l_id_type\", IntegerType, false),StructField(\"i\", IntegerType, false)\n      )\n    ))"}