{"initCode":"","code":"\nudf({ (_virtual_log_dw_bid: Row, _f_is_buy_side: Int, log_dw_bid: Row, f_is_error_imp: Int, is_dw: Int, imp_type: Int, f_is_default_or_error_imp: Int, log_impbus_impressions_payment_type: Int, seller_trx_event_id: Int) =>\n  var virtual_log_dw_bid = _virtual_log_dw_bid\n  if (_f_is_buy_side == 0) {\n    if (log_dw_bid == null && (f_is_error_imp == 1 || is_dw == 1 && (imp_type == 2 || imp_type == 4))) {\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 1, 1)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 0, 1)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 48, 1)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 59, \"--\")\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 46, \"\\\\\\\\N\")\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 62, 0)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 10, -2)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 11, -2)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 51, -2)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 52, -2)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 8, -2)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 9, -2)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 53, -2)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 54, -2)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 18, \"---\")\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 24, \"USD\")\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 25, 1)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 55, \"u\")\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 23, 1)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 20, 2)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 27, -1)\n      virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 28, -1)\n    } else {\n      if (f_is_default_or_error_imp == 1) {\n        if (log_dw_bid != null) virtual_log_dw_bid = log_dw_bid\n        if (f_is_default_or_error_imp == 1) {\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 10, -2)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 11, -2)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 51, -2)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 52, -2)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 8, -2)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 9, -2)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 53, -2)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 54, -2)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 4, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 6, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 5, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 7, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 23, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 12, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 72, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 73, 0)\n        }\n        if (f_is_error_imp == 1) {\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 24, \"USD\")\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 25, 1.0d)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 55, \"u\")\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 56, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 19, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 20, 2)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 21, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 22, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 27, -1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 28, -1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 18, \"---\")\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 7, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 26, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 43, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 16, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 23, 1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 31, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 32, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 14, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 17, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 2, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 33, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 34, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 29, 0)\n        }\n      } else {\n        if (imp_type == 9 || imp_type == 2 || imp_type == 5) {\n          virtual_log_dw_bid = log_dw_bid\n        } else {\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 1, 1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 0, 1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 48, 1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 10, -1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 11, -1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 51, -1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 52, -1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 8, -1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 9, -1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 53, -1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 54, -1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 57, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 58, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 59, \"---\")\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 24, \"USD\")\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 25, 1)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 18, \"---\")\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 66, 2)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 41, 0)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 37, log_impbus_impressions_payment_type)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 62, seller_trx_event_id)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 28, -2)\n          virtual_log_dw_bid = updateIndexInRow(virtual_log_dw_bid, 27, -2)\n        }\n      }\n    }\n  }\n  virtual_log_dw_bid\n}, StructType(Array(StructField(\"date_time\", LongType, true), StructField(\"auction_id_64\", LongType, true), StructField(\"price\", DoubleType, true), StructField(\"member_id\", IntegerType, true), StructField(\"advertiser_id\", IntegerType, true), StructField(\"campaign_group_id\", IntegerType, true), StructField(\"campaign_id\", IntegerType, true), StructField(\"creative_id\", IntegerType, true), StructField(\"creative_freq\", IntegerType, true), StructField(\"creative_rec\", IntegerType, true), StructField(\"advertiser_freq\", IntegerType, true), StructField(\"advertiser_rec\", IntegerType, true), StructField(\"is_remarketing\", IntegerType, true), StructField(\"user_group_id\", IntegerType, true), StructField(\"media_buy_cost\", DoubleType, true), StructField(\"is_default\", IntegerType, true), StructField(\"pub_rule_id\", IntegerType, true), StructField(\"media_buy_rev_share_pct\", DoubleType, true), StructField(\"pricing_type\", StringType, true), StructField(\"can_convert\", IntegerType, true), StructField(\"is_control\", IntegerType, true), StructField(\"control_pct\", DoubleType, true), StructField(\"control_creative_id\", IntegerType, true), StructField(\"cadence_modifier\", DoubleType, true), StructField(\"advertiser_currency\", StringType, true), StructField(\"advertiser_exchange_rate\", DoubleType, true), StructField(\"insertion_order_id\", IntegerType, true), StructField(\"predict_type\", IntegerType, true), StructField(\"predict_type_goal\", IntegerType, true), StructField(\"revenue_value_dollars\", DoubleType, true), StructField(\"revenue_value_adv_curr\", DoubleType, true), StructField(\"commission_cpm\", DoubleType, true), StructField(\"commission_revshare\", DoubleType, true), StructField(\"serving_fees_cpm\", DoubleType, true), StructField(\"serving_fees_revshare\", DoubleType, true), StructField(\"publisher_currency\", StringType, true), StructField(\"publisher_exchange_rate\", DoubleType, true), StructField(\"payment_type\", IntegerType, true), StructField(\"payment_value\", DoubleType, true), StructField(\"creative_group_freq\", IntegerType, true), StructField(\"creative_group_rec\", IntegerType, true), StructField(\"revenue_type\", IntegerType, true), StructField(\"apply_cost_on_default\", IntegerType, true), StructField(\"instance_id\", IntegerType, true), StructField(\"vp_expose_age\", IntegerType, true), StructField(\"vp_expose_gender\", IntegerType, true), StructField(\"targeted_segments\", StringType, true), StructField(\"ttl\", IntegerType, true), StructField(\"auction_timestamp\", LongType, true), StructField(\"data_costs\", ArrayType(StructType(Array(StructField(\"data_member_id\", IntegerType, true), StructField(\"cost\", DoubleType, true), StructField(\"used_segments\", ArrayType(IntegerType, true), true), StructField(\"cost_pct\", DoubleType, true))), true), true), StructField(\"targeted_segment_list\", ArrayType(IntegerType, true), true), StructField(\"campaign_group_freq\", IntegerType, true), StructField(\"campaign_group_rec\", IntegerType, true), StructField(\"insertion_order_freq\", IntegerType, true), StructField(\"insertion_order_rec\", IntegerType, true), StructField(\"buyer_gender\", StringType, true), StructField(\"buyer_age\", IntegerType, true), StructField(\"custom_model_id\", IntegerType, true), StructField(\"custom_model_last_modified\", LongType, true), StructField(\"custom_model_output_code\", StringType, true), StructField(\"bid_priority\", IntegerType, true), StructField(\"explore_disposition\", IntegerType, true), StructField(\"revenue_auction_event_type\", IntegerType, true), StructField(\"campaign_group_models\", ArrayType(StructType(Array(StructField(\"model_type\", IntegerType, true), StructField(\"model_id\", IntegerType, true), StructField(\"leaf_code\", StringType, true), StructField(\"origin\", IntegerType, true), StructField(\"experiment\", IntegerType, true), StructField(\"value\", DoubleType, true))), true), true), StructField(\"impression_transaction_type\", IntegerType, true), StructField(\"is_deferred\", IntegerType, true), StructField(\"log_type\", IntegerType, true), StructField(\"crossdevice_group_anon\", StructType(Array(StructField(\"graph_id\", IntegerType, true), StructField(\"group_id\", BinaryType, true))), true), StructField(\"fx_rate_snapshot_id\", IntegerType, true), StructField(\"crossdevice_graph_cost\", StructType(Array(StructField(\"graph_provider_member_id\", IntegerType, true), StructField(\"cost_cpm_usd\", DoubleType, true))), true), StructField(\"revenue_event_type_id\", IntegerType, true), StructField(\"targeted_segment_details\", ArrayType(StructType(Array(StructField(\"segment_id\", IntegerType, true), StructField(\"last_seen_min\", IntegerType, true))), true), true), StructField(\"insertion_order_budget_interval_id\", IntegerType, true), StructField(\"campaign_group_budget_interval_id\", IntegerType, true), StructField(\"cold_start_price_type\", IntegerType, true), StructField(\"discovery_state\", IntegerType, true), StructField(\"revenue_info\", StructType(Array(StructField(\"total_partner_fees_microcents\", LongType, true), StructField(\"booked_revenue_dollars\", DoubleType, true), StructField(\"booked_revenue_adv_curr\", DoubleType, true), StructField(\"total_data_costs_microcents\", LongType, true), StructField(\"total_profit_microcents\", LongType, true), StructField(\"total_segment_data_costs_microcents\", LongType, true), StructField(\"total_feature_costs_microcents\", LongType, true))), true), StructField(\"use_revenue_info\", BooleanType, true), StructField(\"sales_tax_rate_pct\", DoubleType, true), StructField(\"targeted_crossdevice_graph_id\", IntegerType, true), StructField(\"product_feed_id\", IntegerType, true), StructField(\"item_selection_strategy_id\", IntegerType, true), StructField(\"discovery_prediction\", DoubleType, true), StructField(\"bidding_host_id\", IntegerType, true), StructField(\"split_id\", IntegerType, true), StructField(\"excluded_targeted_segment_details\", ArrayType(StructType(Array(StructField(\"segment_id\", IntegerType, true))), true), true), StructField(\"predicted_kpi_event_rate\", DoubleType, true), StructField(\"has_crossdevice_reach_extension\", BooleanType, true), StructField(\"advertiser_expected_value_ecpm_ac\", DoubleType, true), StructField(\"bpp_multiplier\", DoubleType, true), StructField(\"bpp_offset\", DoubleType, true), StructField(\"bid_modifier\", DoubleType, true), StructField(\"payment_value_microcents\", LongType, true), StructField(\"crossdevice_graph_membership\", ArrayType(StructType(Array(StructField(\"graph_id\", IntegerType, true), StructField(\"group_id\", BinaryType, true))), true), true), StructField(\"valuation_landscape\", ArrayType(StructType(Array(StructField(\"kpi_event_id\", IntegerType, true), StructField(\"ev_kpi_event_ac\", DoubleType, true), StructField(\"p_kpi_event\", DoubleType, true), StructField(\"bpo_aggressiveness_factor\", DoubleType, true), StructField(\"min_margin_pct\", DoubleType, true), StructField(\"max_revenue_or_bid_value\", DoubleType, true), StructField(\"min_revenue_or_bid_value\", DoubleType, true), StructField(\"cold_start_price_ac\", DoubleType, true), StructField(\"dynamic_bid_max_revenue_ac\", DoubleType, true), StructField(\"p_revenue_event\", DoubleType, true), StructField(\"total_fees_deducted_ac\", DoubleType, true))), true), true), StructField(\"line_item_currency\", StringType, true), StructField(\"measurement_fee_cpm_usd\", DoubleType, true), StructField(\"measurement_provider_id\", IntegerType, true), StructField(\"measurement_provider_member_id\", IntegerType, true), StructField(\"offline_attribution_provider_member_id\", IntegerType, true), StructField(\"offline_attribution_cost_usd_cpm\", DoubleType, true), StructField(\"targeted_segment_details_by_id_type\", ArrayType(StructType(Array(StructField(\"identity_type\", IntegerType, true), StructField(\"targeted_segment_details\", ArrayType(StructType(Array(StructField(\"segment_id\", IntegerType, true), StructField(\"last_seen_min\", IntegerType, true))), true), true))), true), true), StructField(\"offline_attribution\", ArrayType(StructType(Array(StructField(\"provider_member_id\", IntegerType, true), StructField(\"cost_usd_cpm\", DoubleType, true))), true), true), StructField(\"frequency_cap_type_internal\", IntegerType, true), StructField(\"modeled_cap_did_override_line_item_daily_cap\", BooleanType, true), StructField(\"modeled_cap_user_sample_rate\", DoubleType, true), StructField(\"bid_rate\", DoubleType, true), StructField(\"district_postal_code_lists\", ArrayType(IntegerType, true), true), StructField(\"pre_bpp_price\", DoubleType, true), StructField(\"feature_tests_bitmap\", IntegerType, true))))\n"}