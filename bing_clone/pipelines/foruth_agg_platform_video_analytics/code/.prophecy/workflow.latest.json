{
  "metainfo" : {
    "migrationVersions" : {
      "gemBuilderVersion" : "v1"
    },
    "functions" : {
      "columnExpressions" : {
        "expressions" : [ ],
        "sharedExpressions" : [ ]
      }
    },
    "codeGenConfiguration" : {
      "editableConfig" : true,
      "plibVersion" : {
        "mavenVersion" : "8.0.31"
      }
    },
    "id" : "agg_platform_video_analytics_pb",
    "uri" : "pipelines/foruth_agg_platform_video_analytics",
    "pipelineSettingsInfo" : {
      "manualCompilationEnabled" : true
    },
    "language" : "scala",
    "fabricId" : "442",
    "frontEndLanguage" : "scala",
    "mode" : "batch",
    "udfs" : {
      "language" : "scala",
      "udfs" : [ ],
      "functionPackageName" : "abhinavsimpledatalabscomteam.msbingpipetest.functions",
      "sharedFunctionPackageNames" : [ "io.prophecy.scalagems.functions", "io.prophecy.warehousegems.functions", "prophecydemos.paralleljobstestscala.functions" ],
      "initialCode" : "",
      "isAbInitioTranspilerImport" : true
    },
    "configuration" : {
      "common" : {
        "type" : "record",
        "fields" : [ {
          "name" : "XR_BUSINESS_HOUR",
          "kind" : {
            "type" : "string",
            "value" : "willBeOverwrittenByScript"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "XR_BUSINESS_DATE",
          "kind" : {
            "type" : "string",
            "value" : "willBeOverwrittenByScript"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "Write_Proto_HDFS_agg_platform_video_analytics_pb_agg_platform_video_analytics",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "datasets",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "inputs",
              "kind" : {
                "type" : "record",
                "fields" : [ {
                  "name" : "sup_api_member_pb",
                  "kind" : {
                    "type" : "string",
                    "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/sup/sup_api_member_pb"
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                }, {
                  "name" : "sup_bidder_advertiser_pb",
                  "kind" : {
                    "type" : "string",
                    "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/sup/sup_bidder_advertiser_pb"
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                }, {
                  "name" : "sup_bidder_fx_rates_pb",
                  "kind" : {
                    "type" : "string",
                    "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/sup/sup_bidder_fx_rates"
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                }, {
                  "name" : "sup_creative_media_subtype_pb",
                  "kind" : {
                    "type" : "string",
                    "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/sup/sup_creative_media_subtype_pb"
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                }, {
                  "name" : "sup_placement_video_attributes_pb",
                  "kind" : {
                    "type" : "string",
                    "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/sup/sup_placement_video_attributes_pb"
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                }, {
                  "name" : "agg_dw_video_events_pb",
                  "kind" : {
                    "type" : "string",
                    "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_dw_video_events_pb"
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                }, {
                  "name" : "agg_platform_video_impressions_pb",
                  "kind" : {
                    "type" : "string",
                    "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_platform_video_impressions_pb"
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                }, {
                  "name" : "agg_dw_clicks_pb",
                  "kind" : {
                    "type" : "string",
                    "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_dw_clicks_pb"
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                }, {
                  "name" : "agg_dw_pixels_pb",
                  "kind" : {
                    "type" : "string",
                    "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_dw_pixels_pb"
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                }, {
                  "name" : "agg_impbus_clicks_pb",
                  "kind" : {
                    "type" : "string",
                    "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_impbus_clicks_pb"
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                }, {
                  "name" : "agg_platform_video_requests_pq",
                  "kind" : {
                    "type" : "string",
                    "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_platform_video_requests_pq"
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                }, {
                  "name" : "agg_platform_video_requests_transactable_pq",
                  "kind" : {
                    "type" : "string",
                    "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_platform_video_requests_transactable_pq"
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                }, {
                  "name" : "agg_platform_video_requests_pb",
                  "kind" : {
                    "type" : "string",
                    "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_platform_video_requests_pb"
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                }, {
                  "name" : "agg_platform_video_requests_transactable_pb",
                  "kind" : {
                    "type" : "string",
                    "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_platform_video_requests_transactable_pb"
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                }, {
                  "name" : "agg_platform_video_impressions_pq",
                  "kind" : {
                    "type" : "string",
                    "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_platform_video_impressions_pq"
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                }, {
                  "name" : "agg_dw_video_events_pq",
                  "kind" : {
                    "type" : "string",
                    "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_dw_video_events_pq"
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                }, {
                  "name" : "agg_dw_pixels_pq",
                  "kind" : {
                    "type" : "string",
                    "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_dw_pixels_pq"
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                }, {
                  "name" : "agg_impbus_clicks_pq",
                  "kind" : {
                    "type" : "string",
                    "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_impbus_clicks_pq"
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                }, {
                  "name" : "agg_dw_clicks_pq",
                  "kind" : {
                    "type" : "string",
                    "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_dw_clicks_pq"
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                } ]
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "outputs",
              "kind" : {
                "type" : "record",
                "fields" : [ {
                  "name" : "agg_platform_video_analytics_pb",
                  "kind" : {
                    "type" : "string",
                    "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/aggs/agg_platform_video_analytics_pb"
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                }, {
                  "name" : "agg_platform_video_analytics_pq",
                  "kind" : {
                    "type" : "string",
                    "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/aggs/agg_platform_video_analytics_pq"
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                } ]
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "hdfsProtoDescriptor",
              "kind" : {
                "type" : "string",
                "value" : "hdfs:/data_team/team_user_space/prophecy-schemas-descriptor.protobin"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "system",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "startDate",
              "kind" : {
                "type" : "string",
                "value" : "2024-09-01 15:00:00"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "jobs",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "agg_platform_video_analytics",
              "kind" : {
                "type" : "record",
                "fields" : [ {
                  "name" : "sparkArguments",
                  "kind" : {
                    "type" : "string",
                    "value" : " "
                  },
                  "optional" : true,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                }, {
                  "name" : "sparkCommands",
                  "kind" : {
                    "type" : "string",
                    "value" : " "
                  },
                  "optional" : true,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                } ]
              },
              "optional" : true,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            } ]
          },
          "optional" : true,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "Create_sup_lookup_files",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "Create_sup_lookup_files_Read_Proto_Range_sup_bidder_fx_rates",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "XR_BUSINESS_DATE",
              "kind" : {
                "type" : "string",
                "value" : "willBeOverwrittenByScript"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "Create_sup_lookup_files_Read_Proto_Range_sup_placement_video_attributes_pb",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "XR_LOOKUP_DATA",
              "kind" : {
                "type" : "string",
                "value" : "hdfs:/app_abinitio/dev"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "XR_BUSINESS_HOUR",
              "kind" : {
                "type" : "string",
                "value" : "willBeOverwrittenByScript"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "Create_sup_lookup_files_Read_DML_Range_sup_api_member_tsv_sup_api_member",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "Create_sup_lookup_files_Read_Proto_Range_sup_creative_media_subtype_pb",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "Create_sup_lookup_files_Read_Proto_Range_sup_video_completion_rate_prediction_pb",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "Create_sup_lookup_files_Read_Proto_Range_sup_bidder_advertiser_pb",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "Create_sup_lookup_files_Read_Proto_Range_sup_code_fx_rate",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "Create_sup_lookup_files_Read_Proto_Range_sup_api_member_pb",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "datasets",
              "kind" : {
                "type" : "record",
                "fields" : [ {
                  "name" : "inputs",
                  "kind" : {
                    "type" : "record",
                    "fields" : [ {
                      "name" : "sup_api_member_pb",
                      "kind" : {
                        "type" : "string",
                        "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/sup/sup_api_member_pb"
                      },
                      "optional" : false,
                      "isWorkflowNodeConfiguration" : false,
                      "isReferenced" : false
                    }, {
                      "name" : "sup_bidder_advertiser_pb",
                      "kind" : {
                        "type" : "string",
                        "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/sup/sup_bidder_advertiser_pb"
                      },
                      "optional" : false,
                      "isWorkflowNodeConfiguration" : false,
                      "isReferenced" : false
                    }, {
                      "name" : "sup_bidder_fx_rates_pb",
                      "kind" : {
                        "type" : "string",
                        "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/sup/sup_bidder_fx_rates"
                      },
                      "optional" : false,
                      "isWorkflowNodeConfiguration" : false,
                      "isReferenced" : false
                    }, {
                      "name" : "sup_creative_media_subtype_pb",
                      "kind" : {
                        "type" : "string",
                        "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/sup/sup_creative_media_subtype_pb"
                      },
                      "optional" : false,
                      "isWorkflowNodeConfiguration" : false,
                      "isReferenced" : false
                    }, {
                      "name" : "sup_placement_video_attributes_pb",
                      "kind" : {
                        "type" : "string",
                        "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/sup/sup_placement_video_attributes_pb"
                      },
                      "optional" : false,
                      "isWorkflowNodeConfiguration" : false,
                      "isReferenced" : false
                    }, {
                      "name" : "agg_dw_video_events_pb",
                      "kind" : {
                        "type" : "string",
                        "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_dw_video_events_pb"
                      },
                      "optional" : false,
                      "isWorkflowNodeConfiguration" : false,
                      "isReferenced" : false
                    }, {
                      "name" : "agg_platform_video_impressions_pb",
                      "kind" : {
                        "type" : "string",
                        "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_platform_video_impressions_pb"
                      },
                      "optional" : false,
                      "isWorkflowNodeConfiguration" : false,
                      "isReferenced" : false
                    }, {
                      "name" : "agg_dw_clicks_pb",
                      "kind" : {
                        "type" : "string",
                        "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_dw_clicks_pb"
                      },
                      "optional" : false,
                      "isWorkflowNodeConfiguration" : false,
                      "isReferenced" : false
                    }, {
                      "name" : "agg_dw_pixels_pb",
                      "kind" : {
                        "type" : "string",
                        "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_dw_pixels_pb"
                      },
                      "optional" : false,
                      "isWorkflowNodeConfiguration" : false,
                      "isReferenced" : false
                    }, {
                      "name" : "agg_impbus_clicks_pb",
                      "kind" : {
                        "type" : "string",
                        "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_impbus_clicks_pb"
                      },
                      "optional" : false,
                      "isWorkflowNodeConfiguration" : false,
                      "isReferenced" : false
                    }, {
                      "name" : "agg_platform_video_requests_pq",
                      "kind" : {
                        "type" : "string",
                        "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_platform_video_requests_pq"
                      },
                      "optional" : false,
                      "isWorkflowNodeConfiguration" : false,
                      "isReferenced" : false
                    }, {
                      "name" : "agg_platform_video_requests_transactable_pq",
                      "kind" : {
                        "type" : "string",
                        "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_platform_video_requests_transactable_pq"
                      },
                      "optional" : false,
                      "isWorkflowNodeConfiguration" : false,
                      "isReferenced" : false
                    }, {
                      "name" : "agg_platform_video_requests_pb",
                      "kind" : {
                        "type" : "string",
                        "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_platform_video_requests_pb"
                      },
                      "optional" : false,
                      "isWorkflowNodeConfiguration" : false,
                      "isReferenced" : false
                    }, {
                      "name" : "agg_platform_video_requests_transactable_pb",
                      "kind" : {
                        "type" : "string",
                        "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_platform_video_requests_transactable_pb"
                      },
                      "optional" : false,
                      "isWorkflowNodeConfiguration" : false,
                      "isReferenced" : false
                    }, {
                      "name" : "agg_platform_video_impressions_pq",
                      "kind" : {
                        "type" : "string",
                        "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_platform_video_impressions_pq"
                      },
                      "optional" : false,
                      "isWorkflowNodeConfiguration" : false,
                      "isReferenced" : false
                    }, {
                      "name" : "agg_dw_video_events_pq",
                      "kind" : {
                        "type" : "string",
                        "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_dw_video_events_pq"
                      },
                      "optional" : false,
                      "isWorkflowNodeConfiguration" : false,
                      "isReferenced" : false
                    }, {
                      "name" : "agg_dw_pixels_pq",
                      "kind" : {
                        "type" : "string",
                        "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_dw_pixels_pq"
                      },
                      "optional" : false,
                      "isWorkflowNodeConfiguration" : false,
                      "isReferenced" : false
                    }, {
                      "name" : "agg_impbus_clicks_pq",
                      "kind" : {
                        "type" : "string",
                        "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_impbus_clicks_pq"
                      },
                      "optional" : false,
                      "isWorkflowNodeConfiguration" : false,
                      "isReferenced" : false
                    }, {
                      "name" : "agg_dw_clicks_pq",
                      "kind" : {
                        "type" : "string",
                        "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/sample/aggs/agg_dw_clicks_pq"
                      },
                      "optional" : false,
                      "isWorkflowNodeConfiguration" : false,
                      "isReferenced" : false
                    } ]
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                }, {
                  "name" : "outputs",
                  "kind" : {
                    "type" : "record",
                    "fields" : [ {
                      "name" : "agg_platform_video_analytics_pb",
                      "kind" : {
                        "type" : "string",
                        "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/aggs/agg_platform_video_analytics_pb"
                      },
                      "optional" : false,
                      "isWorkflowNodeConfiguration" : false,
                      "isReferenced" : false
                    }, {
                      "name" : "agg_platform_video_analytics_pq",
                      "kind" : {
                        "type" : "string",
                        "value" : "hdfs:/data_team/team_user_space/mx429j1/prophecy/aggs/agg_platform_video_analytics_pq"
                      },
                      "optional" : false,
                      "isWorkflowNodeConfiguration" : false,
                      "isReferenced" : false
                    } ]
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                }, {
                  "name" : "hdfsProtoDescriptor",
                  "kind" : {
                    "type" : "string",
                    "value" : "hdfs:/data_team/team_user_space/prophecy-schemas-descriptor.protobin"
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                } ]
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "system",
              "kind" : {
                "type" : "record",
                "fields" : [ {
                  "name" : "startDate",
                  "kind" : {
                    "type" : "string",
                    "value" : "2024-09-01 15:00:00"
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                } ]
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        } ]
      },
      "oldCommon" : {
        "type" : "record",
        "fields" : [ ]
      },
      "fabrics" : { },
      "instances" : { },
      "selected" : "default",
      "nonEditable" : [ ],
      "isSubscribedPipelineWithPipelineConfigs" : false
    },
    "sparkConf" : [ {
      "name" : "spark.sql.adaptive.enabled",
      "value" : "true"
    }, {
      "name" : "park.sql.adaptive.coalescePartitions.enabled",
      "value" : "true"
    }, {
      "name" : "spark.sql.adaptive.coalescePartitions.minPartitionSize",
      "value" : "256MB"
    }, {
      "name" : "spark.sql.adaptive.skewJoin.enabled",
      "value" : "true"
    }, {
      "name" : "spark.sql.adaptive.join.enabled",
      "value" : "true"
    }, {
      "name" : "spark.sql.adaptive.skewJoin.skewedPartitionThresholdInBytes",
      "value" : "256MB"
    } ],
    "hadoopConf" : [ ],
    "codeMode" : "sparse",
    "buildSystem" : "maven",
    "externalDependencies" : [ ],
    "dependentProjectExternalDependencies" : [ {
      "projectUID" : "12651",
      "projectName" : "ProphecySparkBasicsScala",
      "externalDependencies" : [ ]
    }, {
      "projectUID" : "12652",
      "projectName" : "ProphecyWarehouseScala",
      "externalDependencies" : [ ]
    }, {
      "projectUID" : "2213",
      "projectName" : "parallel_jobs_test_scala",
      "externalDependencies" : [ {
        "type" : "plibMaven",
        "modifiedAt" : "2024-08-30T07:32:53.162144Z",
        "name" : "plibMaven",
        "version" : "8.0.31",
        "id" : "1551633138",
        "createdAt" : "2024-08-30T07:32:53.161973Z"
      } ]
    } ],
    "isImported" : false,
    "interimMode" : "IO",
    "interimModeEnabled" : true,
    "visualCodeInterimMode" : "Disabled",
    "recordsLimit" : {
      "enabled" : false,
      "value" : 1000
    },
    "topLevelPackage" : "io.prophecy.pipelines.foruth_agg_platform_video_analytics",
    "configurationVersion" : "v2"
  },
  "connections" : [ {
    "id" : "UL3ShhUCU9VZ3G12rDrXH",
    "source" : "syANYrHRTDOuQvmxWRxzh$$5Nc9POofEoKZ15MeqtxGx",
    "sourcePort" : "FhZmieFXd_04_L2D_jh0L$$JGuuF00Vbxh9ft5o7znx5",
    "target" : "tdUvrGvZreGl0Yrb0ohqF$$nVS2awIja2JWigUlRvxhv",
    "targetPort" : "vSZSVbeto9syJ38irZZZ2$$OWH2-ve-VuNOENp8fA2n8"
  }, {
    "id" : "CsRaYXXnPBsG2xtYqTEBU",
    "source" : "69W4P0eP4vrG6d92JQ-Wi$$psVhmwdbTkbRHbmhQ9Vvm",
    "sourcePort" : "MXyZjK9cYWo6tjvT3O7-O$$30qCQkM0vX8hIG7oiJ3Ge",
    "target" : "tdUvrGvZreGl0Yrb0ohqF$$nVS2awIja2JWigUlRvxhv",
    "targetPort" : "hX6wIBJYMBm3XmM36oMIS$$VWdQNLWeP8umm5dVo1VpZ"
  }, {
    "id" : "IQ4zU34J6nw3OAB5KQhF-",
    "source" : "69W4P0eP4vrG6d92JQ-Wi$$psVhmwdbTkbRHbmhQ9Vvm",
    "sourcePort" : "S4O9eZu3rievE8ErXTslt$$irVfK4ZDG8mKMiP0YOxFS",
    "target" : "3zCjwC06al7JqISQkh7UU$$rN_bwCA65SjD8adLr7rxS",
    "targetPort" : "7rwDfFLNWiUJ1y2hL9hlL$$D3rbYOlbU5iJJpmmQ8Nw8"
  }, {
    "id" : "6dRG3tz5zIwqR7Vgh7cIV",
    "source" : "3zCjwC06al7JqISQkh7UU$$rN_bwCA65SjD8adLr7rxS",
    "sourcePort" : "EBOkbowkI8_IfecZBcdjL$$BgR-NtBLJW7mtUCv9XxcM",
    "target" : "syANYrHRTDOuQvmxWRxzh$$5Nc9POofEoKZ15MeqtxGx",
    "targetPort" : "EdgQXnA1drG5by8qvyiS3$$Z2BXYwtxl_ePElebauI4O"
  }, {
    "id" : "eGGMTK0s4nYReJuf9Rj9Y$$kl6gUyp05Wf4wdDMutR71",
    "source" : "1mPBxZVw3pdGbg2lMYvOH$$eTPIdmGtglfVhwZVP3TXX",
    "sourcePort" : "zBfDM5-75jcNwWYv0Y6qu$$DLc8DyumC6L1jtAazks8y",
    "target" : "bJ12hVJgzLVwE3LHbHgQY$$RlAIPeM2jpbS1Qox9WFro",
    "targetPort" : "HMTMivqcJxYMKwAOD3Hg3$$_X6G8XcQ8ZutbUxMNwc5Q"
  }, {
    "id" : "mJ2RybGnyqnkfsY_f1U_H",
    "source" : "bJ12hVJgzLVwE3LHbHgQY$$RlAIPeM2jpbS1Qox9WFro",
    "sourcePort" : "8fi3d_td6zQ1BQCTndwIU$$oCRPrBrpjqQFKyXNbFqtr",
    "target" : "syANYrHRTDOuQvmxWRxzh$$5Nc9POofEoKZ15MeqtxGx",
    "targetPort" : "uU3qhdmtUFT-BRnRSXz9a$$4VG79U0iviA1bZGvE5ZVO"
  }, {
    "id" : "pc91lwB8SgGHmgdD6J-gU$$giqII0-ZauKdwVIURJI_3",
    "source" : "tdUvrGvZreGl0Yrb0ohqF$$nVS2awIja2JWigUlRvxhv",
    "sourcePort" : "0hGqBK23ZuBEQVT5iI9XS$$sQjOPIMQHk3_kHaNpd5oR",
    "target" : "XkX8v0FCUjTSgbbVK5nr9$$e-gfvp_QKhHOYJdz4VAxk",
    "targetPort" : "JQxKq6Hc5wRGB_-8NFlKn$$lxSpvbEBziKzIoSfnY3rb"
  } ],
  "processes" : {
    "bJ12hVJgzLVwE3LHbHgQY$$RlAIPeM2jpbS1Qox9WFro" : {
      "id" : "bJ12hVJgzLVwE3LHbHgQY$$RlAIPeM2jpbS1Qox9WFro",
      "component" : "Script",
      "metadata" : {
        "label" : "repartition_by_auction_id_1_1",
        "slug" : "repartition_by_auction_id_1_1",
        "x" : 680,
        "y" : 60,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "Optimizes data processing by reorganizing records based on auction IDs, enhancing performance for subsequent analysis.",
        "autoUpdateComment" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "HMTMivqcJxYMKwAOD3Hg3$$_X6G8XcQ8ZutbUxMNwc5Q",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "auction_id_64",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_requests_tag_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_requests_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_video_events_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_impressions_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_clicks_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_pixels_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_impbus_clicks_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_video_events_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_impressions_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_clicks_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_pixels_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_impbus_clicks_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_video_events_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_impressions_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_clicks_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_pixels_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_impbus_clicks_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_requests_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_video_events_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_impressions_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_clicks_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_pixels_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_impbus_clicks_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_is_buy_side_imp_agg_dw_pixels_imp_type",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_is_buy_side_imp_imp_type_request_imp_type",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_is_buy_side_imp_agg_platform_video_impressions_imp_type",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_is_buy_side_imp_agg_dw_clicks_imp_type",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_calc_derived_fields",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "8fi3d_td6zQ1BQCTndwIU$$oCRPrBrpjqQFKyXNbFqtr",
          "slug" : "out0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "auction_id_64",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_requests_tag_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_requests_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_video_events_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_impressions_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_clicks_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_pixels_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_impbus_clicks_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_video_events_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_impressions_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_clicks_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_pixels_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_impbus_clicks_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_video_events_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_impressions_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_clicks_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_pixels_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_impbus_clicks_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_requests_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_video_events_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_impressions_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_clicks_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_pixels_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_impbus_clicks_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_is_buy_side_imp_agg_dw_pixels_imp_type",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_is_buy_side_imp_imp_type_request_imp_type",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_is_buy_side_imp_agg_platform_video_impressions_imp_type",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_is_buy_side_imp_agg_dw_clicks_imp_type",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_calc_derived_fields",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "script" : "println(\"#####Step name: repartition by auction id#####\")\nprintln(\"step start time: \" + Instant.now().atZone(ZoneId.of(\"America/Chicago\"))) \n\nimport org.apache.spark.storage.StorageLevel\nval rep_count = 12000\nval out0 = in0.repartition(col(\"agg_platform_video_requests_tag_id\").cast(IntegerType)).persist(StorageLevel.DISK_ONLY)\n\nprintln(\"#####Step name: repartition by auction id#####\")\nprintln(\"step end time: \" + Instant.now().atZone(ZoneId.of(\"America/Chicago\"))) \n",
        "scriptMethodHeader" : "def apply(spark: SparkSession, in0: DataFrame): DataFrame = {",
        "scriptMethodFooter" : "    out0\n}"
      }
    },
    "XkX8v0FCUjTSgbbVK5nr9$$e-gfvp_QKhHOYJdz4VAxk" : {
      "id" : "XkX8v0FCUjTSgbbVK5nr9$$e-gfvp_QKhHOYJdz4VAxk",
      "component" : "Target",
      "metadata" : {
        "label" : "temp_output3",
        "slug" : "temp_output3",
        "x" : 1400,
        "y" : 240,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "JQxKq6Hc5wRGB_-8NFlKn$$lxSpvbEBziKzIoSfnY3rb",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "auction_id_64",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_requests_tag_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_requests_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_video_events_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_impressions_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_clicks_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_pixels_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_impbus_clicks_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_video_events_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_impressions_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_clicks_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_pixels_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_impbus_clicks_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_video_events_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_impressions_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_clicks_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_pixels_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_impbus_clicks_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_requests_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_video_events_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_impressions_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_clicks_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_pixels_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_impbus_clicks_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_is_buy_side_imp_agg_dw_pixels_imp_type",
              "type" : "integer",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_is_buy_side_imp_imp_type_request_imp_type",
              "type" : "integer",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_is_buy_side_imp_agg_platform_video_impressions_imp_type",
              "type" : "integer",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_is_buy_side_imp_agg_dw_clicks_imp_type",
              "type" : "integer",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_calc_derived_fields",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_sup_creative_media_subtype_pb_LOOKUP1",
              "type" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "media_subtype",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "advertiser_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "duration_ms",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "vast_type_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "minimum_vast_version_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_skippable",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "framework_ids",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_sup_creative_media_subtype_pb_LOOKUP2",
              "type" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "media_subtype",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "advertiser_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "duration_ms",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "vast_type_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "minimum_vast_version_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_skippable",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "framework_ids",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_sup_creative_media_subtype_pb_LOOKUP3",
              "type" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "media_subtype",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "advertiser_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "duration_ms",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "vast_type_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "minimum_vast_version_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_skippable",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "framework_ids",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_sup_creative_media_subtype_pb_LOOKUP4",
              "type" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "media_subtype",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "advertiser_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "duration_ms",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "vast_type_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "minimum_vast_version_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_skippable",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "framework_ids",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_sup_creative_media_subtype_pb_LOOKUP5",
              "type" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "media_subtype",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "advertiser_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "duration_ms",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "vast_type_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "minimum_vast_version_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_skippable",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "framework_ids",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_sup_creative_media_subtype_pb_LOOKUP6",
              "type" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "media_subtype",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "advertiser_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "duration_ms",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "vast_type_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "minimum_vast_version_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_skippable",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "framework_ids",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_sup_creative_media_subtype_pb_LOOKUP",
              "type" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "media_subtype",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "advertiser_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "duration_ms",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "vast_type_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "minimum_vast_version_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_skippable",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "framework_ids",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_sup_placement_video_attributes_pb_LOOKUP",
              "type" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "supports_skippable",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "max_duration_secs",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "max_ad_duration_secs",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "maximum_number_ads",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "start_delay_secs",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "playback_method",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "video_context",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_mediated",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "skip_offset",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/temp_output3"
      }
    },
    "5WTY1JTS1O1VIXN1q-Zun$$5nNAXQVdKnFfQh0J0IM3v" : {
      "id" : "5WTY1JTS1O1VIXN1q-Zun$$5nNAXQVdKnFfQh0J0IM3v",
      "component" : "Script",
      "metadata" : {
        "label" : "Script_1",
        "slug" : "Script_1",
        "x" : 20,
        "y" : 220,
        "phase" : -1,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true,
        "autoUpdateOnRun" : true
      },
      "properties" : {
        "script" : "import java.time._\nimport org.joda.time.format._\nimport org.joda.time.DateTime\n\n // a lot of this is taken from the generated code in the Read_Proto files. HOUR is probably not needed\n    def HOUR: String = \"hour\".toLowerCase\n    def isHourlyPartition: Boolean = \"hour\".trim.toLowerCase == \"hour\".toLowerCase\n    val partitionDateOrHourArg : String = Config.system.startDate.trim\n\n    // TODO get writing to config working\n    // for Network Analytics:\n    //          ymd         |        ymdh\n    // ---------------------+---------------------\n    //  2024-06-03 00:00:00 | 2024-06-03 04:00:00\n    // for path to CSV file : 2024/06/04/03\n\n    val parsed : DateTime = DateTimeFormat.forPattern(\"yyyy-MM-dd HH:00:00\").parseDateTime(partitionDateOrHourArg)\n    Config.XR_BUSINESS_DATE = DateTimeFormat.forPattern(\"yyyyMMdd\").print(parsed)\n    Config.XR_BUSINESS_HOUR = DateTimeFormat.forPattern(\"HH\").print(parsed)\n\nprintln(\"XR_BUSINESS_DATE\")\nprintln(Config.XR_BUSINESS_DATE)\nprintln(\"XR_BUSINESS_HOUR\")\nprintln(Config.XR_BUSINESS_HOUR)",
        "scriptMethodHeader" : "def apply(spark: SparkSession): Unit = {",
        "scriptMethodFooter" : "    \n}"
      }
    },
    "tdUvrGvZreGl0Yrb0ohqF$$nVS2awIja2JWigUlRvxhv" : {
      "id" : "tdUvrGvZreGl0Yrb0ohqF$$nVS2awIja2JWigUlRvxhv",
      "component" : "Script",
      "metadata" : {
        "label" : "join_and_lookup_creatives",
        "slug" : "join_and_lookup_creatives",
        "x" : 1220,
        "y" : 240,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "Integrates creative media data with click and impression metrics, enhancing advertising performance analysis.",
        "autoUpdateComment" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "vSZSVbeto9syJ38irZZZ2$$OWH2-ve-VuNOENp8fA2n8",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "_sup_placement_video_attributes_pb_LOOKUP",
              "type" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "supports_skippable",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "max_duration_secs",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "max_ad_duration_secs",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "maximum_number_ads",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "start_delay_secs",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "playback_method",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "video_context",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_mediated",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "skip_offset",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "auction_id_64",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_requests_tag_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_requests_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_video_events_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_impressions_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_clicks_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_pixels_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_impbus_clicks_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_video_events_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_impressions_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_clicks_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_pixels_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_impbus_clicks_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_video_events_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_impressions_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_clicks_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_pixels_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_impbus_clicks_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_requests_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_video_events_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_impressions_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_clicks_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_pixels_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_impbus_clicks_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_is_buy_side_imp_agg_dw_pixels_imp_type",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_is_buy_side_imp_imp_type_request_imp_type",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_is_buy_side_imp_agg_platform_video_impressions_imp_type",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_is_buy_side_imp_agg_dw_clicks_imp_type",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_calc_derived_fields",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        }, {
          "id" : "hX6wIBJYMBm3XmM36oMIS$$VWdQNLWeP8umm5dVo1VpZ",
          "slug" : "in1",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "media_subtype",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "duration_ms",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "vast_type_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "minimum_vast_version_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "is_skippable",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "framework_ids",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "0hGqBK23ZuBEQVT5iI9XS$$sQjOPIMQHk3_kHaNpd5oR",
          "slug" : "out0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "auction_id_64",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_requests_tag_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_requests_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_video_events_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_impressions_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_clicks_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_pixels_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_impbus_clicks_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_video_events_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_impressions_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_clicks_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_pixels_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_impbus_clicks_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_video_events_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_impressions_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_clicks_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_pixels_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_impbus_clicks_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_requests_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_video_events_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_impressions_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_clicks_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_pixels_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_impbus_clicks_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_is_buy_side_imp_agg_dw_pixels_imp_type",
              "type" : "integer",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_is_buy_side_imp_imp_type_request_imp_type",
              "type" : "integer",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_is_buy_side_imp_agg_platform_video_impressions_imp_type",
              "type" : "integer",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_is_buy_side_imp_agg_dw_clicks_imp_type",
              "type" : "integer",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_calc_derived_fields",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_sup_creative_media_subtype_pb_LOOKUP1",
              "type" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "media_subtype",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "advertiser_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "duration_ms",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "vast_type_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "minimum_vast_version_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_skippable",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "framework_ids",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_sup_creative_media_subtype_pb_LOOKUP2",
              "type" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "media_subtype",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "advertiser_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "duration_ms",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "vast_type_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "minimum_vast_version_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_skippable",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "framework_ids",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_sup_creative_media_subtype_pb_LOOKUP3",
              "type" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "media_subtype",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "advertiser_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "duration_ms",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "vast_type_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "minimum_vast_version_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_skippable",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "framework_ids",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_sup_creative_media_subtype_pb_LOOKUP4",
              "type" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "media_subtype",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "advertiser_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "duration_ms",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "vast_type_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "minimum_vast_version_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_skippable",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "framework_ids",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_sup_creative_media_subtype_pb_LOOKUP5",
              "type" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "media_subtype",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "advertiser_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "duration_ms",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "vast_type_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "minimum_vast_version_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_skippable",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "framework_ids",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_sup_creative_media_subtype_pb_LOOKUP6",
              "type" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "media_subtype",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "advertiser_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "duration_ms",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "vast_type_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "minimum_vast_version_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_skippable",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "framework_ids",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_sup_creative_media_subtype_pb_LOOKUP",
              "type" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "media_subtype",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "advertiser_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "duration_ms",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "vast_type_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "minimum_vast_version_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_skippable",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "framework_ids",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_sup_placement_video_attributes_pb_LOOKUP",
              "type" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "supports_skippable",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "max_duration_secs",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "max_ad_duration_secs",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "maximum_number_ads",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "start_delay_secs",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "playback_method",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "video_context",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_mediated",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "skip_offset",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "script" : "println(\"#####Step name: join by id#####\")\nprintln(\"step start time: \" + Instant.now().atZone(ZoneId.of(\"America/Chicago\"))) \n\ndef addLookupStruct(alias: String): Column = {\n    when(\n      is_not_null(col(s\"$alias.id\")),\n      struct(\n        col(s\"$alias.id\").as(\"id\"),\n        col(s\"$alias.media_subtype\").as(\"media_subtype\"),\n        col(s\"$alias.advertiser_id\").as(\"advertiser_id\"),\n        col(s\"$alias.duration_ms\").as(\"duration_ms\"),\n        col(s\"$alias.vast_type_id\").as(\"vast_type_id\"),\n        col(s\"$alias.minimum_vast_version_id\").as(\"minimum_vast_version_id\"),\n        col(s\"$alias.is_skippable\").as(\"is_skippable\"),\n        col(s\"$alias.framework_ids\").as(\"framework_ids\")\n      )\n    )\n  }\n\nimport org.apache.spark.storage.StorageLevel\n\n// Persist the DataFrame to disk only\n// val new_in0 = in0.repartition(12000).persist(StorageLevel.DISK_ONLY)\n\n// val rep_count = 600\nval new_in1 = in1.repartition(col(\"id\")).persist(StorageLevel.MEMORY_AND_DISK)\n\nprintln(\"#####Step name: join by id#####\")\nprintln(\"step persist time: \" + Instant.now().atZone(ZoneId.of(\"America/Chicago\"))) \n\n// Perform the join once for in1 and create multiple lookup columns\nval joinedDF = in0.as(\"in0\")\n  .join(new_in1.as(\"in1\"), col(\"in1.id\") === col(\"in0.agg_dw_clicks_creative_id\"), \"left_outer\")\n  .join(new_in1.as(\"in2\"), col(\"in2.id\") === col(\"in0.agg_platform_video_requests_creative_id\"), \"left_outer\")\n  .join(new_in1.as(\"in3\"), col(\"in3.id\") === col(\"in0.agg_impbus_clicks_creative_id\"), \"left_outer\")\n  .join(new_in1.as(\"in4\"), col(\"in4.id\") === col(\"in0.agg_platform_video_impressions_creative_id\"), \"left_outer\")\n  .join(new_in1.as(\"in5\"), col(\"in5.id\") === col(\"in0.agg_dw_video_events_creative_id\"), \"left_outer\")\n  .join(new_in1.as(\"in6\"), col(\"in6.id\") === col(\"in0.agg_dw_pixels_creative_id\"), \"left_outer\")\n  .join(new_in1.as(\"in7\"), col(\"in7.id\") === col(\"in0.f_calc_derived_fields\"), \"left_outer\")\n\n// Create the respective lookup columns\nval out0 = joinedDF\n  .select(\n    col(\"in0.*\"),  // Select all columns from in0\n    addLookupStruct(\"in2\").as(\"_sup_creative_media_subtype_pb_LOOKUP1\"),  // Include the newly generated columns\n    addLookupStruct(\"in5\").as(\"_sup_creative_media_subtype_pb_LOOKUP2\"),\n    addLookupStruct(\"in4\").as(\"_sup_creative_media_subtype_pb_LOOKUP3\"),\n    addLookupStruct(\"in1\").as(\"_sup_creative_media_subtype_pb_LOOKUP4\"),\n    addLookupStruct(\"in6\").as(\"_sup_creative_media_subtype_pb_LOOKUP5\"),\n    addLookupStruct(\"in3\").as(\"_sup_creative_media_subtype_pb_LOOKUP6\"),\n    addLookupStruct(\"in7\").as(\"_sup_creative_media_subtype_pb_LOOKUP\"),\n    col(\"_sup_placement_video_attributes_pb_LOOKUP\")\n  )\n\nprintln(\"#####Step name: join by id#####\")\nprintln(\"step end time: \" + Instant.now().atZone(ZoneId.of(\"America/Chicago\"))) ",
        "scriptMethodHeader" : "def apply(spark: SparkSession, in0: DataFrame, in1: DataFrame): DataFrame = {",
        "scriptMethodFooter" : "    out0\n}"
      }
    },
    "69W4P0eP4vrG6d92JQ-Wi$$psVhmwdbTkbRHbmhQ9Vvm" : {
      "id" : "69W4P0eP4vrG6d92JQ-Wi$$psVhmwdbTkbRHbmhQ9Vvm",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "Create_sup_lookup_files",
        "slug" : "Create_sup_lookup_files",
        "x" : 620,
        "y" : 380,
        "phase" : 1,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "S4O9eZu3rievE8ErXTslt$$irVfK4ZDG8mKMiP0YOxFS",
          "slug" : "out2"
        }, {
          "id" : "MXyZjK9cYWo6tjvT3O7-O$$30qCQkM0vX8hIG7oiJ3Ge",
          "slug" : "out1"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : { },
      "connections" : [ {
        "id" : "YwHUqztZn736sWEN3MaXC",
        "source" : "J4S_cgo5nVWVMXqXIurFD$$rs2dklcdMV5VJJtaFF96S",
        "sourcePort" : "wVl-TIU1EQRMN2KXRedaz$$_RVbXC6ytbCEL3w_VxgNj",
        "target" : "69W4P0eP4vrG6d92JQ-Wi$$psVhmwdbTkbRHbmhQ9Vvm",
        "targetPort" : "S4O9eZu3rievE8ErXTslt$$irVfK4ZDG8mKMiP0YOxFS"
      }, {
        "id" : "Kd0TrZ5TmAYh32x4snrjR",
        "source" : "qfuivkGXF1884ToR2JxWX$$45aa_uXqOnzsIczJtkyPO",
        "sourcePort" : "WXgWoMfPWoTN1R794DLBc$$9t5SAjr43DZMHJPllGbVI",
        "target" : "69W4P0eP4vrG6d92JQ-Wi$$psVhmwdbTkbRHbmhQ9Vvm",
        "targetPort" : "MXyZjK9cYWo6tjvT3O7-O$$30qCQkM0vX8hIG7oiJ3Ge"
      }, {
        "id" : "gggDIkJyhYaw0B3_Z-DU8",
        "source" : "xX6WoyWretkSSTxM9eM2A$$UWGAXDUoYJeRjUr3hPrzk",
        "sourcePort" : "__G5hM_2tHf0eKLj63iYw$$CZYTPwOOCSPDFbvnTKT1p",
        "target" : "-0MJQK6Qix8ifDlrEVFkt$$QkFpx3H_CMU07zb69iHWy",
        "targetPort" : "uykGzdoKqrZNZvb59Q2qS$$K3VEyYdPWqdDQyI83thd3"
      }, {
        "id" : "ddLfrS8g0N7oroXhC14oT",
        "source" : "wCNKAnKncSzKEKQMAdXAA$$huGArbtAHwAEcFnMuZZgK",
        "sourcePort" : "qpeP0VXGUN8MAmh86LycK$$cLSxS0KI0Ns5KPLWTNqTj",
        "target" : "xX6WoyWretkSSTxM9eM2A$$UWGAXDUoYJeRjUr3hPrzk",
        "targetPort" : "SSR0IKrHE95CvMFY-Mdbs$$lPxYWi7BILz-jDGc5kSBs"
      }, {
        "id" : "zH_rZdvP8hn-4wUC0MOSB",
        "source" : "rLmaGmKe2x7IyQDHVs6T-$$uaheUT0F_TfDt2byR0zJ7",
        "sourcePort" : "nvGIQpajBnogNc4amvbeJ$$UfkOMgeicZp9C8kjvcFh6",
        "target" : "Zngq3Ykn07plrxnEh-Zn1$$5JeCm-yBmEt3Y_s-Hfo9u",
        "targetPort" : "txU32V__1rfKcNrJtOFvw$$d_h3aVtJdT4q4k5eAvH4I"
      }, {
        "id" : "kLcwBFxFUCbK5GWZk7Dbo",
        "source" : "TPKmoV2EBy1GfzX_Tc8T4$$CJfDQEyAvje9f8ICpHVb0",
        "sourcePort" : "Upkp6AjlGufwGtbtAvTmo$$-CqCaMh_RElu0q6-D7Ojk",
        "target" : "bnoUDxWDPD_RpRiY-Ybmq$$QwuqkHoD2-pGJFfr4tFFz",
        "targetPort" : "QODkuB7l1qILJkIKEgPD5$$yV6vrvJSY_v1kliLf8-20"
      }, {
        "id" : "6UxZ2lRRqzMYp2hj5nGNA",
        "source" : "SrxfDBx3QKaviPZuS8ZiD$$XYoKiOsze83nuTk_TCMtG",
        "sourcePort" : "yY_kX0cvIlISULh1oOyWA$$P_YvpwLWTR8XfOPw3MWEl",
        "target" : "92JA1v6khdAxd2XSha4fu$$sf7d1C0u9aHbmPHhdBdgh",
        "targetPort" : "Tn6EOdGUk2RQAwirqWux3$$PK82NY-7JNKNlrTDytK89"
      }, {
        "id" : "iJLI6IzXBHA6jaDVrjLhK",
        "source" : "MulUni_i0DhlEG33867zp$$Tavj1yoDtx7ZbyGQw6Pnm",
        "sourcePort" : "NVqriqHDfzdHNWrcMB4Im$$MxZMoed1Mq-WLVhcLhstb",
        "target" : "cFBzlcG4rEliMar-rYD0b$$6_Th--YxK1XRAODldZMg4",
        "targetPort" : "DJN15Vj7OCQoWxghsJiu1$$q2Q6m8Jjh_ZJGbufnVFIj"
      }, {
        "id" : "Z7VIpwjv2ZgvPe6ffYYpO",
        "source" : "-0MJQK6Qix8ifDlrEVFkt$$QkFpx3H_CMU07zb69iHWy",
        "sourcePort" : "i8Ve8ZpmSweLaa6NzLzT2$$SKdvDDLqqxeDAbiQI5kid",
        "target" : "yKDU_nbTSbIJXjb7ZvDHt$$QeXsAdAsZFRpjAk0K43Et",
        "targetPort" : "v_D0nxfxI1xgUTPQttx_j$$7kukxBCnd7Tvl74z1pjd6"
      }, {
        "id" : "UUpm5oyK0LPl8GB40-k-8",
        "source" : "Zngq3Ykn07plrxnEh-Zn1$$5JeCm-yBmEt3Y_s-Hfo9u",
        "sourcePort" : "TiKFx6Kl6OI9Vx0h8sU69$$-b5V3cb8fCTxCpfHQfiuw",
        "target" : "nZc-RBsxoMxYb0VOJsI26$$IjDGc2zDtJiJKAS0yWvXs",
        "targetPort" : "puCKeDHb1VHYX3LfEN5sU$$8HcyRKXd41TVTn7c1SSgo"
      }, {
        "id" : "X8-_i5GsgQRW4AVQDncIR",
        "source" : "bnoUDxWDPD_RpRiY-Ybmq$$QwuqkHoD2-pGJFfr4tFFz",
        "sourcePort" : "9rZuxA_dm6U_SBzq4UBre$$qhwsr1tOUKQA-7bnS3MIl",
        "target" : "jT6eiBvaH8doXhzu7A1cf$$k8_ZI5fw6NdR_IPnk1C20",
        "targetPort" : "IKkvtQ_RK2ZchbZpBldc0$$_1SoOV1t-iw9ru2Uc-1Th"
      }, {
        "id" : "NA2vLxiO_nE6IdrZW75BR",
        "source" : "92JA1v6khdAxd2XSha4fu$$sf7d1C0u9aHbmPHhdBdgh",
        "sourcePort" : "GqfDRho-tEuaSh4nGR1-H$$jW4qvcdvqSgVCm21NPT0b",
        "target" : "qfuivkGXF1884ToR2JxWX$$45aa_uXqOnzsIczJtkyPO",
        "targetPort" : "es_SQ7_9rTSrekRruZCPy$$MNL9K71Af96WyrMtsNgrw"
      }, {
        "id" : "C3zJ4r729uz95n5zmJDFM",
        "source" : "cFBzlcG4rEliMar-rYD0b$$6_Th--YxK1XRAODldZMg4",
        "sourcePort" : "3cKygzecRWwcO6z4O6bga$$8MzRat5BhSdAGCA7cEQJK",
        "target" : "J4S_cgo5nVWVMXqXIurFD$$rs2dklcdMV5VJJtaFF96S",
        "targetPort" : "XANRnhZpMojHeZodgYGId$$wTjd1xqD4OUIprdjCSBNu"
      } ],
      "processes" : {
        "jT6eiBvaH8doXhzu7A1cf$$k8_ZI5fw6NdR_IPnk1C20" : {
          "id" : "jT6eiBvaH8doXhzu7A1cf$$k8_ZI5fw6NdR_IPnk1C20",
          "component" : "Lookup",
          "metadata" : {
            "label" : "sup_bidder_fx_rates_lookup",
            "slug" : "sup_bidder_fx_rates_lookup",
            "x" : -323.4,
            "y" : 681.2,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "IKkvtQ_RK2ZchbZpBldc0$$_1SoOV1t-iw9ru2Uc-1Th",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "fx_rate_snapshot_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "currency_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "code",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rate",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "as_of_timestamp",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "isRange" : false,
            "keyColumns" : [ "fx_rate_snapshot_id", "code" ],
            "valueColumns" : [ "fx_rate_snapshot_id", "currency_id", "code", "rate", "as_of_timestamp" ],
            "processName" : "sup_bidder_fx_rates"
          }
        },
        "xX6WoyWretkSSTxM9eM2A$$UWGAXDUoYJeRjUr3hPrzk" : {
          "id" : "xX6WoyWretkSSTxM9eM2A$$UWGAXDUoYJeRjUr3hPrzk",
          "component" : "Reformat",
          "metadata" : {
            "label" : "Reformat_sup_code_fx_rate",
            "slug" : "Reformat_sup_code_fx_rate",
            "x" : -523.4,
            "y" : 281.20000000000005,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "SSR0IKrHE95CvMFY-Mdbs$$lPxYWi7BILz-jDGc5kSBs",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "fx_rate_snapshot_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "currency_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "code",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rate",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "as_of_timestamp",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "__G5hM_2tHf0eKLj63iYw$$CZYTPwOOCSPDFbvnTKT1p",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ "SSR0IKrHE95CvMFY-Mdbs$$lPxYWi7BILz-jDGc5kSBs##fx_rate_snapshot_id", "SSR0IKrHE95CvMFY-Mdbs$$lPxYWi7BILz-jDGc5kSBs##currency_id", "SSR0IKrHE95CvMFY-Mdbs$$lPxYWi7BILz-jDGc5kSBs##code", "SSR0IKrHE95CvMFY-Mdbs$$lPxYWi7BILz-jDGc5kSBs##rate", "SSR0IKrHE95CvMFY-Mdbs$$lPxYWi7BILz-jDGc5kSBs##as_of_timestamp" ],
            "expressions" : [ {
              "target" : "fx_rate_snapshot_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"fx_rate_snapshot_id\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "currency_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"currency_id\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "code",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"code\")"
              },
              "description" : ""
            }, {
              "target" : "rate",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"rate\").cast(DoubleType)"
              },
              "description" : ""
            }, {
              "target" : "as_of_timestamp",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"as_of_timestamp\").cast(LongType)"
              },
              "description" : ""
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.2.5.5&projectSubscriptionProjectId=12651&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "qfuivkGXF1884ToR2JxWX$$45aa_uXqOnzsIczJtkyPO" : {
          "id" : "qfuivkGXF1884ToR2JxWX$$45aa_uXqOnzsIczJtkyPO",
          "component" : "Deduplicate",
          "metadata" : {
            "label" : "sup_creative_media_subtype_pb_lookup_dedup4",
            "slug" : "sup_creative_media_subtype_pb_lookup_dedup4",
            "x" : -323.4,
            "y" : 1081.2,
            "phase" : 4,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "es_SQ7_9rTSrekRruZCPy$$MNL9K71Af96WyrMtsNgrw",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "media_subtype",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "advertiser_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "duration_ms",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "vast_type_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "minimum_vast_version_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_skippable",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "framework_ids",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "WXgWoMfPWoTN1R794DLBc$$9t5SAjr43DZMHJPllGbVI",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "dedupColumns" : [ {
              "colName" : "id"
            } ],
            "dedupType" : "any",
            "columnsSelector" : [ "es_SQ7_9rTSrekRruZCPy$$MNL9K71Af96WyrMtsNgrw##id" ],
            "orders" : [ ],
            "useOrderBy" : false
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.2.5.5&projectSubscriptionProjectId=12651&path=gems/Deduplicate",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "wCNKAnKncSzKEKQMAdXAA$$huGArbtAHwAEcFnMuZZgK" : {
          "id" : "wCNKAnKncSzKEKQMAdXAA$$huGArbtAHwAEcFnMuZZgK",
          "component" : "Source",
          "metadata" : {
            "label" : "Read_Proto_Range_sup_code_fx_rate",
            "slug" : "Read_Proto_Range_sup_code_fx_rate",
            "x" : -723.4,
            "y" : 281.20000000000005,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "qpeP0VXGUN8MAmh86LycK$$cLSxS0KI0Ns5KPLWTNqTj",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/Read_Proto_Range_sup_code_fx_rate"
          }
        },
        "Zngq3Ykn07plrxnEh-Zn1$$5JeCm-yBmEt3Y_s-Hfo9u" : {
          "id" : "Zngq3Ykn07plrxnEh-Zn1$$5JeCm-yBmEt3Y_s-Hfo9u",
          "component" : "Reformat",
          "metadata" : {
            "label" : "Reformat_sup_api_member_pb",
            "slug" : "Reformat_sup_api_member_pb",
            "x" : -523.4,
            "y" : 481.20000000000005,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "txU32V__1rfKcNrJtOFvw$$d_h3aVtJdT4q4k5eAvH4I",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "billing_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "bidder_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_billable",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "enable_ip_truncation",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "vendor_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "final_auction_type_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "default_referrer_url",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "member_currency",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "billing_currency",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "TiKFx6Kl6OI9Vx0h8sU69$$-b5V3cb8fCTxCpfHQfiuw",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ "txU32V__1rfKcNrJtOFvw$$d_h3aVtJdT4q4k5eAvH4I##id", "txU32V__1rfKcNrJtOFvw$$d_h3aVtJdT4q4k5eAvH4I##billing_name", "txU32V__1rfKcNrJtOFvw$$d_h3aVtJdT4q4k5eAvH4I##bidder_id", "txU32V__1rfKcNrJtOFvw$$d_h3aVtJdT4q4k5eAvH4I##is_billable", "txU32V__1rfKcNrJtOFvw$$d_h3aVtJdT4q4k5eAvH4I##enable_ip_truncation", "txU32V__1rfKcNrJtOFvw$$d_h3aVtJdT4q4k5eAvH4I##vendor_id", "txU32V__1rfKcNrJtOFvw$$d_h3aVtJdT4q4k5eAvH4I##final_auction_type_id", "txU32V__1rfKcNrJtOFvw$$d_h3aVtJdT4q4k5eAvH4I##default_referrer_url", "txU32V__1rfKcNrJtOFvw$$d_h3aVtJdT4q4k5eAvH4I##member_currency", "txU32V__1rfKcNrJtOFvw$$d_h3aVtJdT4q4k5eAvH4I##billing_currency" ],
            "expressions" : [ {
              "target" : "id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"id\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "billing_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"billing_name\")"
              },
              "description" : ""
            }, {
              "target" : "bidder_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"bidder_id\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "is_billable",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"is_billable\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "enable_ip_truncation",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"enable_ip_truncation\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "vendor_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"vendor_id\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "final_auction_type_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"final_auction_type_id\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "default_referrer_url",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"default_referrer_url\")"
              },
              "description" : ""
            }, {
              "target" : "member_currency",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"member_currency\")"
              },
              "description" : ""
            }, {
              "target" : "billing_currency",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"billing_currency\")"
              },
              "description" : ""
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.2.5.5&projectSubscriptionProjectId=12651&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "bnoUDxWDPD_RpRiY-Ybmq$$QwuqkHoD2-pGJFfr4tFFz" : {
          "id" : "bnoUDxWDPD_RpRiY-Ybmq$$QwuqkHoD2-pGJFfr4tFFz",
          "component" : "Reformat",
          "metadata" : {
            "label" : "Reformat_sup_bidder_fx_rates",
            "slug" : "Reformat_sup_bidder_fx_rates",
            "x" : -523.4,
            "y" : 681.2,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "QODkuB7l1qILJkIKEgPD5$$yV6vrvJSY_v1kliLf8-20",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "fx_rate_snapshot_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "currency_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "code",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rate",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "as_of_timestamp",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "9rZuxA_dm6U_SBzq4UBre$$qhwsr1tOUKQA-7bnS3MIl",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ "QODkuB7l1qILJkIKEgPD5$$yV6vrvJSY_v1kliLf8-20##fx_rate_snapshot_id", "QODkuB7l1qILJkIKEgPD5$$yV6vrvJSY_v1kliLf8-20##currency_id", "QODkuB7l1qILJkIKEgPD5$$yV6vrvJSY_v1kliLf8-20##code", "QODkuB7l1qILJkIKEgPD5$$yV6vrvJSY_v1kliLf8-20##rate", "QODkuB7l1qILJkIKEgPD5$$yV6vrvJSY_v1kliLf8-20##as_of_timestamp" ],
            "expressions" : [ {
              "target" : "fx_rate_snapshot_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"fx_rate_snapshot_id\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "currency_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"currency_id\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "code",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"code\")"
              },
              "description" : ""
            }, {
              "target" : "rate",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"rate\").cast(DoubleType)"
              },
              "description" : ""
            }, {
              "target" : "as_of_timestamp",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"as_of_timestamp\").cast(LongType)"
              },
              "description" : ""
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.2.5.5&projectSubscriptionProjectId=12651&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "J4S_cgo5nVWVMXqXIurFD$$rs2dklcdMV5VJJtaFF96S" : {
          "id" : "J4S_cgo5nVWVMXqXIurFD$$rs2dklcdMV5VJJtaFF96S",
          "component" : "Deduplicate",
          "metadata" : {
            "label" : "sup_placement_video_attributes_pb_lookup_dedup15",
            "slug" : "sup_placement_video_attributes_pb_lookup_dedup15",
            "x" : -323.4,
            "y" : 1281.2,
            "phase" : 4,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "XANRnhZpMojHeZodgYGId$$wTjd1xqD4OUIprdjCSBNu",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "supports_skippable",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "max_duration_secs",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "max_ad_duration_secs",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "maximum_number_ads",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "start_delay_secs",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "playback_method",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "video_context",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_mediated",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "skip_offset",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "wVl-TIU1EQRMN2KXRedaz$$_RVbXC6ytbCEL3w_VxgNj",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "dedupColumns" : [ {
              "colName" : "id"
            } ],
            "dedupType" : "any",
            "columnsSelector" : [ "XANRnhZpMojHeZodgYGId$$wTjd1xqD4OUIprdjCSBNu##id" ],
            "orders" : [ ],
            "useOrderBy" : false
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.2.5.5&projectSubscriptionProjectId=12651&path=gems/Deduplicate",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "nZc-RBsxoMxYb0VOJsI26$$IjDGc2zDtJiJKAS0yWvXs" : {
          "id" : "nZc-RBsxoMxYb0VOJsI26$$IjDGc2zDtJiJKAS0yWvXs",
          "component" : "Lookup",
          "metadata" : {
            "label" : "sup_api_member_pb_lookup",
            "slug" : "sup_api_member_pb_lookup",
            "x" : -323.4,
            "y" : 481.20000000000005,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "puCKeDHb1VHYX3LfEN5sU$$8HcyRKXd41TVTn7c1SSgo",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "billing_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "bidder_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_billable",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "enable_ip_truncation",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "vendor_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "final_auction_type_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "default_referrer_url",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "member_currency",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "billing_currency",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "isRange" : false,
            "keyColumns" : [ "id" ],
            "valueColumns" : [ "id", "billing_name", "bidder_id", "is_billable", "enable_ip_truncation", "vendor_id", "final_auction_type_id", "default_referrer_url", "member_currency", "billing_currency" ],
            "processName" : "sup_api_member_pb"
          }
        },
        "MulUni_i0DhlEG33867zp$$Tavj1yoDtx7ZbyGQw6Pnm" : {
          "id" : "MulUni_i0DhlEG33867zp$$Tavj1yoDtx7ZbyGQw6Pnm",
          "component" : "Source",
          "metadata" : {
            "label" : "Read_Proto_Range_sup_placement_video_attributes_pb",
            "slug" : "Read_Proto_Range_sup_placement_video_attributes_pb",
            "x" : -723.4,
            "y" : 1281.2,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "NVqriqHDfzdHNWrcMB4Im$$MxZMoed1Mq-WLVhcLhstb",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/Read_Proto_Range_sup_placement_video_attributes_pb"
          }
        },
        "yKDU_nbTSbIJXjb7ZvDHt$$QeXsAdAsZFRpjAk0K43Et" : {
          "id" : "yKDU_nbTSbIJXjb7ZvDHt$$QeXsAdAsZFRpjAk0K43Et",
          "component" : "Lookup",
          "metadata" : {
            "label" : "sup_sup_code_fx_rate_lookup",
            "slug" : "sup_sup_code_fx_rate_lookup",
            "x" : -123.39999999999998,
            "y" : 281.20000000000005,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "v_D0nxfxI1xgUTPQttx_j$$7kukxBCnd7Tvl74z1pjd6",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "fx_rate_snapshot_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "currency_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "code",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rate",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "as_of_timestamp",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "isRange" : false,
            "keyColumns" : [ "code" ],
            "valueColumns" : [ "fx_rate_snapshot_id", "currency_id", "code", "rate", "as_of_timestamp" ],
            "processName" : "sup_sup_code_fx_rate"
          }
        },
        "rLmaGmKe2x7IyQDHVs6T-$$uaheUT0F_TfDt2byR0zJ7" : {
          "id" : "rLmaGmKe2x7IyQDHVs6T-$$uaheUT0F_TfDt2byR0zJ7",
          "component" : "Source",
          "metadata" : {
            "label" : "Read_Proto_Range_sup_api_member_pb",
            "slug" : "Read_Proto_Range_sup_api_member_pb",
            "x" : -723.4,
            "y" : 481.20000000000005,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "nvGIQpajBnogNc4amvbeJ$$UfkOMgeicZp9C8kjvcFh6",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/Read_Proto_Range_sup_api_member_pb"
          }
        },
        "TPKmoV2EBy1GfzX_Tc8T4$$CJfDQEyAvje9f8ICpHVb0" : {
          "id" : "TPKmoV2EBy1GfzX_Tc8T4$$CJfDQEyAvje9f8ICpHVb0",
          "component" : "Source",
          "metadata" : {
            "label" : "Read_Proto_Range_sup_bidder_fx_rates",
            "slug" : "Read_Proto_Range_sup_bidder_fx_rates",
            "x" : -723.4,
            "y" : 681.2,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "Upkp6AjlGufwGtbtAvTmo$$-CqCaMh_RElu0q6-D7Ojk",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/Read_Proto_Range_sup_bidder_fx_rates"
          }
        },
        "-0MJQK6Qix8ifDlrEVFkt$$QkFpx3H_CMU07zb69iHWy" : {
          "id" : "-0MJQK6Qix8ifDlrEVFkt$$QkFpx3H_CMU07zb69iHWy",
          "component" : "Deduplicate",
          "metadata" : {
            "label" : "Dedup_Sorted",
            "slug" : "Dedup_Sorted",
            "x" : -323.4,
            "y" : 281.20000000000005,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "uykGzdoKqrZNZvb59Q2qS$$K3VEyYdPWqdDQyI83thd3",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "fx_rate_snapshot_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "currency_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "code",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rate",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "as_of_timestamp",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "i8Ve8ZpmSweLaa6NzLzT2$$SKdvDDLqqxeDAbiQI5kid",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "dedupColumns" : [ {
              "colName" : "code"
            } ],
            "dedupType" : "last",
            "columnsSelector" : [ "uykGzdoKqrZNZvb59Q2qS$$K3VEyYdPWqdDQyI83thd3##code" ],
            "orders" : [ {
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"fx_rate_snapshot_id\")"
              },
              "sortType" : "asc"
            } ],
            "useOrderBy" : true
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.2.5.5&projectSubscriptionProjectId=12651&path=gems/Deduplicate",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "92JA1v6khdAxd2XSha4fu$$sf7d1C0u9aHbmPHhdBdgh" : {
          "id" : "92JA1v6khdAxd2XSha4fu$$sf7d1C0u9aHbmPHhdBdgh",
          "component" : "Reformat",
          "metadata" : {
            "label" : "Reformat_sup_creative_media_subtype_pb",
            "slug" : "Reformat_sup_creative_media_subtype_pb",
            "x" : -523.4,
            "y" : 1081.2,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Tn6EOdGUk2RQAwirqWux3$$PK82NY-7JNKNlrTDytK89",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "media_subtype",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "advertiser_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "duration_ms",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "vast_type_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "minimum_vast_version_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_skippable",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "framework_ids",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "GqfDRho-tEuaSh4nGR1-H$$jW4qvcdvqSgVCm21NPT0b",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ ],
            "expressions" : [ {
              "target" : "id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"id\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "media_subtype",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"media_subtype\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "advertiser_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"advertiser_id\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "duration_ms",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"duration_ms\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "vast_type_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"vast_type_id\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "minimum_vast_version_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"minimum_vast_version_id\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "is_skippable",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"is_skippable\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "framework_ids",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"framework_ids\")"
              },
              "description" : ""
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.2.5.5&projectSubscriptionProjectId=12651&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "cFBzlcG4rEliMar-rYD0b$$6_Th--YxK1XRAODldZMg4" : {
          "id" : "cFBzlcG4rEliMar-rYD0b$$6_Th--YxK1XRAODldZMg4",
          "component" : "Reformat",
          "metadata" : {
            "label" : "Reformat_sup_placement_video_attributes_pb",
            "slug" : "Reformat_sup_placement_video_attributes_pb",
            "x" : -523.4,
            "y" : 1281.2,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "DJN15Vj7OCQoWxghsJiu1$$q2Q6m8Jjh_ZJGbufnVFIj",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "supports_skippable",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "max_duration_secs",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "max_ad_duration_secs",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "maximum_number_ads",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "start_delay_secs",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "playback_method",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "video_context",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_mediated",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "skip_offset",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "3cKygzecRWwcO6z4O6bga$$8MzRat5BhSdAGCA7cEQJK",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ ],
            "expressions" : [ {
              "target" : "id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"id\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "supports_skippable",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"supports_skippable\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "max_duration_secs",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"max_duration_secs\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "max_ad_duration_secs",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"max_ad_duration_secs\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "maximum_number_ads",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"maximum_number_ads\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "start_delay_secs",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"start_delay_secs\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "playback_method",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"playback_method\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "video_context",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"video_context\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "is_mediated",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"is_mediated\").cast(IntegerType)"
              },
              "description" : ""
            }, {
              "target" : "skip_offset",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"skip_offset\").cast(IntegerType)"
              },
              "description" : ""
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.2.5.5&projectSubscriptionProjectId=12651&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "SrxfDBx3QKaviPZuS8ZiD$$XYoKiOsze83nuTk_TCMtG" : {
          "id" : "SrxfDBx3QKaviPZuS8ZiD$$XYoKiOsze83nuTk_TCMtG",
          "component" : "Source",
          "metadata" : {
            "label" : "Read_Proto_Range_sup_creative_media_subtype_pb",
            "slug" : "Read_Proto_Range_sup_creative_media_subtype_pb",
            "x" : -723.4,
            "y" : 1081.2,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "yY_kX0cvIlISULh1oOyWA$$P_YvpwLWTR8XfOPw3MWEl",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/Read_Proto_Range_sup_creative_media_subtype_pb"
          }
        }
      }
    },
    "3zCjwC06al7JqISQkh7UU$$rN_bwCA65SjD8adLr7rxS" : {
      "id" : "3zCjwC06al7JqISQkh7UU$$rN_bwCA65SjD8adLr7rxS",
      "component" : "Repartition",
      "metadata" : {
        "label" : "repartition_by_id",
        "slug" : "repartition_by_id",
        "x" : 820,
        "y" : 280,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "Redistributes data based on customer IDs to optimize processing efficiency.",
        "autoUpdateComment" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "7rwDfFLNWiUJ1y2hL9hlL$$D3rbYOlbU5iJJpmmQ8Nw8",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "supports_skippable",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "max_duration_secs",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "max_ad_duration_secs",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "maximum_number_ads",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "start_delay_secs",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "playback_method",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "video_context",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "is_mediated",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "skip_offset",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "EBOkbowkI8_IfecZBcdjL$$BgR-NtBLJW7mtUCv9XxcM",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "overwriteDefaultNPartitions" : false,
        "hashExpressions" : [ {
          "format" : "scala",
          "expression" : "col(\"id\")"
        } ],
        "columnsSelector" : [ "7rwDfFLNWiUJ1y2hL9hlL$$D3rbYOlbU5iJJpmmQ8Nw8##id" ],
        "repartitionType" : "hash_repartitioning",
        "rangeExpressions" : [ ],
        "defaultPartitions" : "200",
        "nPartitions" : "10"
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.2.5.5&projectSubscriptionProjectId=12651&path=gems/Repartition",
        "projectName" : "ProphecySparkBasicsScala"
      }
    },
    "syANYrHRTDOuQvmxWRxzh$$5Nc9POofEoKZ15MeqtxGx" : {
      "id" : "syANYrHRTDOuQvmxWRxzh$$5Nc9POofEoKZ15MeqtxGx",
      "component" : "Join",
      "metadata" : {
        "label" : "left_outer_join_video_attributes",
        "slug" : "left_outer_join_video_attributes",
        "x" : 1020,
        "y" : 180,
        "phase" : 0,
        "cache" : true,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "Enhances video request data by incorporating additional attributes from a related dataset, ensuring a comprehensive view of video capabilities.",
        "autoUpdateComment" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "uU3qhdmtUFT-BRnRSXz9a$$4VG79U0iviA1bZGvE5ZVO",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "auction_id_64",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_requests_tag_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_requests_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_video_events_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_impressions_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_clicks_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_pixels_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_impbus_clicks_creative_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_video_events_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_impressions_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_clicks_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_pixels_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_impbus_clicks_advertiser_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_video_events_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_impressions_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_clicks_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_pixels_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_impbus_clicks_buyer_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_requests_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_video_events_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_platform_video_impressions_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_clicks_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_dw_pixels_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "agg_impbus_clicks_seller_member_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_is_buy_side_imp_agg_dw_pixels_imp_type",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_is_buy_side_imp_imp_type_request_imp_type",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_is_buy_side_imp_agg_platform_video_impressions_imp_type",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_is_buy_side_imp_agg_dw_clicks_imp_type",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "f_calc_derived_fields",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        }, {
          "id" : "EdgQXnA1drG5by8qvyiS3$$Z2BXYwtxl_ePElebauI4O",
          "slug" : "in1",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "supports_skippable",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "max_duration_secs",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "max_ad_duration_secs",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "maximum_number_ads",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "start_delay_secs",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "playback_method",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "video_context",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "is_mediated",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "skip_offset",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "FhZmieFXd_04_L2D_jh0L$$JGuuF00Vbxh9ft5o7znx5",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "in1",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"in0.agg_platform_video_requests_tag_id\").cast(IntegerType) === col(\"in1.id\")"
          },
          "joinType" : "left_outer"
        } ],
        "expressions" : [ {
          "_row_id" : "c_902",
          "target" : "_sup_placement_video_attributes_pb_LOOKUP",
          "expression" : {
            "format" : "scala",
            "expression" : "when(\n    is_not_null(col(\"in1.id\")),\n    struct(\n      col(\"in1.id\").as(\"id\"),\n      col(\"in1.supports_skippable\").as(\"supports_skippable\"),\n      col(\"in1.max_duration_secs\").as(\"max_duration_secs\"),\n      col(\"in1.max_ad_duration_secs\").as(\"max_ad_duration_secs\"),\n      col(\"in1.maximum_number_ads\").as(\"maximum_number_ads\"),\n      col(\"in1.start_delay_secs\").as(\"start_delay_secs\"),\n      col(\"in1.playback_method\").as(\"playback_method\"),\n      col(\"in1.video_context\").as(\"video_context\"),\n      col(\"in1.is_mediated\").as(\"is_mediated\"),\n      col(\"in1.skip_offset\").as(\"skip_offset\")\n    )\n  )"
          },
          "description" : ""
        } ],
        "hints" : [ {
          "id" : "uU3qhdmtUFT-BRnRSXz9a$$4VG79U0iviA1bZGvE5ZVO",
          "alias" : "in0",
          "hintType" : "none",
          "propagateColumns" : true
        }, {
          "id" : "EdgQXnA1drG5by8qvyiS3$$Z2BXYwtxl_ePElebauI4O",
          "alias" : "in1",
          "hintType" : "none",
          "propagateColumns" : false
        } ],
        "activeTab" : "expressions",
        "columnsSelector" : [ "uU3qhdmtUFT-BRnRSXz9a$$4VG79U0iviA1bZGvE5ZVO##agg_platform_video_requests_tag_id", "EdgQXnA1drG5by8qvyiS3$$Z2BXYwtxl_ePElebauI4O##id", "EdgQXnA1drG5by8qvyiS3$$Z2BXYwtxl_ePElebauI4O##id", "EdgQXnA1drG5by8qvyiS3$$Z2BXYwtxl_ePElebauI4O##supports_skippable", "EdgQXnA1drG5by8qvyiS3$$Z2BXYwtxl_ePElebauI4O##max_duration_secs", "EdgQXnA1drG5by8qvyiS3$$Z2BXYwtxl_ePElebauI4O##max_ad_duration_secs", "EdgQXnA1drG5by8qvyiS3$$Z2BXYwtxl_ePElebauI4O##maximum_number_ads", "EdgQXnA1drG5by8qvyiS3$$Z2BXYwtxl_ePElebauI4O##start_delay_secs", "EdgQXnA1drG5by8qvyiS3$$Z2BXYwtxl_ePElebauI4O##playback_method", "EdgQXnA1drG5by8qvyiS3$$Z2BXYwtxl_ePElebauI4O##video_context", "EdgQXnA1drG5by8qvyiS3$$Z2BXYwtxl_ePElebauI4O##is_mediated", "EdgQXnA1drG5by8qvyiS3$$Z2BXYwtxl_ePElebauI4O##skip_offset" ],
        "headAlias" : "in0"
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.2.5.5&projectSubscriptionProjectId=12651&path=gems/Join",
        "projectName" : "ProphecySparkBasicsScala"
      }
    },
    "1mPBxZVw3pdGbg2lMYvOH$$eTPIdmGtglfVhwZVP3TXX" : {
      "id" : "1mPBxZVw3pdGbg2lMYvOH$$eTPIdmGtglfVhwZVP3TXX",
      "component" : "Source",
      "metadata" : {
        "label" : "temp_output2",
        "slug" : "temp_output2",
        "x" : 500,
        "y" : 60,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "zBfDM5-75jcNwWYv0Y6qu$$DLc8DyumC6L1jtAazks8y",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/temp_output2"
      }
    }
  },
  "ports" : {
    "inputs" : [ ],
    "outputs" : [ ],
    "selectedInputFields" : [ ],
    "isCustomOutputSchema" : false,
    "autoUpdateOnRun" : false
  }
}