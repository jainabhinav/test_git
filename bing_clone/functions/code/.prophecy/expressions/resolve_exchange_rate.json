{"parameters":[{"name":"code","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"fx_rate_snapshot_id","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"fallback","type":"column","metadata":{"description":"","tags":[],"mappings":[]}}],"isCustomSchemaEnabled":false,"code":"var l_lookup_exchange_rate: org.apache.spark.sql.Column = lit(null).cast(DoubleType)\nvar l_lookup_exchange_rate_0: org.apache.spark.sql.Column = lit(null).cast(DoubleType)\nvar l_lookup_exchange_rate_2: org.apache.spark.sql.Column = lit(null).cast(DoubleType)\nvar l_resolved_rate: org.apache.spark.sql.Column = fallback.cast(DoubleType)\nvar l_resolved_rate_1: org.apache.spark.sql.Column = lit(null).cast(DoubleType)\nvar l_resolved_rate_0: org.apache.spark.sql.Column = lit(null).cast(DoubleType)\nl_lookup_exchange_rate_0 = when(string_compare(code, lit(\"USD\")) =!= lit(0), when(is_not_null(fx_rate_snapshot_id).cast(BooleanType), lookup(\"sup_bidder_fx_rates\", fx_rate_snapshot_id, code).getField(\"rate\").cast(DoubleType)).otherwise(l_lookup_exchange_rate)).otherwise(l_lookup_exchange_rate).cast(DoubleType)\nl_lookup_exchange_rate_2 = when(string_compare(code, lit(\"USD\")) =!= lit(0), when(isnull(l_lookup_exchange_rate_0).cast(BooleanType), lookup(\"sup_code_fx_rate\", code).getField(\"rate\").cast(DoubleType)).otherwise(l_lookup_exchange_rate_0)).otherwise(l_lookup_exchange_rate_2).cast(DoubleType)\nl_resolved_rate_1 = when(string_compare(code, lit(\"USD\")) =!= lit(0), when(is_not_null(l_lookup_exchange_rate_2).cast(BooleanType), l_lookup_exchange_rate_2.cast(DoubleType)).otherwise(l_resolved_rate)).otherwise(l_resolved_rate_1).cast(DoubleType)\nl_resolved_rate_0 = when(string_compare(code, lit(\"USD\")) =!= lit(0), l_resolved_rate_1).otherwise(lit(1.0).cast(DoubleType)).cast(DoubleType)\nl_resolved_rate_0","language":"scala","description":""}