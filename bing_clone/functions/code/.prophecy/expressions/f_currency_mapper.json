{"parameters":[{"name":"in_fx_rate_snapshot_id","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"in_buyer_member_id","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"in_seller_member_id","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"in_advertiser_id","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"in_imp_type","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"sup_bidder_advertiser_pb_lookup_2","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"sup_bidder_advertiser_pb_lookup","type":"column","metadata":{"description":"","tags":[],"mappings":[]}}],"output":{"type":"struct","fields":[{"name":"advertiser_default_exchange_rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"billing_exchange_rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"member_exchange_rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"member_currency","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"billing_currency","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"advertiser_default_currency","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"isCustomSchemaEnabled":true,"code":"var l_currency_advertiser_default_exchange_rate: org.apache.spark.sql.Column =\n    lit(null).cast(DoubleType)\n\n  var l_currency_billing_exchange_rate: org.apache.spark.sql.Column =\n    lit(null).cast(DoubleType)\n\n  var l_currency_member_exchange_rate: org.apache.spark.sql.Column =\n    lit(null).cast(DoubleType)\n\n  var l_currency_member_currency: org.apache.spark.sql.Column =\n    rpad(lit(null), 3, \" \")\n\n  var l_currency_billing_currency: org.apache.spark.sql.Column =\n    rpad(lit(null), 3, \" \")\n\n  var l_currency_advertiser_default_currency: org.apache.spark.sql.Column =\n    rpad(lit(null), 3, \" \")\n\n  var l_currency: org.apache.spark.sql.Column = struct(\n    lit(null).as(\"advertiser_default_exchange_rate\"),\n    lit(null).as(\"billing_exchange_rate\"),\n    lit(null).as(\"member_exchange_rate\"),\n    lit(null).as(\"member_currency\"),\n    lit(null).as(\"billing_currency\"),\n    lit(null).as(\"advertiser_default_currency\")\n  )\n\n  var l_imp_type_0: org.apache.spark.sql.Column = in_imp_type.cast(IntegerType)\n\n  var l_fx_rate_snapshot_id_0: org.apache.spark.sql.Column =\n    in_fx_rate_snapshot_id.cast(IntegerType)\n\n  var l_member_id_0: org.apache.spark.sql.Column = when(\n    f_is_buy_side_imp(l_imp_type_0) === lit(1),\n    in_buyer_member_id\n  ).otherwise(in_seller_member_id).cast(IntegerType)\n\n  var l_member_currency_0: org.apache.spark.sql.Column = rpad(\n    coalesce(\n      lookup(\"sup_api_member_pb\", l_member_id_0).getField(\"member_currency\"),\n      lit(\"USD\")\n    ),\n    3,\n    \" \"\n  )\n\n  var l_billing_currency_0: org.apache.spark.sql.Column = rpad(\n    coalesce(\n      lookup(\"sup_api_member_pb\", l_member_id_0).getField(\"billing_currency\"),\n      lit(\"USD\")\n    ),\n    3,\n    \" \"\n  )\n\n  var l_advertiser_default_currency_0: org.apache.spark.sql.Column = rpad(\n    coalesce(\n      sup_bidder_advertiser_pb_lookup.getField(\"advertiser_default_currency\"),\n      sup_bidder_advertiser_pb_lookup_2.getField(\"advertiser_default_currency\"),\n      lit(\"USD\")\n    ),\n    3,\n    \" \"\n  )\n\n  var l_member_exchange_rate_0: org.apache.spark.sql.Column = coalesce(\n    lookup(\"sup_bidder_fx_rates\", l_fx_rate_snapshot_id_0, l_member_currency_0)\n      .getField(\"rate\"),\n    lookup(\"sup_sup_code_fx_rate\", l_member_currency_0).getField(\"rate\"),\n    lit(1.0)\n  ).cast(DoubleType)\n\n  var l_billing_exchange_rate_0: org.apache.spark.sql.Column = coalesce(\n    lookup(\"sup_bidder_fx_rates\", l_fx_rate_snapshot_id_0, l_billing_currency_0)\n      .getField(\"rate\"),\n    lookup(\"sup_sup_code_fx_rate\", l_billing_currency_0).getField(\"rate\"),\n    lit(1.0)\n  ).cast(DoubleType)\n\n  var l_advertiser_default_exchange_rate_0: org.apache.spark.sql.Column =\n    coalesce(\n      lookup(\"sup_bidder_fx_rates\",\n             l_fx_rate_snapshot_id_0,\n             l_advertiser_default_currency_0\n      ).getField(\"rate\"),\n      lookup(\"sup_sup_code_fx_rate\", l_advertiser_default_currency_0).getField(\n        \"rate\"\n      ),\n      lit(1.0)\n    ).cast(DoubleType)\n\n  l_currency_member_currency = rpad(l_member_currency_0,   3, \" \")\n  l_currency_billing_currency = rpad(l_billing_currency_0, 3, \" \")\n  l_currency_advertiser_default_currency =\n    rpad(l_advertiser_default_currency_0, 3, \" \")\n  l_currency_member_exchange_rate = l_member_exchange_rate_0.cast(DoubleType)\n  l_currency_billing_exchange_rate = l_billing_exchange_rate_0.cast(DoubleType)\n  l_currency_advertiser_default_exchange_rate =\n    l_advertiser_default_exchange_rate_0.cast(DoubleType)\n  l_currency = struct(\n    l_currency_advertiser_default_exchange_rate.as(\n      \"advertiser_default_exchange_rate\"\n    ),\n    l_currency_billing_exchange_rate.as(\"billing_exchange_rate\"),\n    l_currency_member_exchange_rate.as(\"member_exchange_rate\"),\n    l_currency_member_currency.as(\"member_currency\"),\n    l_currency_billing_currency.as(\"billing_currency\"),\n    l_currency_advertiser_default_currency.as(\"advertiser_default_currency\")\n  )\n  l_currency","language":"scala","description":""}