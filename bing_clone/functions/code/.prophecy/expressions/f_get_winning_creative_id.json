{"parameters":[{"name":"l_ve","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"l_vi","type":"column","metadata":{"description":"","tags":[],"mappings":[]}}],"output":"integer","isCustomSchemaEnabled":true,"code":"var l_winning_creative_id: org.apache.spark.sql.Column = lit(0)\n  l_winning_creative_id = when(is_not_null(l_vi).cast(BooleanType),\n                               coalesce(l_vi.getField(\"creative_id\"), lit(0))\n  ).otherwise(l_winning_creative_id).cast(IntegerType)\n  l_winning_creative_id = when(\n    is_not_null(l_ve).and(l_winning_creative_id === lit(0)),\n    when(coalesce(l_ve.getField(\"video_was_served\"), lit(0)) > lit(0),\n         coalesce(l_ve.getField(\"creative_id\"), lit(0))\n    ).otherwise(l_winning_creative_id)\n  ).otherwise(l_winning_creative_id).cast(IntegerType)\n  l_winning_creative_id","language":"scala","description":""}