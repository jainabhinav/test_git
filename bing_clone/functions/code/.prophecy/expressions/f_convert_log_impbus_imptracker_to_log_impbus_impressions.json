{"parameters":[],"output":{"type":"struct","fields":[{"name":"date_time","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"auction_id_64","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"user_id_64","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"tag_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"ip_address","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"venue_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"site_domain","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"width","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"height","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"geo_country","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"geo_region","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"gender","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"age","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"bidder_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"creative_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"imp_blacklist_or_fraud","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"imp_bid_on","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_bid","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_spend","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_revenue","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"num_of_bids","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"ecp","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"reserve_price","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"inv_code","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"call_type","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"inventory_source_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"cookie_age","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"brand_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"cleared_direct","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"forex_allowance","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"fold_position","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"external_inv_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"imp_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_delivered","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_dw","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"publisher_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"site_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"content_category_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"datacenter_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"eap","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"user_tz_offset","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"user_group_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"pub_rule_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"media_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"operating_system","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"browser","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"language","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"application_id","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"user_locale","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"inventory_url_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"audit_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"shadow_price","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"impbus_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_currency","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_exchange_rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_currency","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_exchange_rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"vp_expose_domains","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"vp_expose_categories","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"vp_expose_pubs","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"vp_expose_tag","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_exclusive","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"bidder_instance_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"visibility_profile_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"truncate_ip","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"device_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"carrier_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"creative_audit_status","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_creative_hosted","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"city","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"latitude","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"longitude","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"device_unique_id","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"supply_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_toolbar","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"deal_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"vp_bitmap","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"ttl","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"view_detection_enabled","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"ozone_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_performance","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"sdk_version","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"inventory_session_frequency","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"bid_price_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"device_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"dma","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"postal","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"package_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"spend_protection","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_secure","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"estimated_view_rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"external_request_id","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"viewdef_definition_id_buyer_member","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"spend_protection_pixel_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"external_uid","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"request_uuid","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"mobile_app_instance_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"traffic_source_code","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"stitch_group_id","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"deal_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"ym_floor_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"ym_bias_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"estimated_view_rate_over_total","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"device_make_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"operating_system_family_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"tag_sizes","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"width","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"height","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_transaction_def","type":{"type":"struct","fields":[{"name":"transaction_event","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"transaction_event_type_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_transaction_def","type":{"type":"struct","fields":[{"name":"transaction_event","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"transaction_event_type_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"predicted_video_view_info","type":{"type":"struct","fields":[{"name":"iab_view_rate_over_measured","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"iab_view_rate_over_total","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"predicted_100pv50pd_video_view_rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"predicted_100pv50pd_video_view_rate_over_total","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"video_completion_rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"view_prediction_source","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"auction_url","type":{"type":"struct","fields":[{"name":"site_url","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"allowed_media_types","type":{"type":"array","elementType":"integer","containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_imp_rejecter_applied","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"imp_rejecter_do_auction","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"geo_location","type":{"type":"struct","fields":[{"name":"latitude","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"longitude","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_bid_currency_conversion_rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_bid_currency_code","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_prebid","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"default_referrer_url","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"engagement_rates","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"engagement_rate_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"engagement_rate_type_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"fx_rate_snapshot_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"payment_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"apply_cost_on_default","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"media_buy_cost","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"media_buy_rev_share_pct","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"auction_duration_ms","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"expected_events","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"anonymized_user_info","type":{"type":"struct","fields":[{"name":"user_id","type":"binary","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"region_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"media_company_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"gdpr_consent_cookie","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"subject_to_gdpr","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"browser_code_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_prebid_server_included","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seat_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"uid_source","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_whiteops_scanned","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"pred_info","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"crossdevice_groups","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"graph_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"group_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_amp","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"hb_source","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"external_campaign_id","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"log_product_ads","type":{"type":"struct","fields":[{"name":"product_feed_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"item_selection_strategy_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"product_uuid","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"ss_native_assembly_enabled","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"emp","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"personal_identifiers","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"identity_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"identity_value","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"personal_identifiers_experimental","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"identity_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"identity_value","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"postal_code_ext_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"hashed_ip","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"external_deal_code","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"creative_duration","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"openrtb_req_subdomain","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"creative_media_subtype_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_private_auction","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"private_auction_eligible","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"client_request_id","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"chrome_traffic_label","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"isCustomSchemaEnabled":true,"code":"var l_null_log_transaction_def: org.apache.spark.sql.Column = struct(\n    lit(null).as(\"transaction_event\"),\n    lit(null).as(\"transaction_event_type_id\")\n  )\n\n  l_null_log_transaction_def = struct(\n    lit(1).as(\"transaction_event\"),\n    lit(null).cast(IntegerType).as(\"transaction_event_type_id\")\n  )\n  struct(\n    col(\"date_time\").cast(LongType).as(\"date_time\"),\n    col(\"auction_id_64\").cast(LongType).as(\"auction_id_64\"),\n    col(\"user_id_64\").cast(LongType).as(\"user_id_64\"),\n    col(\"tag_id\").cast(IntegerType).as(\"tag_id\"),\n    col(\"ip_address\").cast(StringType).as(\"ip_address\"),\n    lit(0).as(\"venue_id\"),\n    col(\"site_domain\").cast(StringType).as(\"site_domain\"),\n    lit(0).as(\"width\"),\n    lit(0).as(\"height\"),\n    col(\"geo_country\").cast(StringType).as(\"geo_country\"),\n    coalesce(when(isnull(col(\"geo_region\")).cast(BooleanType), lit(\"--\"))\n               .otherwise(col(\"geo_region\")),\n             col(\"geo_region\").cast(StringType)\n    ).as(\"geo_region\"),\n    lit(\"u\").as(\"gender\"),\n    lit(0).as(\"age\"),\n    lit(0).as(\"bidder_id\"),\n    col(\"member_id\").cast(IntegerType).as(\"seller_member_id\"),\n    col(\"member_id\").cast(IntegerType).as(\"buyer_member_id\"),\n    lit(0).as(\"creative_id\"),\n    lit(0).as(\"imp_blacklist_or_fraud\"),\n    lit(0).as(\"imp_bid_on\"),\n    lit(0).as(\"buyer_bid\"),\n    lit(0).as(\"buyer_spend\"),\n    lit(0.0).as(\"seller_revenue\"),\n    lit(0).as(\"num_of_bids\"),\n    lit(0).as(\"ecp\"),\n    lit(0).as(\"reserve_price\"),\n    lit(\"\").as(\"inv_code\"),\n    lit(\"\").as(\"call_type\"),\n    lit(0).as(\"inventory_source_id\"),\n    lit(0).as(\"cookie_age\"),\n    lit(0).as(\"brand_id\"),\n    lit(0).as(\"cleared_direct\"),\n    lit(null).cast(DoubleType).as(\"forex_allowance\"),\n    lit(0).as(\"fold_position\"),\n    lit(0).as(\"external_inv_id\"),\n    lit(9).as(\"imp_type\"),\n    lit(1).as(\"is_delivered\"),\n    lit(1).as(\"is_dw\"),\n    col(\"publisher_id\").cast(IntegerType).as(\"publisher_id\"),\n    col(\"site_id\").cast(IntegerType).as(\"site_id\"),\n    col(\"content_category_id\").cast(IntegerType).as(\"content_category_id\"),\n    col(\"datacenter_id\").cast(IntegerType).as(\"datacenter_id\"),\n    lit(0).as(\"eap\"),\n    col(\"user_tz_offset\").cast(IntegerType).as(\"user_tz_offset\"),\n    col(\"user_group_id\").cast(IntegerType).as(\"user_group_id\"),\n    col(\"pub_rule_id\").cast(IntegerType).as(\"pub_rule_id\"),\n    lit(0).as(\"media_type\"),\n    col(\"operating_system\").cast(IntegerType).as(\"operating_system\"),\n    col(\"browser\").cast(IntegerType).as(\"browser\"),\n    col(\"language\").cast(IntegerType).as(\"language\"),\n    lit(\"\").as(\"application_id\"),\n    lit(\"\").as(\"user_locale\"),\n    lit(0).as(\"inventory_url_id\"),\n    lit(0).as(\"audit_type\"),\n    lit(0).as(\"shadow_price\"),\n    lit(0).as(\"impbus_id\"),\n    col(\"seller_currency\").as(\"buyer_currency\"),\n    col(\"seller_exchange_rate\").as(\"buyer_exchange_rate\"),\n    col(\"seller_currency\").cast(StringType).as(\"seller_currency\"),\n    col(\"seller_exchange_rate\").cast(DoubleType).as(\"seller_exchange_rate\"),\n    lit(1).as(\"vp_expose_domains\"),\n    lit(1).as(\"vp_expose_categories\"),\n    lit(1).as(\"vp_expose_pubs\"),\n    lit(1).as(\"vp_expose_tag\"),\n    lit(-1).as(\"is_exclusive\"),\n    lit(-1).as(\"bidder_instance_id\"),\n    lit(-1).as(\"visibility_profile_id\"),\n    lit(0).as(\"truncate_ip\"),\n    lit(0).as(\"device_id\"),\n    lit(0).as(\"carrier_id\"),\n    lit(0).as(\"creative_audit_status\"),\n    lit(0).as(\"is_creative_hosted\"),\n    lit(-1).as(\"city\"),\n    lit(\"\").as(\"latitude\"),\n    lit(\"\").as(\"longitude\"),\n    lit(\"\").as(\"device_unique_id\"),\n    lit(0).as(\"supply_type\"),\n    lit(0).as(\"is_toolbar\"),\n    lit(0).as(\"deal_id\"),\n    lit(9223372036854775807L).as(\"vp_bitmap\"),\n    lit(null).cast(IntegerType).as(\"ttl\"),\n    lit(null).cast(IntegerType).as(\"view_detection_enabled\"),\n    lit(null).cast(IntegerType).as(\"ozone_id\"),\n    lit(null).cast(IntegerType).as(\"is_performance\"),\n    lit(null).cast(StringType).as(\"sdk_version\"),\n    lit(null).cast(IntegerType).as(\"inventory_session_frequency\"),\n    lit(null).cast(IntegerType).as(\"bid_price_type\"),\n    lit(null).cast(IntegerType).as(\"device_type\"),\n    lit(null).cast(IntegerType).as(\"dma\"),\n    lit(null).cast(StringType).as(\"postal\"),\n    lit(null).cast(IntegerType).as(\"package_id\"),\n    lit(null).cast(IntegerType).as(\"spend_protection\"),\n    lit(null).cast(IntegerType).as(\"is_secure\"),\n    lit(null).cast(DoubleType).as(\"estimated_view_rate\"),\n    lit(null).cast(StringType).as(\"external_request_id\"),\n    lit(null).cast(IntegerType).as(\"viewdef_definition_id_buyer_member\"),\n    lit(null).cast(IntegerType).as(\"spend_protection_pixel_id\"),\n    lit(null).cast(StringType).as(\"external_uid\"),\n    lit(null).cast(StringType).as(\"request_uuid\"),\n    lit(null).cast(IntegerType).as(\"mobile_app_instance_id\"),\n    lit(null).cast(StringType).as(\"traffic_source_code\"),\n    lit(null).cast(StringType).as(\"stitch_group_id\"),\n    lit(null).cast(IntegerType).as(\"deal_type\"),\n    lit(null).cast(IntegerType).as(\"ym_floor_id\"),\n    lit(null).cast(IntegerType).as(\"ym_bias_id\"),\n    lit(null).cast(DoubleType).as(\"estimated_view_rate_over_total\"),\n    lit(null).cast(IntegerType).as(\"device_make_id\"),\n    lit(1).as(\"operating_system_family_id\"),\n    lit(null)\n      .cast(\n        ArrayType(StructType(\n                    List(StructField(\"width\",  IntegerType, true),\n                         StructField(\"height\", IntegerType, true)\n                    )\n                  ),\n                  true\n        )\n      )\n      .as(\"tag_sizes\"),\n    l_null_log_transaction_def.as(\"seller_transaction_def\"),\n    l_null_log_transaction_def.as(\"buyer_transaction_def\"),\n    lit(null)\n      .cast(\n        StructType(\n          List(\n            StructField(\"iab_view_rate_over_measured\", DoubleType, true),\n            StructField(\"iab_view_rate_over_total\",    DoubleType, true),\n            StructField(\"predicted_100pv50pd_video_view_rate\",\n                        DoubleType,\n                        true\n            ),\n            StructField(\"predicted_100pv50pd_video_view_rate_over_total\",\n                        DoubleType,\n                        true\n            ),\n            StructField(\"video_completion_rate\",  DoubleType,  true),\n            StructField(\"view_prediction_source\", IntegerType, true)\n          )\n        )\n      )\n      .as(\"predicted_video_view_info\"),\n    lit(null)\n      .cast(StructType(List(StructField(\"site_url\", StringType, true))))\n      .as(\"auction_url\"),\n    lit(null).cast(ArrayType(IntegerType, true)).as(\"allowed_media_types\"),\n    lit(null).cast(BooleanType).as(\"is_imp_rejecter_applied\"),\n    lit(1).cast(BooleanType).as(\"imp_rejecter_do_auction\"),\n    lit(null)\n      .cast(\n        StructType(\n          List(StructField(\"latitude\",  FloatType, true),\n               StructField(\"longitude\", FloatType, true)\n          )\n        )\n      )\n      .as(\"geo_location\"),\n    lit(null).cast(DoubleType).as(\"seller_bid_currency_conversion_rate\"),\n    lit(null).cast(StringType).as(\"seller_bid_currency_code\"),\n    lit(null).cast(BooleanType).as(\"is_prebid\"),\n    lit(null).cast(StringType).as(\"default_referrer_url\"),\n    lit(null)\n      .cast(\n        ArrayType(\n          StructType(\n            List(StructField(\"engagement_rate_type\",    IntegerType, true),\n                 StructField(\"rate\",                    DoubleType,  true),\n                 StructField(\"engagement_rate_type_id\", IntegerType, true)\n            )\n          ),\n          true\n        )\n      )\n      .as(\"engagement_rates\"),\n    col(\"fx_rate_snapshot_id\").cast(IntegerType).as(\"fx_rate_snapshot_id\"),\n    lit(null).cast(IntegerType).as(\"payment_type\"),\n    lit(null).cast(IntegerType).as(\"apply_cost_on_default\"),\n    lit(null).cast(DoubleType).as(\"media_buy_cost\"),\n    lit(null).cast(DoubleType).as(\"media_buy_rev_share_pct\"),\n    lit(null).cast(IntegerType).as(\"auction_duration_ms\"),\n    lit(null).cast(IntegerType).as(\"expected_events\"),\n    when(is_not_null(col(\"anonymized_user_info\")).cast(BooleanType),\n         col(\"anonymized_user_info\")\n    ).as(\"anonymized_user_info\"),\n    coalesce(when(col(\"region_id\").cast(IntegerType) =!= lit(0),\n                  col(\"region_id\").cast(IntegerType)\n             ),\n             col(\"region_id\").cast(IntegerType)\n    ).as(\"region_id\"),\n    lit(null).cast(IntegerType).as(\"media_company_id\"),\n    lit(null).cast(StringType).as(\"gdpr_consent_cookie\"),\n    lit(null).cast(BooleanType).as(\"subject_to_gdpr\"),\n    lit(null).cast(IntegerType).as(\"browser_code_id\"),\n    lit(null).cast(IntegerType).as(\"is_prebid_server_included\"),\n    lit(null).cast(IntegerType).as(\"seat_id\"),\n    lit(null).cast(IntegerType).as(\"uid_source\"),\n    lit(null).cast(BooleanType).as(\"is_whiteops_scanned\"),\n    lit(null).cast(IntegerType).as(\"pred_info\"),\n    lit(null)\n      .cast(\n        ArrayType(StructType(\n                    List(StructField(\"graph_id\", IntegerType, true),\n                         StructField(\"group_id\", LongType,    true)\n                    )\n                  ),\n                  true\n        )\n      )\n      .as(\"crossdevice_groups\"),\n    lit(null).cast(BooleanType).as(\"is_amp\"),\n    lit(null).cast(IntegerType).as(\"hb_source\"),\n    lit(null).cast(StringType).as(\"external_campaign_id\"),\n    lit(null)\n      .cast(\n        StructType(\n          List(\n            StructField(\"product_feed_id\",            IntegerType, true),\n            StructField(\"item_selection_strategy_id\", IntegerType, true),\n            StructField(\"product_uuid\",               StringType,  true)\n          )\n        )\n      )\n      .as(\"log_product_ads\"),\n    lit(null).cast(BooleanType).as(\"ss_native_assembly_enabled\"),\n    lit(null).cast(DoubleType).as(\"emp\"),\n    lit(null)\n      .cast(\n        ArrayType(StructType(\n                    List(StructField(\"identity_type\",  IntegerType, true),\n                         StructField(\"identity_value\", StringType,  true)\n                    )\n                  ),\n                  true\n        )\n      )\n      .as(\"personal_identifiers\"),\n    lit(null)\n      .cast(\n        ArrayType(StructType(\n                    List(StructField(\"identity_type\",  IntegerType, true),\n                         StructField(\"identity_value\", StringType,  true)\n                    )\n                  ),\n                  true\n        )\n      )\n      .as(\"personal_identifiers_experimental\"),\n    lit(null).cast(IntegerType).as(\"postal_code_ext_id\"),\n    col(\"hashed_ip\").cast(StringType).as(\"hashed_ip\"),\n    lit(null).cast(StringType).as(\"external_deal_code\"),\n    lit(null).cast(IntegerType).as(\"creative_duration\"),\n    lit(null).cast(StringType).as(\"openrtb_req_subdomain\"),\n    lit(null).cast(IntegerType).as(\"creative_media_subtype_id\"),\n    lit(null).cast(BooleanType).as(\"is_private_auction\"),\n    lit(null).cast(BooleanType).as(\"private_auction_eligible\"),\n    lit(null).cast(StringType).as(\"client_request_id\"),\n    lit(null).cast(IntegerType).as(\"chrome_traffic_label\")\n  )","language":"scala","description":""}