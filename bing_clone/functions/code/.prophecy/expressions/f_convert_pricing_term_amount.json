{"parameters":[{"name":"in_pricing_terms","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"magnitude","type":"column","metadata":{"description":"","tags":[],"mappings":[]}}],"output":{"type":"array","elementType":{"type":"struct","fields":[{"name":"term_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amount","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_deduction","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_media_cost_dependent","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"data_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"isCustomSchemaEnabled":true,"code":"when(\n    is_not_null(in_pricing_terms).cast(BooleanType),\n    temp2704511_UDF(\n      in_pricing_terms,\n      lit(null).cast(\n        ArrayType(\n          StructType(\n            List(\n              StructField(\"term_id\",                 IntegerType, true),\n              StructField(\"amount\",                  DoubleType,  true),\n              StructField(\"rate\",                    DoubleType,  true),\n              StructField(\"is_deduction\",            BooleanType, true),\n              StructField(\"is_media_cost_dependent\", BooleanType, true),\n              StructField(\"data_member_id\",          IntegerType, true)\n            )\n          ),\n          true\n        )\n      ),\n      lit(0),\n      magnitude\n    ).getField(\"l_pricing_terms\")\n  ).otherwise(\n    lit(null).cast(\n      ArrayType(\n        StructType(\n          List(\n            StructField(\"term_id\",                 IntegerType, true),\n            StructField(\"amount\",                  DoubleType,  true),\n            StructField(\"rate\",                    DoubleType,  true),\n            StructField(\"is_deduction\",            BooleanType, true),\n            StructField(\"is_media_cost_dependent\", BooleanType, true),\n            StructField(\"data_member_id\",          IntegerType, true)\n          )\n        ),\n        true\n      )\n    )\n  )","language":"scala","description":""}