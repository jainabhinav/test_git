{"parameters":[{"name":"imp_type","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"payment_type","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"revenue_type","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"in_pricing_terms","type":"column","metadata":{"description":"","tags":[],"mappings":[]}}],"output":{"type":"array","elementType":{"type":"struct","fields":[{"name":"term_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amount","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_deduction","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_media_cost_dependent","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"data_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"isCustomSchemaEnabled":true,"code":"when(\n    is_not_null(in_pricing_terms).cast(BooleanType),\n    when(\n      ((is_not_null(imp_type)\n        .and(is_not_null(payment_type)))\n        .and(is_not_null(revenue_type)))\n        .and(\n          ((imp_type === lit(6))\n            .and(revenue_type.isin(lit(3),                          lit(4))))\n            .or((imp_type === lit(7)).and(payment_type.isin(lit(1), lit(2))))\n        ),\n      temp6618434_UDF(in_pricing_terms, in_pricing_terms, lit(0)).getField(\n        \"l_pricing_terms\"\n      )\n    ).otherwise(in_pricing_terms)\n  ).otherwise(\n    lit(null).cast(\n      ArrayType(\n        StructType(\n          List(\n            StructField(\"term_id\",                 IntegerType, true),\n            StructField(\"amount\",                  DoubleType,  true),\n            StructField(\"rate\",                    DoubleType,  true),\n            StructField(\"is_deduction\",            BooleanType, true),\n            StructField(\"is_media_cost_dependent\", BooleanType, true),\n            StructField(\"data_member_id\",          IntegerType, true)\n          )\n        ),\n        true\n      )\n    )\n  )","language":"scala","description":""}