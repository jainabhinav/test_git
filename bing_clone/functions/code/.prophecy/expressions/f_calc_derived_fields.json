{"parameters":[{"name":"l_ve","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"l_vi","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"l_vr","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"l_clicks","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"l_pixels","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"l_winning_creative_id","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"global_variable_substituted_XR_BUSINESS_DATE","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"global_variable_substituted_XR_BUSINESS_HOUR","type":"column","metadata":{"description":"","tags":[],"mappings":[]}}],"output":{"type":"struct","fields":[{"name":"advertiser_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"creative_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"imp_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"fx_rate_snapshot_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"isCustomSchemaEnabled":true,"code":"struct(\n    coalesce(\n      when(is_not_null(l_vi.getField(\"advertiser_id\")).cast(BooleanType),\n           l_vi.getField(\"advertiser_id\")\n      ),\n      when(is_not_null(l_clicks.getField(\"advertiser_id\")).cast(BooleanType),\n           l_clicks.getField(\"advertiser_id\")\n      ),\n      when(is_not_null(l_pixels.getField(\"advertiser_id\")).cast(BooleanType),\n           l_pixels.getField(\"advertiser_id\")\n      )\n    ).as(\"advertiser_id\"),\n    coalesce(\n      when(is_not_null(l_ve).and(is_not_null(l_vi)), l_winning_creative_id),\n      when(is_not_null(l_ve).cast(BooleanType),\n           coalesce(l_ve.getField(\"creative_id\"), lit(0))\n      ),\n      when(is_not_null(l_vi).cast(BooleanType),\n           coalesce(l_vi.getField(\"creative_id\"), lit(0))\n      ),\n      l_vr.getField(\"creative_id\"),\n      l_clicks.getField(\"creative_id\"),\n      l_pixels.getField(\"creative_id\")\n    ).as(\"creative_id\"),\n    coalesce(\n      when(is_not_null(l_ve).cast(BooleanType),\n           coalesce(l_ve.getField(\"fx_rate_snapshot_id\"), lit(0))\n      ),\n      when(\n        f_is_curr_hour(l_vi.getField(\"date_time\"),\n                       global_variable_substituted_XR_BUSINESS_DATE,\n                       global_variable_substituted_XR_BUSINESS_HOUR\n        ).cast(BooleanType),\n        coalesce(l_vi.getField(\"fx_rate_snapshot_id\"), lit(0))\n      ),\n      when(is_not_null(l_clicks).cast(BooleanType),\n           coalesce(l_clicks.getField(\"fx_rate_snapshot_id\"), lit(0))\n      ),\n      when(is_not_null(l_pixels).cast(BooleanType),\n           coalesce(l_pixels.getField(\"fx_rate_snapshot_id\"), lit(0))\n      )\n    ).as(\"fx_rate_snapshot_id\")\n  )","language":"scala","description":""}