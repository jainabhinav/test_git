{"parameters":[{"name":"in1","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"advertiser_id_by_campaign_group_id_lookup","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"member_id_by_advertiser_id_lookup","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"member_id_by_publisher_id_lookup","type":"column","metadata":{"description":"","tags":[],"mappings":[]}}],"isCustomSchemaEnabled":false,"code":"var imp_type: org.apache.spark.sql.Column =\n    in1.getField(\"imp_type\").cast(IntegerType)\n\n  var seller_member_id: org.apache.spark.sql.Column = in1\n    .getField(\"log_impbus_impressions\")\n    .getField(\"seller_member_id\")\n    .cast(IntegerType)\n\n  var publisher_id: org.apache.spark.sql.Column =\n    in1.getField(\"publisher_id\").cast(IntegerType)\n\n  var buyer_member_id: org.apache.spark.sql.Column = coalesce(\n    in1.getField(\"log_dw_bid\").getField(\"member_id\"),\n    in1.getField(\"log_impbus_preempt\").getField(\"buyer_member_id\"),\n    in1.getField(\"log_impbus_impressions\").getField(\"buyer_member_id\"),\n    lit(null)\n  ).cast(IntegerType)\n\n  var advertiser_id: org.apache.spark.sql.Column =\n    in1.getField(\"advertiser_id\").cast(IntegerType)\n\n  var campaign_group_id: org.apache.spark.sql.Column =\n    in1.getField(\"campaign_group_id\").cast(IntegerType)\n\n  var publisher_seller_member_id: org.apache.spark.sql.Column =\n    lit(null).cast(IntegerType)\n\n  var advertiser_buyer_member_id: org.apache.spark.sql.Column =\n    lit(null).cast(IntegerType)\n\n  var campaign_group_advertiser_id: org.apache.spark.sql.Column =\n    lit(null).cast(IntegerType)\n\n  var quarantine: org.apache.spark.sql.Column = lit(0)\n\n  var log_impbus_impressions_pricing_count: org.apache.spark.sql.Column =\n    coalesce(in1.getField(\"log_impbus_impressions_pricing_count\"), lit(0))\n      .cast(IntegerType)\n\n  var gross_payment_value_microcents: org.apache.spark.sql.Column =\n    coalesce(in1\n               .getField(\"log_impbus_impressions_pricing\")\n               .getField(\"impression_event_pricing\")\n               .getField(\"gross_payment_value_microcents\"),\n             lit(0)\n    ).cast(LongType)\n\n  var gross_payment_value_microcents_dup: org.apache.spark.sql.Column =\n    coalesce(in1\n               .getField(\"log_impbus_impressions_pricing_dup\")\n               .getField(\"impression_event_pricing\")\n               .getField(\"gross_payment_value_microcents\"),\n             lit(0)\n    ).cast(LongType)\n\n  quarantine = when(\n    (is_not_null(in1.getField(\"log_dw_bid\").getField(\"member_id\"))\n      .and(\n        is_not_null(\n          coalesce(\n            in1.getField(\"log_impbus_preempt\").getField(\"buyer_member_id\"),\n            in1.getField(\"log_impbus_impressions\").getField(\"buyer_member_id\"),\n            lit(null)\n          )\n        )\n      ))\n      .and(\n        coalesce(\n          in1.getField(\"log_impbus_preempt\").getField(\"buyer_member_id\"),\n          in1.getField(\"log_impbus_impressions\").getField(\"buyer_member_id\"),\n          lit(null)\n        ) =!= in1.getField(\"log_dw_bid\").getField(\"member_id\")\n      ),\n    lit(1)\n  ).when(\n      (is_not_null(in1.getField(\"log_dw_bid_last\").getField(\"member_id\"))\n        .and(is_not_null(in1.getField(\"log_dw_bid\").getField(\"member_id\"))))\n        .and(\n          in1.getField(\"log_dw_bid_last\").getField(\"member_id\") =!= in1\n            .getField(\"log_dw_bid\")\n            .getField(\"member_id\")\n        ),\n      lit(1)\n    )\n    .when(\n      (is_not_null(in1.getField(\"log_dw_bid_last\").getField(\"advertiser_id\"))\n        .and(is_not_null(in1.getField(\"log_dw_bid\").getField(\"advertiser_id\"))))\n        .and(\n          in1.getField(\"log_dw_bid_last\").getField(\"advertiser_id\") =!= in1\n            .getField(\"log_dw_bid\")\n            .getField(\"advertiser_id\")\n        ),\n      lit(1)\n    )\n    .when(\n      (is_not_null(\n        in1.getField(\"log_dw_bid_last\").getField(\"campaign_group_id\")\n      ).and(\n          is_not_null(in1.getField(\"log_dw_bid\").getField(\"campaign_group_id\"))\n        ))\n        .and(\n          in1.getField(\"log_dw_bid_last\").getField(\"campaign_group_id\") =!= in1\n            .getField(\"log_dw_bid\")\n            .getField(\"campaign_group_id\")\n        ),\n      lit(1)\n    )\n    .otherwise(quarantine)\n    .cast(IntegerType)\n  quarantine = when(\n    quarantine === lit(0),\n    when(isnull(member_id_by_publisher_id_lookup.getField(\"seller_member_id\"))\n           .and(is_not_null(publisher_id).and(publisher_id =!= lit(0))),\n         lit(1)\n    ).when(\n        (((is_not_null(campaign_group_id)\n          .and(campaign_group_id =!= lit(0)))\n          .and(is_not_null(advertiser_id)))\n          .and(advertiser_id =!= lit(0)))\n          .and(\n            (((((is_not_null(imp_type)\n              .and((imp_type === lit(6)).and(imp_type === lit(2))))\n              .and(is_not_null(seller_member_id)))\n              .and(\n                is_not_null(\n                  member_id_by_publisher_id_lookup.getField(\"seller_member_id\")\n                )\n              ))\n              .and(\n                seller_member_id =!= member_id_by_publisher_id_lookup\n                  .getField(\"seller_member_id\")\n              ))\n              .or(\n                ((((is_not_null(imp_type)\n                  .and(imp_type =!= lit(6)))\n                  .and(imp_type =!= lit(2)))\n                  .and(is_not_null(buyer_member_id)))\n                  .and(\n                    is_not_null(\n                      member_id_by_advertiser_id_lookup\n                        .getField(\"buyer_member_id\")\n                    )\n                  ))\n                  .and(\n                    buyer_member_id =!= member_id_by_advertiser_id_lookup\n                      .getField(\"buyer_member_id\")\n                  )\n              ))\n              .or(\n                (((is_not_null(buyer_member_id)\n                  .and(\n                    is_not_null(\n                      member_id_by_advertiser_id_lookup\n                        .getField(\"buyer_member_id\")\n                    )\n                  ))\n                  .and(\n                    is_not_null(\n                      advertiser_id_by_campaign_group_id_lookup\n                        .getField(\"advertiser_id\")\n                    )\n                  ))\n                  .and(\n                    buyer_member_id =!= member_id_by_advertiser_id_lookup\n                      .getField(\"buyer_member_id\")\n                  ))\n                  .and(\n                    advertiser_id =!= advertiser_id_by_campaign_group_id_lookup\n                      .getField(\"advertiser_id\")\n                  )\n              )\n          ),\n        lit(1)\n      )\n      .when(\n        (((is_not_null(imp_type)\n          .and((imp_type === lit(6)).and(imp_type === lit(2))))\n          .and(is_not_null(seller_member_id)))\n          .and(\n            is_not_null(\n              member_id_by_publisher_id_lookup.getField(\"seller_member_id\")\n            )\n          ))\n          .and(\n            seller_member_id =!= member_id_by_publisher_id_lookup\n              .getField(\"seller_member_id\")\n          ),\n        lit(1)\n      )\n      .when(\n        (((is_not_null(publisher_id)\n          .and(\n            is_not_null(\n              member_id_by_publisher_id_lookup.getField(\"seller_member_id\")\n            )\n          ))\n          .and(is_not_null(seller_member_id)))\n          .and(publisher_id =!= lit(0)))\n          .and(\n            member_id_by_publisher_id_lookup\n              .getField(\"seller_member_id\") =!= seller_member_id\n          ),\n        lit(1)\n      )\n      .when(\n        ((((is_not_null(imp_type)\n          .and(imp_type === lit(5)))\n          .and(is_not_null(seller_member_id)))\n          .and(is_not_null(buyer_member_id)))\n          .and(buyer_member_id =!= lit(0)))\n          .and(seller_member_id =!= buyer_member_id),\n        lit(1)\n      )\n      .otherwise(quarantine)\n  ).otherwise(quarantine).cast(IntegerType)\n  quarantine = when(\n    quarantine === lit(0),\n    when((log_impbus_impressions_pricing_count > lit(1)).and(\n           gross_payment_value_microcents =!= gross_payment_value_microcents_dup\n         ),\n         lit(1)\n    ).otherwise(quarantine)\n  ).otherwise(quarantine).cast(IntegerType)\n  quarantine","language":"scala","description":""}