{"parameters":[{"name":"impression_transaction_event_pricing","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"buyer_charges","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"seller_charges","type":"column","metadata":{"description":"","tags":[],"mappings":[]}}],"output":{"type":"struct","fields":[{"name":"gross_payment_value_microcents","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"net_payment_value_microcents","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_revenue_microcents","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_charges","type":{"type":"struct","fields":[{"name":"rate_card_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_dw","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"pricing_terms","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"term_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amount","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_deduction","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_media_cost_dependent","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"data_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"fx_margin_rate_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"marketplace_owner_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"virtual_marketplace_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amino_enabled","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_charges","type":{"type":"struct","fields":[{"name":"rate_card_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_dw","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"pricing_terms","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"term_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amount","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_deduction","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_media_cost_dependent","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"data_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"fx_margin_rate_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"marketplace_owner_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"virtual_marketplace_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amino_enabled","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_transacted","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_transacted","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"isCustomSchemaEnabled":true,"code":"var l_transaction_event_pricing: org.apache.spark.sql.Column = struct(\n    lit(null).as(\"gross_payment_value_microcents\"),\n    lit(null).as(\"net_payment_value_microcents\"),\n    lit(null).as(\"seller_revenue_microcents\"),\n    lit(null).as(\"buyer_charges\"),\n    lit(null).as(\"seller_charges\"),\n    lit(null).as(\"buyer_transacted\"),\n    lit(null).as(\"seller_transacted\")\n  )\n\n  l_transaction_event_pricing = impression_transaction_event_pricing\n  l_transaction_event_pricing = struct(\n    impression_transaction_event_pricing\n      .getField(\"gross_payment_value_microcents\")\n      .as(\"gross_payment_value_microcents\"),\n    impression_transaction_event_pricing\n      .getField(\"net_payment_value_microcents\")\n      .as(\"net_payment_value_microcents\"),\n    impression_transaction_event_pricing\n      .getField(\"seller_revenue_microcents\")\n      .as(\"seller_revenue_microcents\"),\n    when(\n      (is_not_null(\n        impression_transaction_event_pricing.getField(\"buyer_transacted\")\n      ).and(\n          impression_transaction_event_pricing\n            .getField(\"buyer_transacted\") =!= lit(1)\n        ))\n        .and(\n          isnull(\n            impression_transaction_event_pricing\n              .getField(\"buyer_charges\")\n              .getField(\"pricing_terms\")\n          )\n        ),\n      buyer_charges\n    ).otherwise(impression_transaction_event_pricing.getField(\"buyer_charges\"))\n      .as(\"buyer_charges\"),\n    when(\n      (is_not_null(\n        impression_transaction_event_pricing.getField(\"seller_transacted\")\n      ).and(\n          impression_transaction_event_pricing\n            .getField(\"seller_transacted\") =!= lit(1)\n        ))\n        .and(\n          isnull(\n            impression_transaction_event_pricing\n              .getField(\"seller_charges\")\n              .getField(\"pricing_terms\")\n          )\n        ),\n      seller_charges\n    ).otherwise(\n        impression_transaction_event_pricing.getField(\"seller_charges\")\n      )\n      .as(\"seller_charges\"),\n    impression_transaction_event_pricing\n      .getField(\"buyer_transacted\")\n      .as(\"buyer_transacted\"),\n    impression_transaction_event_pricing\n      .getField(\"seller_transacted\")\n      .as(\"seller_transacted\")\n  )\n  l_transaction_event_pricing","language":"scala","description":""}