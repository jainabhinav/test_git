{"parameters":[{"name":"data_costs","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"member_sales_tax_rate_pct","type":"column","metadata":{"description":"","tags":[],"mappings":[]}}],"output":{"type":"array","elementType":{"type":"struct","fields":[{"name":"data_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"cost","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"used_segments","type":{"type":"array","elementType":"integer","containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"cost_pct","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"isCustomSchemaEnabled":true,"code":"when(\n    is_not_null(data_costs).cast(BooleanType),\n    temp2912975_UDF(\n      array(),\n      member_sales_tax_rate_pct.cast(DoubleType),\n      lit(0),\n      lit(null).cast(\n        StructType(\n          List(\n            StructField(\"data_member_id\", IntegerType,                  true),\n            StructField(\"cost\",           DoubleType,                   true),\n            StructField(\"used_segments\",  ArrayType(IntegerType, true), true),\n            StructField(\"cost_pct\",       DoubleType,                   true)\n          )\n        )\n      ),\n      data_costs\n    ).getField(\"l_data_costs\")\n  )","language":"scala","description":""}