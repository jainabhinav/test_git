{"parameters":[{"name":"id_type","type":"column","metadata":{"description":"","tags":[],"mappings":[]}},{"name":"id_list","type":"column","metadata":{"description":"","tags":[],"mappings":[]}}],"output":{"type":"struct","fields":[{"name":"identity_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"identity_value","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"isCustomSchemaEnabled":true,"code":"when(\n    is_not_null(\n      when(is_not_null(id_list).cast(BooleanType), id_list).otherwise(\n        lit(null).cast(\n          ArrayType(StructType(\n                      List(StructField(\"identity_type\",  IntegerType, true),\n                           StructField(\"identity_value\", StringType,  true)\n                      )\n                    ),\n                    true\n          )\n        )\n      )\n    ).cast(BooleanType),\n    temp7361735_UDF(\n      id_type,\n      when(is_not_null(id_list).cast(BooleanType), id_list).otherwise(\n        lit(null).cast(\n          ArrayType(StructType(\n                      List(StructField(\"identity_type\",  IntegerType, true),\n                           StructField(\"identity_value\", StringType,  true)\n                      )\n                    ),\n                    true\n          )\n        )\n      ),\n      lit(0),\n      lit(0)\n    ).getField(\"pi\")\n  ).otherwise(\n    lit(null).cast(\n      StructType(\n        List(StructField(\"identity_type\",  IntegerType, true),\n             StructField(\"identity_value\", StringType,  true)\n        )\n      )\n    )\n  )","language":"scala","description":""}