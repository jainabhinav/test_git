{"parameters":[],"output":{"type":"struct","fields":[{"name":"date_time","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"auction_id_64","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_charges","type":{"type":"struct","fields":[{"name":"rate_card_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_dw","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"pricing_terms","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"term_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amount","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_deduction","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_media_cost_dependent","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"data_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"fx_margin_rate_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"marketplace_owner_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"virtual_marketplace_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amino_enabled","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_charges","type":{"type":"struct","fields":[{"name":"rate_card_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_dw","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"pricing_terms","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"term_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amount","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_deduction","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_media_cost_dependent","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"data_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"fx_margin_rate_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"marketplace_owner_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"virtual_marketplace_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amino_enabled","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_spend","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_revenue","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"rate_card_auction_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"rate_card_media_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"direct_clear","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"auction_timestamp","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"instance_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"two_phase_reduction_applied","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"trade_agreement_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"log_timestamp","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"trade_agreement_info","type":{"type":"struct","fields":[{"name":"applied_term_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"applied_term_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"targeted_term_ids","type":{"type":"array","elementType":"integer","containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_buy_it_now","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"net_buyer_spend","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"impression_event_pricing","type":{"type":"struct","fields":[{"name":"gross_payment_value_microcents","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"net_payment_value_microcents","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_revenue_microcents","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_charges","type":{"type":"struct","fields":[{"name":"rate_card_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_dw","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"pricing_terms","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"term_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amount","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_deduction","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_media_cost_dependent","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"data_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"fx_margin_rate_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"marketplace_owner_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"virtual_marketplace_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amino_enabled","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_charges","type":{"type":"struct","fields":[{"name":"rate_card_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_dw","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"pricing_terms","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"term_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amount","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"rate","type":"double","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_deduction","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_media_cost_dependent","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"data_member_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"containsNull":true},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"fx_margin_rate_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"marketplace_owner_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"virtual_marketplace_id","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"amino_enabled","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"buyer_transacted","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"seller_transacted","type":"boolean","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"counterparty_ruleset_type","type":"integer","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"estimated_audience_imps","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"audience_imps","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"isCustomSchemaEnabled":true,"code":"var l_buyer_charges: org.apache.spark.sql.Column = struct(\n    lit(null).as(\"rate_card_id\"),\n    lit(null).as(\"member_id\"),\n    lit(null).as(\"is_dw\"),\n    array()\n      .cast(\n        ArrayType(\n          StructType(\n            List(\n              StructField(\"term_id\",                 IntegerType, true),\n              StructField(\"amount\",                  DoubleType,  true),\n              StructField(\"rate\",                    DoubleType,  true),\n              StructField(\"is_deduction\",            BooleanType, true),\n              StructField(\"is_media_cost_dependent\", BooleanType, true),\n              StructField(\"data_member_id\",          IntegerType, true)\n            )\n          ),\n          true\n        )\n      )\n      .as(\"pricing_terms\"),\n    lit(null).as(\"fx_margin_rate_id\"),\n    lit(null).as(\"marketplace_owner_id\"),\n    lit(null).as(\"virtual_marketplace_id\"),\n    lit(null).as(\"amino_enabled\")\n  )\n\n  var l_seller_charges: org.apache.spark.sql.Column = struct(\n    lit(null).as(\"rate_card_id\"),\n    lit(null).as(\"member_id\"),\n    lit(null).as(\"is_dw\"),\n    array()\n      .cast(\n        ArrayType(\n          StructType(\n            List(\n              StructField(\"term_id\",                 IntegerType, true),\n              StructField(\"amount\",                  DoubleType,  true),\n              StructField(\"rate\",                    DoubleType,  true),\n              StructField(\"is_deduction\",            BooleanType, true),\n              StructField(\"is_media_cost_dependent\", BooleanType, true),\n              StructField(\"data_member_id\",          IntegerType, true)\n            )\n          ),\n          true\n        )\n      )\n      .as(\"pricing_terms\"),\n    lit(null).as(\"fx_margin_rate_id\"),\n    lit(null).as(\"marketplace_owner_id\"),\n    lit(null).as(\"virtual_marketplace_id\"),\n    lit(null).as(\"amino_enabled\")\n  )\n\n  var l_impression_event_pricing: org.apache.spark.sql.Column = struct(\n    lit(null).as(\"gross_payment_value_microcents\"),\n    lit(null).as(\"net_payment_value_microcents\"),\n    lit(null).as(\"seller_revenue_microcents\"),\n    lit(null).as(\"buyer_charges\"),\n    lit(null).as(\"seller_charges\"),\n    lit(null).as(\"buyer_transacted\"),\n    lit(null).as(\"seller_transacted\")\n  )\n\n  l_buyer_charges = struct(\n    lit(null).cast(IntegerType).as(\"rate_card_id\"),\n    col(\"member_id\").cast(IntegerType).as(\"member_id\"),\n    lit(1).as(\"is_dw\"),\n    array()\n      .cast(\n        ArrayType(\n          StructType(\n            List(\n              StructField(\"term_id\",                 IntegerType, true),\n              StructField(\"amount\",                  DoubleType,  true),\n              StructField(\"rate\",                    DoubleType,  true),\n              StructField(\"is_deduction\",            BooleanType, true),\n              StructField(\"is_media_cost_dependent\", BooleanType, true),\n              StructField(\"data_member_id\",          IntegerType, true)\n            )\n          ),\n          true\n        )\n      )\n      .as(\"pricing_terms\"),\n    lit(null).cast(IntegerType).as(\"fx_margin_rate_id\"),\n    lit(null).cast(IntegerType).as(\"marketplace_owner_id\"),\n    lit(null).cast(IntegerType).as(\"virtual_marketplace_id\"),\n    lit(null).cast(BooleanType).as(\"amino_enabled\")\n  )\n  l_seller_charges = struct(\n    lit(null).cast(IntegerType).as(\"rate_card_id\"),\n    col(\"member_id\").cast(IntegerType).as(\"member_id\"),\n    lit(1).as(\"is_dw\"),\n    array()\n      .cast(\n        ArrayType(\n          StructType(\n            List(\n              StructField(\"term_id\",                 IntegerType, true),\n              StructField(\"amount\",                  DoubleType,  true),\n              StructField(\"rate\",                    DoubleType,  true),\n              StructField(\"is_deduction\",            BooleanType, true),\n              StructField(\"is_media_cost_dependent\", BooleanType, true),\n              StructField(\"data_member_id\",          IntegerType, true)\n            )\n          ),\n          true\n        )\n      )\n      .as(\"pricing_terms\"),\n    lit(null).cast(IntegerType).as(\"fx_margin_rate_id\"),\n    lit(null).cast(IntegerType).as(\"marketplace_owner_id\"),\n    lit(null).cast(IntegerType).as(\"virtual_marketplace_id\"),\n    lit(null).cast(BooleanType).as(\"amino_enabled\")\n  )\n  l_impression_event_pricing = struct(\n    lit(null).cast(LongType).as(\"gross_payment_value_microcents\"),\n    lit(null).cast(LongType).as(\"net_payment_value_microcents\"),\n    lit(null).cast(LongType).as(\"seller_revenue_microcents\"),\n    l_buyer_charges.as(\"buyer_charges\"),\n    l_seller_charges.as(\"seller_charges\"),\n    lit(null).cast(BooleanType).as(\"buyer_transacted\"),\n    lit(null).cast(BooleanType).as(\"seller_transacted\")\n  )\n  struct(\n    col(\"date_time\").cast(LongType).as(\"date_time\"),\n    col(\"auction_id_64\").cast(LongType).as(\"auction_id_64\"),\n    l_buyer_charges.as(\"buyer_charges\"),\n    l_seller_charges.as(\"seller_charges\"),\n    lit(0.0).as(\"buyer_spend\"),\n    lit(0.0).as(\"seller_revenue\"),\n    lit(null).cast(IntegerType).as(\"rate_card_auction_type\"),\n    lit(null).cast(IntegerType).as(\"rate_card_media_type\"),\n    lit(0).cast(BooleanType).as(\"direct_clear\"),\n    col(\"date_time\").cast(LongType).as(\"auction_timestamp\"),\n    lit(null).cast(IntegerType).as(\"instance_id\"),\n    lit(0).cast(BooleanType).as(\"two_phase_reduction_applied\"),\n    lit(0).as(\"trade_agreement_id\"),\n    lit(null).cast(LongType).as(\"log_timestamp\"),\n    lit(null)\n      .cast(\n        StructType(\n          List(\n            StructField(\"applied_term_id\",   IntegerType,                  true),\n            StructField(\"applied_term_type\", IntegerType,                  true),\n            StructField(\"targeted_term_ids\", ArrayType(IntegerType, true), true)\n          )\n        )\n      )\n      .as(\"trade_agreement_info\"),\n    lit(null).cast(BooleanType).as(\"is_buy_it_now\"),\n    lit(null).cast(DoubleType).as(\"net_buyer_spend\"),\n    l_impression_event_pricing.as(\"impression_event_pricing\"),\n    lit(null).cast(IntegerType).as(\"counterparty_ruleset_type\"),\n    lit(null).cast(FloatType).as(\"estimated_audience_imps\"),\n    lit(null).cast(FloatType).as(\"audience_imps\")\n  )","language":"scala","description":""}