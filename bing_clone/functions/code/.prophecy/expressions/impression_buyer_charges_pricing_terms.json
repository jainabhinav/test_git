{"parameters":[],"isCustomSchemaEnabled":false,"code":"when(\n    is_not_null(\n      f_get_impression_transaction_event_pricing(\n        col(\"log_impbus_impressions_pricing.impression_event_pricing\"),\n        col(\"log_impbus_impressions_pricing.buyer_charges\"),\n        col(\"log_impbus_impressions_pricing.seller_charges\")\n      ).getField(\"buyer_charges\").getField(\"pricing_terms\")\n    ).cast(BooleanType),\n    v_impression_transaction_event_pricing()\n      .getField(\"buyer_charges\")\n      .getField(\"pricing_terms\")\n  ).otherwise(\n    lit(null).cast(\n      ArrayType(\n        StructType(\n          List(\n            StructField(\"term_id\",                 IntegerType, true),\n            StructField(\"amount\",                  DoubleType,  true),\n            StructField(\"rate\",                    DoubleType,  true),\n            StructField(\"is_deduction\",            BooleanType, true),\n            StructField(\"is_media_cost_dependent\", BooleanType, true),\n            StructField(\"data_member_id\",          IntegerType, true)\n          )\n        ),\n        true\n      )\n    )\n  )","language":"scala","description":""}