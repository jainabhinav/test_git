{"initCode":"","code":"udf((_max_vast_version: Integer, _protocols: Seq[Integer], _i: Integer) => {\n  var i = _i\nvar valid_max_vast_version = 0\nvar max_vast_version = _max_vast_version\nvar protocols = (_protocols).toArray\n\nwhile(compareTo(i, protocols.length) < 0) {\nif(((compareTo(i, 3) <= 0) && (compareTo(i, 0) >= 0)) && (compareTo(i, max_vast_version) > 0)){\nmax_vast_version = i\nvalid_max_vast_version = 1\n}\ni = i + convertToInt(1)\n}\n\nRow(convertToInt(i), convertToInt(valid_max_vast_version), convertToInt(max_vast_version))\n},  StructType(\n      List(\n      StructField(\"i\", IntegerType, false),StructField(\"valid_max_vast_version\", IntegerType, false),StructField(\"max_vast_version\", IntegerType, false)\n      )\n    ))"}