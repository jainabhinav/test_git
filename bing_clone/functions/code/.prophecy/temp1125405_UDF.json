{"initCode":"","code":"udf((_allowed_media_types: Seq[Integer], _i: Integer) => {\n  var media_type_audio = 0\nvar i = _i\nvar media_type_video = 0\nvar allowed_media_types = (_allowed_media_types).toArray\n\nwhile(compareTo(i, allowed_media_types.length) < 0) {\nif(allowed_media_types(convertToInt(i)) == 4){\nmedia_type_video = 1\n}\nif(allowed_media_types(convertToInt(i)) == 13){\nmedia_type_audio = 1\n}\ni = i + convertToInt(1)\n}\n\nRow(convertToInt(media_type_audio), convertToInt(i), convertToInt(media_type_video))\n},  StructType(\n      List(\n      StructField(\"media_type_audio\", IntegerType, false),StructField(\"i\", IntegerType, false),StructField(\"media_type_video\", IntegerType, false)\n      )\n    ))"}