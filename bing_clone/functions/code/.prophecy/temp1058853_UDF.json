{"initCode":"","code":"udf((_i: Integer, _frameworks: Seq[Integer]) => {\n  var i = _i\nvar supports_vpaid_1 = 0\nvar supports_vpaid_2 = 0\nvar frameworks = (_frameworks).toArray\n\nwhile(compareTo(i, frameworks.length) < 0) {\nif(frameworks(convertToInt(i)) == 1){\nsupports_vpaid_1 = 1\n}\nif(frameworks(convertToInt(i)) == 2){\nsupports_vpaid_2 = 2\n}\ni = i + convertToInt(1)\n}\n\nRow(convertToInt(i), convertToInt(supports_vpaid_1), convertToInt(supports_vpaid_2))\n},  StructType(\n      List(\n      StructField(\"i\", IntegerType, false),StructField(\"supports_vpaid_1\", IntegerType, false),StructField(\"supports_vpaid_2\", IntegerType, false)\n      )\n    ))"}