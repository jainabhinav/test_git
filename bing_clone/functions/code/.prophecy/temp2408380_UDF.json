{"initCode":"import java.text.SimpleDateFormat","code":"udf(\n    (\n      _in_protocols:           Seq[Integer],\n      _l_protocols:            Seq[Integer],\n      _i:                      Integer,\n      _end_result:             Integer,\n      _in_video_protocol_enum: Seq[Integer]\n    ) => {\n      var in_protocols           = _in_protocols.toArray\n      var l_protocols            = _l_protocols.toArray\n      var i                      = _i\n      var end_result             = _end_result\n      var in_video_protocol_enum = _in_video_protocol_enum.toArray\n\n      while (compareTo(i, l_protocols.length) < 0) {\n        if (in_protocols(convertToInt(i)) == 0)\n          end_result = 1\n        else if (in_protocols(convertToInt(i)) == 1)\n          end_result = 2\n        else if (in_protocols(convertToInt(i)) == 2)\n          end_result = 3\n        else if (in_protocols(convertToInt(i)) == 3)\n          end_result = 7\n        else if (in_protocols(convertToInt(i)) == 4)\n          end_result = 8\n        else end_result = 0\n        in_video_protocol_enum =\n          Array.concat(in_video_protocol_enum, Array.fill(1)(end_result))\n        i = i + convertToInt(1)\n      }\n\n      Row(in_video_protocol_enum, convertToInt(end_result), convertToInt(i))\n    },\n    StructType(\n      List(\n        StructField(\"in_video_protocol_enum\", ArrayType(IntegerType), false),\n        StructField(\"end_result\",             IntegerType,            false),\n        StructField(\"i\",                      IntegerType,            false)\n      )\n    )\n  )"}