{"initCode":"import java.text.SimpleDateFormat","code":"udf(\n    (\n      _currency_2_enabled_members: Seq[Integer],\n      _i:                          Integer,\n      _max_i:                      Integer,\n      _member_id:                  Integer\n    ) => {\n      var currency_2_enabled_members = _currency_2_enabled_members.toArray\n      var i                          = _i\n      var found                      = 0\n      var max_i                      = _max_i\n      var member_id                  = _member_id\n\n      while (compareTo(i, max_i) < 0) {\n        if (currency_2_enabled_members(convertToInt(i)) == member_id) {\n          found = 1\n          i = max_i\n        }\n        i = i + convertToInt(1)\n      }\n\n      Row(convertToInt(found), convertToInt(i))\n    },\n    StructType(\n      List(\n        StructField(\"found\", IntegerType, false),\n        StructField(\"i\",     IntegerType, false)\n      )\n    )\n  )"}